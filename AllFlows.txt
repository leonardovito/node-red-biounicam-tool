[{"id":"5b14368e.13c7c8","type":"tab","label":"Create-unique-IDs","disabled":false,"info":""},{"id":"74b1668b.40f8b8","type":"http in","z":"5b14368e.13c7c8","name":"","url":"/incrementfasta","method":"post","upload":true,"swaggerDoc":"","x":300,"y":640,"wires":[["2bf4dddb.e43f22","1c2ebc24.9c4a14","6020018.28373"]]},{"id":"b095240e.a8e1c8","type":"function","z":"5b14368e.13c7c8","name":"","func":"if(msg.req.files.length == 1) {\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"incrementFasta/out/\" + msg.req.files[0].originalname\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":680,"y":700,"wires":[["7e5694f1.c1180c"]]},{"id":"7e5694f1.c1180c","type":"file","z":"5b14368e.13c7c8","name":"","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":810,"y":700,"wires":[["5a37149c.ab14dc"]]},{"id":"e2c57655.bc3f38","type":"increment_fasta_contig","z":"5b14368e.13c7c8","name":"","fasta":"","pathfolder":"","outputname":"","x":1270,"y":660,"wires":[["4229a21f.30376c","9647946f.632178"]]},{"id":"afd5c266.dd07a","type":"function","z":"5b14368e.13c7c8","name":"","func":"//global.set(\"name\",msg.payload.outputname);\nif(msg.req.files.length == 1) {\n    msg.payload.fasta = \"incrementFasta/out/\" + msg.req.files[0].originalname\n}\nelse {\n    msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n}\nmsg.payload.pathfolder = \"incrementFasta/out\"\nmsg.payload.outputname = msg.payload.outputname\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":680,"y":560,"wires":[["a58af953.9e5a78"]]},{"id":"4229a21f.30376c","type":"function","z":"5b14368e.13c7c8","name":"","func":"//var name = global.get(\"name\");\nif(msg.payload.stdout!==\"Error\") {\nif(msg.payload.zip===\"no\") {\n    msg.payload = msg.payload.outputname\n    return[msg,null,null]\n}\nelse if(msg.payload.zip===\"yes\") {\n    msg.payload.outputname = msg.payload.outputname.slice(0,-6) + \".zip\";\n    msg.payload.pathIn = \"incrementFasta/out\"\n    msg.payload.pathOut = \"incrementFasta/\"+msg.payload.outputname\n    return [null,msg,null]\n}\n}\nelse {\n    return [null,null,msg]\n}\n","outputs":3,"noerr":0,"initialize":"","finalize":"","x":1480,"y":660,"wires":[["cbed9468.d41f08"],["e04cd4b8.b69838"],["304c7ade.633146"]]},{"id":"5a37149c.ab14dc","type":"function","z":"5b14368e.13c7c8","name":"","func":"msg.payload = {code : null};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":700,"wires":[["a58af953.9e5a78"]]},{"id":"a58af953.9e5a78","type":"join","z":"5b14368e.13c7c8","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"4","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1070,"y":660,"wires":[["e2c57655.bc3f38"]]},{"id":"cbed9468.d41f08","type":"delay","z":"5b14368e.13c7c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":620,"wires":[["aef380c6.bd859","f48ec079.f4237"]]},{"id":"16e452f1.ef2d3d","type":"ui_template","z":"5b14368e.13c7c8","group":"551f8b12.fef8a4","name":"Data-table","order":1,"width":24,"height":12,"format":"<html>  \n  <head>\n      <style>\n.center {\n  position: absolute;\n  top: 8%;\n  left: 50%;\n  margin: -25px 0 0 -25px;\n}\n .auto-style1 {\n margin-left: 0px;\n }\n </style>\n  </head>\n  <body>\n  <center>\n \n      <br><br><br><br>\n    <form action=\"/incrementfasta\" method=\"post\" enctype=\"multipart/form-data\">\n    <div style=\"width:700px; height:45px; border:5px outset navy;\"> <font face=\"Verdana\" size=\"6\">Create unique IDs</font><br /></div>\n    <p>The user can create .fasta files with unique and incremental Ids. An incremental number starting from 1 is added on every description line.\n</p>\n    <p>_________________________________________________________________________________________________________________</p> <br>\n      <br>\n      <label style=\"font-size:20px\"  for=\"fasta\">Fasta File:&emsp;</label>\n      <input id=\"filefasta\" type=\"file\" name=\"filefasta\" class=\"auto-style1\" style=\"width: 273px; height: 34px\" accept=\".fasta\">\n      <p><label for=\"filefastaDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label>\n        <select id=\"filefastaDEF\" name=\"filefastaDEF\">\n        <option value=\"\">Nessun File</option>\n        <option ng-repeat=\"obj in msg.payload\" value=\"{{obj}}\">{{ obj }}</option>\n        </select></p> <br>\n      <label style=\"font-size:20px\" for=\"outputname\">Output name:&emsp;</label>\n      <input type=\"text\" id=\"outputname\" name=\"outputname\" style=\"width: 200px; height: 20px\" required/>\n      <br><br>\n      <label for=\"zip\">Create a .zip output ( if \"NO\" all files can be downloaded individually):</label>\n      <select id=\"zip\" name=\"zip\">\n          <option value=\"yes\">YES</option>\n          <option value=\"no\">NO</option>\n          </select>\n    <p>_________________________________________________________________________________________________________________</p>\n      <br>\n      <button type=\"button\" id=\"sendBtn\" style=\"width: 250px; height: 43px\" onclick=\"uploadFile()\">Invia</button>\n    <div style=\"text-align:center;margin-top:40px;\">\n      <progress id=\"progressBar\" value=\"0\" max=\"100\" style=\"width:300px;\"></progress>\n        <p id=\"status\"></p>\n    </div>\n    </form>\n    </center>\n    <script>\n    function uploadFile(){\n    \n    var fileFasta;\n    \n    if(document.getElementById(\"filefastaDEF\").value != \"\")\n    {\n        fileFasta = document.getElementById(\"filefastaDEF\").value;\n    }\n    else {\n        fileFasta = document.getElementById(\"filefasta\").files[0];\n    }\n    \n    const prov = new Date;\n    var outputname = document.getElementById('outputname').value +\"_\"+prov.getDate()+\"-\"+(prov.getMonth()+1)+\"-\"+prov.getFullYear()+\"_\"+prov.getHours()+':'+prov.getMinutes()+':'+prov.getSeconds()+\".fasta\";\n    var zip = document.getElementById('zip').value\n\n    var formdata = new FormData();\n    formdata.append(\"filefasta\", fileFasta);\n    formdata.append(\"outputname\", outputname);\n    formdata.append(\"zip\", zip);\n    var ajax = new XMLHttpRequest();\n    ajax.upload.addEventListener(\"progress\", progressHandler, false);\n    ajax.addEventListener(\"load\", completeHandler, false);\n    ajax.addEventListener(\"error\", errorHandler, false);\n    ajax.addEventListener(\"abort\", abortHandler, false);\n    ajax.open(\"POST\", \"/incrementfasta\");\n    ajax.send(formdata);\n}\n\nfunction progressHandler(event){\n    var percent = (event.loaded / event.total) * 100;\n    document.getElementById(\"progressBar\").value = Math.round(percent);\n    document.getElementById(\"status\").innerHTML = Math.round(percent)+\"% uploaded... please wait\";\n}\nfunction completeHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Done\";\n    document.getElementById(\"progressBar\").value = 0;\n}\nfunction errorHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Failed\";\n}\nfunction abortHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Aborted\";\n}\n        </script>\n      </body>\n</html>","storeOutMessages":false,"fwdInMessages":false,"resendOnRefresh":false,"templateScope":"local","x":370,"y":580,"wires":[[]]},{"id":"e04cd4b8.b69838","type":"zip_folder","z":"5b14368e.13c7c8","name":"","pathIn":"","pathOut":"","x":1680,"y":680,"wires":[["eaffc98c.c2b9f8","ab6c6c48.ef61"]]},{"id":"304c7ade.633146","type":"delay","z":"5b14368e.13c7c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":740,"wires":[["66a9b6cc.566128","e988fbb6.b84738"]]},{"id":"58638ee1.45c5b","type":"fs-ops-dir","z":"5b14368e.13c7c8","name":"","path":"standardFiles","pathType":"str","filter":"*.fasta","filterType":"str","dir":"payload","dirType":"msg","x":440,"y":460,"wires":[["16e452f1.ef2d3d"]]},{"id":"15fcfadd.23e525","type":"ui_ui_control","z":"5b14368e.13c7c8","name":"Refresh page restore","events":"all","x":360,"y":380,"wires":[["58638ee1.45c5b","8d4dd582.17c108"]]},{"id":"8d4dd582.17c108","type":"function","z":"5b14368e.13c7c8","name":"","func":"msg.payload = { group: {\n    show : [\"CreateUniqueIDs_Form\"],\n    hide : [\"CreateUniqueIDs_Text\", \"CreateUniqueIDs_Out\", \"CreateUniqueIDs_Error\",\"CreateUniqueIDs_Zip\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":340,"y":280,"wires":[["ad32e66b.59d7a8"]]},{"id":"ad32e66b.59d7a8","type":"ui_ui_control","z":"5b14368e.13c7c8","name":"","events":"all","x":740,"y":280,"wires":[[]]},{"id":"6b4e4296.f7748c","type":"ui_text","z":"5b14368e.13c7c8","group":"8de88ec6.7a2eb","order":1,"width":24,"height":4,"name":"","label":"","format":"{{msg.payload.text}}","layout":"col-center","x":910,"y":460,"wires":[]},{"id":"2bf4dddb.e43f22","type":"function","z":"5b14368e.13c7c8","name":"","func":"msg.payload = { group: {\n    show : [\"CreateUniqueIDs_Text\"],\n    hide : [\"CreateUniqueIDs_Form\"]\n}, text: \"Process in execution... Please wait.\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":700,"y":460,"wires":[["6b4e4296.f7748c","ad32e66b.59d7a8"]]},{"id":"ff06197f.7a46a8","type":"fs-ops-mkdir","z":"5b14368e.13c7c8","name":"","path":"","pathType":"str","dirname":"incrementFasta","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":700,"y":800,"wires":[["5e3d6916.415278"]]},{"id":"5e3d6916.415278","type":"fs-ops-mkdir","z":"5b14368e.13c7c8","name":"","path":"incrementFasta/","pathType":"str","dirname":"out","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":900,"y":800,"wires":[[]]},{"id":"9647946f.632178","type":"function","z":"5b14368e.13c7c8","name":"","func":"if(msg.payload.fasta.startsWith(\"standardFiles\")) {\n    msg.payload.fasta = null\n}\nelse {\n    msg.payload.fasta = msg.payload.fasta.split(\"/\")[2]\n}\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1380,"y":860,"wires":[["d6759d0a.779f"]]},{"id":"f48ec079.f4237","type":"ui_template","z":"5b14368e.13c7c8","group":"fb4d7367.bfdc8","name":"output","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>  \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/incrementFasta/out/{{msg.payload}}\" onclick=\"clickAndDisable(this);\">{{msg.payload}}</a>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1870,"y":500,"wires":[[]]},{"id":"d827c376.0524b","type":"ui_ui_control","z":"5b14368e.13c7c8","name":"","events":"all","x":2120,"y":680,"wires":[[]]},{"id":"eaffc98c.c2b9f8","type":"function","z":"5b14368e.13c7c8","name":"","func":"msg.payload = { group: {\n    show : [\"CreateUniqueIDs_Zip\"],\n    hide : [\"CreateUniqueIDs_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1900,"y":680,"wires":[["d827c376.0524b"]]},{"id":"e988fbb6.b84738","type":"ui_template","z":"5b14368e.13c7c8","group":"6d4e43ea.a0b26c","name":"error","order":1,"width":0,"height":0,"format":"<html>\n  <body>\n      <center>\n<h1>ERROR during execution!</h1>\n<h3>There was an error in the process. Please, repeat the procedure and check if the inputs files are correct</h3>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1890,"y":820,"wires":[[]]},{"id":"66a9b6cc.566128","type":"function","z":"5b14368e.13c7c8","name":"","func":"msg.payload = { group: {\n    show : [\"CreateUniqueIDs_Error\"],\n    hide : [\"CreateUniqueIDs_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1900,"y":740,"wires":[["d827c376.0524b"]]},{"id":"ab6c6c48.ef61","type":"ui_template","z":"5b14368e.13c7c8","group":"15a18174.decbcf","name":"zip","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>  \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/{{msg.payload.pathOut}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.outputname}}</a>\n</div>\n<br><br><br><h3>If you don't storage the files to the server or download them, they will be DELETED</h3>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1890,"y":560,"wires":[[]]},{"id":"aef380c6.bd859","type":"function","z":"5b14368e.13c7c8","name":"","func":"msg.payload = { group: {\n    show : [\"CreateUniqueIDs_Out\"],\n    hide : [\"CreateUniqueIDs_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1900,"y":620,"wires":[["d827c376.0524b"]]},{"id":"d6759d0a.779f","type":"fs-ops-move","z":"5b14368e.13c7c8","name":"","sourcePath":"incrementFasta/out/","sourcePathType":"str","sourceFilename":"payload.fasta","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fasta","destFilenameType":"msg","link":false,"x":1540,"y":860,"wires":[[]]},{"id":"58522130.ab481","type":"fs-ops-dir","z":"5b14368e.13c7c8","name":"get list of files","path":"sourcePath","pathType":"msg","filter":"*","filterType":"str","dir":"payload","dirType":"msg","x":640,"y":80,"wires":[["8a357bd4.4bd608"]]},{"id":"d0b6fc5a.b3fd2","type":"fs-ops-move","z":"5b14368e.13c7c8","name":"","sourcePath":"sourcePath","sourcePathType":"msg","sourceFilename":"payload","sourceFilenameType":"msg","destPath":"destinationPath","destPathType":"msg","destFilename":"payload","destFilenameType":"msg","link":false,"x":760,"y":160,"wires":[[]]},{"id":"b368b38d.3db0d","type":"change","z":"5b14368e.13c7c8","name":"","rules":[{"t":"set","p":"sourcePath","pt":"msg","to":"incrementFasta/out","tot":"str"},{"t":"set","p":"destinationPath","pt":"msg","to":"standardFiles","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":80,"wires":[["58522130.ab481"]]},{"id":"8a357bd4.4bd608","type":"split","z":"5b14368e.13c7c8","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":610,"y":160,"wires":[["d0b6fc5a.b3fd2"]]},{"id":"ffce71d9.d0392","type":"ui_button","z":"5b14368e.13c7c8","name":"","group":"fb4d7367.bfdc8","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":140,"y":40,"wires":[["b368b38d.3db0d","8d4dd582.17c108"]]},{"id":"1c2ebc24.9c4a14","type":"exec","z":"5b14368e.13c7c8","command":"rm -rf \"incrementFasta\"","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"rmDir","x":530,"y":800,"wires":[[],[],["ff06197f.7a46a8"]]},{"id":"3e04690.af11a98","type":"ui_button","z":"5b14368e.13c7c8","name":"","group":"15a18174.decbcf","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":140,"y":100,"wires":[["b368b38d.3db0d","8d4dd582.17c108"]]},{"id":"6020018.28373","type":"delay","z":"5b14368e.13c7c8","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":520,"y":640,"wires":[["afd5c266.dd07a","b095240e.a8e1c8"]]},{"id":"815a541e.d91568","type":"tab","label":"Cufflinks-Introns-extraction","disabled":false,"info":""},{"id":"e375283.4154fd8","type":"http in","z":"815a541e.d91568","name":"","url":"/extractfromcuff","method":"post","upload":true,"swaggerDoc":"","x":420,"y":1060,"wires":[["4405de7d.a247b","89664fbe.c1e9","c99e34ec.0ebf68"]]},{"id":"9f5df1dc.cd462","type":"function","z":"815a541e.d91568","name":"","func":"if(msg.req.files.length == 2) {\n    var msg1 = { payload: msg.req.files[1].buffer, filename: \"extractFromCUFF/out/\" + msg.req.files[1].originalname};\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"extractFromCUFF/out/\" + msg.req.files[0].originalname\n\n    return [msg,msg1];\n}\nelse if(msg.req.files.length == 1) {\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"extractFromCUFF/out/\" + msg.req.files[0].originalname\n\n    return [msg,null];\n}","outputs":2,"noerr":0,"initialize":"","finalize":"","x":800,"y":1120,"wires":[["9fcb7bd5.06b898"],["c2928bd1.5be6a8"]]},{"id":"9fcb7bd5.06b898","type":"file","z":"815a541e.d91568","name":"fasta","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":930,"y":1060,"wires":[["dd0c514d.4884"]]},{"id":"faeb271f.d03e08","type":"function","z":"815a541e.d91568","name":"","func":"if (msg.req.files.length ==2) {\n    msg.payload.fasta = \"extractFromCUFF/out/\" + msg.req.files[0].originalname\n    msg.payload.cuff = \"extractFromCUFF/out/\" + msg.req.files[1].originalname\n    msg.payload.pathfolder = \"extractFromCUFF/out\"\n    msg.payload.flanking = msg.payload.flanking\n    msg.payload.outputname = msg.payload.outputname\n    return msg;\n}\nelse if (msg.req.files.length ==1) {\n    if(msg.req.files[0].fieldname == \"filefasta\") {\n        msg.payload.fasta = \"extractFromCUFF/out/\" + msg.req.files[0].originalname\n        msg.payload.cuff = \"standardFiles/\" + msg.payload.filecuff\n        msg.payload.pathfolder = \"extractFromCUFF/out\"\n        msg.payload.flanking = msg.payload.flanking\n        msg.payload.outputname = msg.payload.outputname\n        return msg;\n    }\n    if(msg.req.files[0].fieldname == \"filecuff\") {\n        msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n        msg.payload.cuff = \"extractFromCUFF/out/\" + msg.req.files[0].originalname\n        msg.payload.pathfolder = \"extractFromCUFF/out\"\n        msg.payload.flanking = msg.payload.flanking\n        msg.payload.outputname = msg.payload.outputname\n        return msg;\n    }\n}\nelse {\n    msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n    msg.payload.cuff = \"standardFiles/\" + msg.payload.filecuff\n    msg.payload.pathfolder = \"extractFromCUFF/out\"\n    msg.payload.flanking = msg.payload.flanking\n    msg.payload.outputname = msg.payload.outputname\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":960,"y":1000,"wires":[["b90c2f57.1745a"]]},{"id":"d0f6856b.dcdf88","type":"ui_template","z":"815a541e.d91568","group":"fa121464.d372f8","name":"Data-table","order":1,"width":24,"height":14,"format":"<html>  \n  <head>\n      <style>\n.center {\n  position: absolute;\n  top: 8%;\n  left: 50%;\n  margin: -25px 0 0 -25px;\n}\n .auto-style1 {\n margin-left: 0px;\n }\n </style>\n  </head>\n  <body>\n  <center>\n \n      <br><br><br><br>\n    <form action=\"/extractfromcuff\" method=\"post\" enctype=\"multipart/form-data\">\n    <div style=\"width:700px; height:45px; border:5px outset navy;\"> <font face=\"Verdana\" size=\"6\">Cufflinks Introns extraction</font><br /></div>\n    <p>The user can extract introns using provided Cufflinks coordinates. A variable length flanking regions dataset can be created.</p>\n    <p>_________________________________________________________________________________________________________________</p>\n     \n      <br>\n      <label style=\"font-size:20px\"  for=\"fasta\">Fasta File:&emsp;</label>\n      <input id=\"filefasta\" type=\"file\" name=\"filefasta\" class=\"auto-style1\" style=\"width: 273px; height: 34px\" accept=\".fasta\">\n      <p><label for=\"filefastaDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label>\n        <select id=\"filefastaDEF\" name=\"filefastaDEF\">\n        <option value=\"\">Nessun File</option>\n        <option ng-repeat=\"obj in msg.payload.fasta\" value=\"{{obj}}\">{{ obj }}</option>\n        </select></p> <br>\n      <label style=\"font-size:20px\"  for=\"filecuff\">Cufflinks coordinates (.gtf):&emsp;</label>\n      <input id=\"filecuff\" type=\"file\" name=\"filecuff\" class=\"auto-style1\" style=\"width: 273px; height: 34px\" accept=\".gtf\">\n      <p><label for=\"filecuffDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label>\n        <select id=\"filecuffDEF\" name=\"filecuffDEF\">\n        <option value=\"\">Nessun File</option>\n        <option ng-repeat=\"obj in msg.payload.cuff\" value=\"{{obj}}\">{{ obj }}</option>\n        </select></p> <br>\n      <label style=\"font-size:20px\" for=\"outputname\">Output name:&emsp;</label>\n      <input type=\"text\" id=\"outputname\" name=\"outputname\" style=\"width: 200px; height: 20px\" required/>\n      <br><br><br>\n      <label style=\"font-size:20px\" for=\"flanking\">Bb extension to flanking regions 3'/5':&emsp;</label>\n      <input type=\"text\" id=\"flanking\" name=\"flanking\" style=\"width: 200px; height: 20px\"/>\n      <br><br>\n      <label for=\"zip\">Create a .zip output ( if \"NO\" all files can be downloaded individually):</label>\n      <select id=\"zip\" name=\"zip\">\n          <option value=\"yes\">YES</option>\n          <option value=\"no\">NO</option>\n          </select>\n    <p>_________________________________________________________________________________________________________________</p>\n      <br>\n      <button type=\"button\" id=\"sendBtn\" style=\"width: 250px; height: 43px\" onclick=\"uploadFile()\">Invia</button>\n    <br><br>\n    <div style=\"text-align:center;margin-top:40px;\">\n      <progress id=\"progressBar\" value=\"0\" max=\"100\" style=\"width:300px;\"></progress>\n        <p id=\"status\"></p>\n    </div>\n     \n    </form>\n    </center>\n    <script>\n    function uploadFile(){\n    \n    var fileFasta;\n    \n    if(document.getElementById(\"filefastaDEF\").value != \"\")\n    {\n        fileFasta = document.getElementById(\"filefastaDEF\").value;\n    }\n    else {\n        fileFasta = document.getElementById(\"filefasta\").files[0];\n    }\n    \n    var fileCuff;\n    \n    if(document.getElementById(\"filecuffDEF\").value != \"\")\n    {\n        fileCuff = document.getElementById(\"filecuffDEF\").value;\n    }\n    else {\n        fileCuff = document.getElementById(\"filecuff\").files[0];\n    }\n    \n    \n    const prov = new Date;\n    var outputname = document.getElementById('outputname').value +\"_\"+prov.getDate()+\"-\"+(prov.getMonth()+1)+\"-\"+prov.getFullYear()+\"_\"+prov.getHours()+':'+prov.getMinutes()+':'+prov.getSeconds()+\".fasta\";\n    var flanking = document.getElementById('flanking').value\n    var zip = document.getElementById('zip').value\n\n    var formdata = new FormData();\n    formdata.append(\"filefasta\", fileFasta);\n    formdata.append(\"filecuff\", fileCuff);\n    formdata.append(\"outputname\", outputname);\n    formdata.append(\"flanking\", flanking);\n    formdata.append(\"zip\", zip);\n    var ajax = new XMLHttpRequest();\n    ajax.upload.addEventListener(\"progress\", progressHandler, false);\n    ajax.addEventListener(\"load\", completeHandler, false);\n    ajax.addEventListener(\"error\", errorHandler, false);\n    ajax.addEventListener(\"abort\", abortHandler, false);\n    ajax.open(\"POST\", \"/extractfromcuff\");\n    ajax.send(formdata);\n}\n\nfunction progressHandler(event){\n    var percent = (event.loaded / event.total) * 100;\n    document.getElementById(\"progressBar\").value = Math.round(percent);\n    document.getElementById(\"status\").innerHTML = Math.round(percent)+\"% uploaded... please wait\";\n}\nfunction completeHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Done\";\n    document.getElementById(\"progressBar\").value = 0;\n}\nfunction errorHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Failed\";\n}\nfunction abortHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Aborted\";\n}\n        </script>\n      </body>\n</html>","storeOutMessages":false,"fwdInMessages":false,"resendOnRefresh":false,"templateScope":"local","x":570,"y":940,"wires":[[]]},{"id":"c2928bd1.5be6a8","type":"file","z":"815a541e.d91568","name":"CUFF","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":930,"y":1180,"wires":[["96126de4.8e312"]]},{"id":"b90c2f57.1745a","type":"join","z":"815a541e.d91568","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1290,"y":1040,"wires":[["9409fdbe.9bbf7"]]},{"id":"dd0c514d.4884","type":"function","z":"815a541e.d91568","name":"","func":"msg.payload = null;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1080,"y":1060,"wires":[["b90c2f57.1745a"]]},{"id":"96126de4.8e312","type":"function","z":"815a541e.d91568","name":"","func":"msg.payload = null;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1080,"y":1180,"wires":[["b90c2f57.1745a"]]},{"id":"9409fdbe.9bbf7","type":"extract_intron_from_cuff_gtf","z":"815a541e.d91568","name":"","fasta":"","cuff":"","pathfolder":"","outputname":"","flanking":"","x":1390,"y":960,"wires":[["82393700.c313a8","14c04922.1390a7"]]},{"id":"82393700.c313a8","type":"function","z":"815a541e.d91568","name":"","func":"//var name = global.get(\"name\");\nvar name = msg.payload.outputname\n\nif(msg.payload.stdout!==\"Error\") {\nif(msg.payload.zip===\"no\") {\n    if(msg.payload.stdout!==\"Error\" && msg.payload.flanking===\"\") {\n        msg.payload = {\n            fasta : name,\n            fastaPlus : name + \"Plus\"\n        }\n        return [msg,null,null,null];\n    }\n    else if(msg.payload.stdout!==\"Error\" && msg.payload.flanking!==\"\"){\n        msg.filename = name+\"Plus\"\n        msg.payload = {\n            fasta : name,\n            fastaPlus : name+\"Plus\",\n            flDx : \"flanking_Dx_\" + name,\n            flDxPlus : \"flanking_Dx_\" + name + \"Plus\",\n            flSx : \"flanking_Sx_\" + name,\n            flSxPlus : \"flanking_Sx_\" + name + \"Plus\",\n            flTot: \"flanking_tot_\" + name,\n            flTotPlus : \"flanking_tot_\" + name + \"Plus\"\n        }\n        return [null,msg,null,null];\n    }\n}\nelse if(msg.payload.zip===\"yes\") {\n    msg.payload.outputname = msg.payload.outputname.slice(0,-6) + \".zip\";\n    msg.payload.pathIn = \"extractFromCUFF/out\"\n    msg.payload.pathOut = \"extractFromCUFF/\"+msg.payload.outputname\n    return [null,null,msg,null]\n}\n}\nelse {\n    return [null,null,null,msg]\n}","outputs":4,"noerr":0,"initialize":"","finalize":"","x":1740,"y":960,"wires":[["1266c409.99a44c"],["caf908b5.826e18"],["caaaf2ba.7cf2e"],["35140588.cf69aa"]]},{"id":"1266c409.99a44c","type":"delay","z":"815a541e.d91568","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1940,"y":900,"wires":[["fa658fe4.84e44","87a76390.e1575"]]},{"id":"caf908b5.826e18","type":"delay","z":"815a541e.d91568","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1940,"y":960,"wires":[["91a5ec97.f48de","200317a6.7f7f88"]]},{"id":"caaaf2ba.7cf2e","type":"zip_folder","z":"815a541e.d91568","name":"","pathIn":"","pathOut":"","x":1940,"y":1020,"wires":[["9a2fef47.45725","8a92049.5429bf8"]]},{"id":"35140588.cf69aa","type":"delay","z":"815a541e.d91568","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1940,"y":1080,"wires":[["f30f6e.50e3209","2c745012.4d648"]]},{"id":"73f85eed.5b68a","type":"fs-ops-dir","z":"815a541e.d91568","name":"","path":"standardFiles","pathType":"str","filter":"*.fasta","filterType":"str","dir":"payload.fasta","dirType":"msg","x":620,"y":800,"wires":[["86dcbc1b.b1346"]]},{"id":"1f315b85.56a504","type":"ui_ui_control","z":"815a541e.d91568","name":"Refresh page restore","events":"all","x":520,"y":680,"wires":[["f4540131.46107","c94f873f.37d708"]]},{"id":"f4540131.46107","type":"function","z":"815a541e.d91568","name":"","func":"msg.payload = { group: {\n    show : [\"CufflinksIntronsExtraction_Form\"],\n    hide : [\"CufflinksIntronsExtraction_Text\", \"CufflinksIntronsExtraction_Out\", \"CufflinksIntronsExtraction_Error\",\"CufflinksIntronsExtraction_Zip\",\"CufflinksIntronsExtraction_Flanking\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":600,"wires":[["ba2738a2.ca07f8"]]},{"id":"ba2738a2.ca07f8","type":"ui_ui_control","z":"815a541e.d91568","name":"","events":"all","x":900,"y":600,"wires":[[]]},{"id":"c051fd1c.85753","type":"ui_text","z":"815a541e.d91568","group":"6404ee74.eb2cf","order":1,"width":24,"height":4,"name":"","label":"","format":"{{msg.payload.text}}","layout":"col-center","x":1130,"y":940,"wires":[]},{"id":"4405de7d.a247b","type":"function","z":"815a541e.d91568","name":"","func":"msg.payload = { group: {\n    show : [\"CufflinksIntronsExtraction_Text\"],\n    hide : [\"CufflinksIntronsExtraction_Form\"]\n}, text: \"Process in execution... Please wait.\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":960,"y":940,"wires":[["c051fd1c.85753","ba2738a2.ca07f8"]]},{"id":"14c04922.1390a7","type":"function","z":"815a541e.d91568","name":"","func":"if(msg.payload.fasta.startsWith(\"standardFiles\")) {\n    msg.payload.fasta = null\n} else {\n    msg.payload.fasta = msg.payload.fasta.split(\"/\")[2]\n}\nif(msg.payload.cuff.startsWith(\"standardFiles\")) {\n    msg.payload.cuff = null\n} else {\n    msg.payload.cuff = msg.payload.cuff.split(\"/\")[2]\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1560,"y":1060,"wires":[["878d7c19.97886","36e9419b.3c02ae"]]},{"id":"420f7626.5382b8","type":"fs-ops-dir","z":"815a541e.d91568","name":"","path":"standardFiles","pathType":"str","filter":"*.gtf","filterType":"str","dir":"payload.cuff","dirType":"msg","x":620,"y":760,"wires":[["86dcbc1b.b1346"]]},{"id":"c94f873f.37d708","type":"change","z":"815a541e.d91568","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"Go\":\"refresh\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":780,"wires":[["420f7626.5382b8","73f85eed.5b68a"]]},{"id":"86dcbc1b.b1346","type":"join","z":"815a541e.d91568","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":790,"y":860,"wires":[["d0f6856b.dcdf88"]]},{"id":"87a76390.e1575","type":"ui_template","z":"815a541e.d91568","group":"11c767e3.b1ed98","name":"output","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>   \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/extractFromCUFF/out/{{msg.payload.fasta}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.fasta}}</a> <br><br>\n    <a href=\"/file/extractFromCUFF/out/{{msg.payload.fastaPlus}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.fastaPlus}}</a>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":2230,"y":740,"wires":[[]]},{"id":"bee7417f.7a559","type":"ui_ui_control","z":"815a541e.d91568","name":"","events":"all","x":2480,"y":980,"wires":[[]]},{"id":"9a2fef47.45725","type":"function","z":"815a541e.d91568","name":"","func":"msg.payload = { group: {\n    show : [\"CufflinksIntronsExtraction_Zip\"],\n    hide : [\"CufflinksIntronsExtraction_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2240,"y":1020,"wires":[["bee7417f.7a559"]]},{"id":"2c745012.4d648","type":"ui_template","z":"815a541e.d91568","group":"21f75a15.0d4876","name":"error","order":1,"width":0,"height":0,"format":"<html>\n  <body>\n      <center>\n<h1>ERROR during execution!</h1>\n<h3>There was an error in the process. Please, repeat the procedure and check if the inputs files are correct</h3>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":2210,"y":1160,"wires":[[]]},{"id":"f30f6e.50e3209","type":"function","z":"815a541e.d91568","name":"","func":"msg.payload = { group: {\n    show : [\"CufflinksIntronsExtraction_Error\"],\n    hide : [\"CufflinksIntronsExtraction_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2240,"y":1080,"wires":[["bee7417f.7a559"]]},{"id":"8a92049.5429bf8","type":"ui_template","z":"815a541e.d91568","group":"4fe43e67.8a641","name":"zip","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>  \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/{{msg.payload.pathOut}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.outputname}}</a>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":2230,"y":820,"wires":[[]]},{"id":"fa658fe4.84e44","type":"function","z":"815a541e.d91568","name":"","func":"msg.payload = { group: {\n    show : [\"CufflinksIntronsExtraction_Out\"],\n    hide : [\"CufflinksIntronsExtraction_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2240,"y":900,"wires":[["bee7417f.7a559"]]},{"id":"200317a6.7f7f88","type":"ui_template","z":"815a541e.d91568","group":"186e9ebc.21a1b1","name":"flanking","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>   \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/extractFromCUFF/out/{{msg.payload.fasta}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.fasta}}</a> <br><br>\n    <a href=\"/file/extractFromCUFF/out/{{msg.payload.fastaPlus}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.fastaPlus}}</a> <br><br>\n    <a href=\"/file/extractFromCUFF/out/{{msg.payload.flDx}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flDx}}</a> <br><br>\n    <a href=\"/file/extractFromCUFF/out/{{msg.payload.flDxPlus}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flDxPlus}}</a> <br><br>\n    <a href=\"/file/extractFromCUFF/out/{{msg.payload.flSx}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flSx}}</a> <br><br>\n    <a href=\"/file/extractFromCUFF/out/{{msg.payload.flSxPlus}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flSxPlus}}</a> <br><br>\n    <a href=\"/file/extractFromCUFF/out/{{msg.payload.flTot}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flTot}}</a> <br><br>\n    <a href=\"/file/extractFromCUFF/out/{{msg.payload.flTotPlus}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flTotPlus}}</a> <br><br>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":2240,"y":780,"wires":[[]]},{"id":"91a5ec97.f48de","type":"function","z":"815a541e.d91568","name":"","func":"msg.payload = { group: {\n    show : [\"CufflinksIntronsExtraction_Flanking\"],\n    hide : [\"CufflinksIntronsExtraction_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2240,"y":960,"wires":[["bee7417f.7a559"]]},{"id":"99c91959.5516b8","type":"fs-ops-mkdir","z":"815a541e.d91568","name":"","path":"","pathType":"str","dirname":"extractFromCUFF","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":780,"y":1260,"wires":[["60d92561.fdea6c"]]},{"id":"60d92561.fdea6c","type":"fs-ops-mkdir","z":"815a541e.d91568","name":"","path":"extractFromCUFF/","pathType":"str","dirname":"out","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":1000,"y":1260,"wires":[[]]},{"id":"878d7c19.97886","type":"fs-ops-move","z":"815a541e.d91568","name":"","sourcePath":"extractFromCUFF/out/","sourcePathType":"str","sourceFilename":"payload.fasta","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fasta","destFilenameType":"msg","link":false,"x":1700,"y":1120,"wires":[[]]},{"id":"36e9419b.3c02ae","type":"fs-ops-move","z":"815a541e.d91568","name":"","sourcePath":"extractFromCUFF/out/","sourcePathType":"str","sourceFilename":"payload.cuff","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.cuff","destFilenameType":"msg","link":false,"x":1680,"y":1160,"wires":[[]]},{"id":"d887a0b4.751e1","type":"fs-ops-dir","z":"815a541e.d91568","name":"get list of files","path":"sourcePath","pathType":"msg","filter":"*","filterType":"str","dir":"payload","dirType":"msg","x":800,"y":340,"wires":[["811ad63d.2da4d8"]]},{"id":"665c10f4.706ef","type":"fs-ops-move","z":"815a541e.d91568","name":"","sourcePath":"sourcePath","sourcePathType":"msg","sourceFilename":"payload","sourceFilenameType":"msg","destPath":"destinationPath","destPathType":"msg","destFilename":"payload","destFilenameType":"msg","link":false,"x":920,"y":420,"wires":[[]]},{"id":"f911d68f.9b6198","type":"change","z":"815a541e.d91568","name":"","rules":[{"t":"set","p":"sourcePath","pt":"msg","to":"extractFromCUFF/out","tot":"str"},{"t":"set","p":"destinationPath","pt":"msg","to":"standardFiles","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":600,"y":340,"wires":[["d887a0b4.751e1"]]},{"id":"811ad63d.2da4d8","type":"split","z":"815a541e.d91568","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":770,"y":420,"wires":[["665c10f4.706ef"]]},{"id":"bef7258e.393b08","type":"ui_button","z":"815a541e.d91568","name":"","group":"11c767e3.b1ed98","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":300,"y":300,"wires":[["f911d68f.9b6198","f4540131.46107"]]},{"id":"3129941e.57c74c","type":"ui_button","z":"815a541e.d91568","name":"","group":"4fe43e67.8a641","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":300,"y":360,"wires":[["f911d68f.9b6198","f4540131.46107"]]},{"id":"c99e34ec.0ebf68","type":"exec","z":"815a541e.d91568","command":"rm -rf \"extractFromCUFF\"","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"rmDir","x":590,"y":1240,"wires":[[],[],["99c91959.5516b8"]]},{"id":"89664fbe.c1e9","type":"delay","z":"815a541e.d91568","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":640,"y":1080,"wires":[["faeb271f.d03e08","9f5df1dc.cd462"]]},{"id":"8f238ffe.31705","type":"ui_button","z":"815a541e.d91568","name":"","group":"186e9ebc.21a1b1","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":300,"y":420,"wires":[["f911d68f.9b6198","f4540131.46107"]]},{"id":"2fb3b9ec.cbb936","type":"tab","label":"Astalavista-Intron-retention","disabled":false,"info":""},{"id":"89933b08.70c468","type":"http in","z":"2fb3b9ec.cbb936","name":"","url":"/astalavistaintronretention","method":"post","upload":true,"swaggerDoc":"","x":290,"y":1000,"wires":[["67f56636.e3b3b8","a1c86230.6cb87","eb3c46f8.ec5ec8"]]},{"id":"b674825b.53a01","type":"ui_template","z":"2fb3b9ec.cbb936","group":"1858b76f.92a689","name":"Data-table","order":1,"width":24,"height":14,"format":"<html>  \n  <head>\n      <style>\n.center {\n  position: absolute;\n  top: 8%;\n  left: 50%;\n  margin: -25px 0 0 -25px;\n}\n .auto-style1 {\n margin-left: 0px;\n }\n </style>\n  </head>\n  <body>\n  <center>\n \n      <br><br><br><br>\n    <form action=\"/astalavistaintronretention\" method=\"post\" enctype=\"multipart/form-data\">\n    <div style=\"width:700px; height:45px; border:5px outset navy;\"> <font face=\"Verdana\" size=\"6\">Astalavista Intron retention</font><br /></div>\n    <p>The user can extract retained introns using provided Astalavista coordinates (only IR specific coordinates). A variable length flanking regions dataset can be created.</p>\n    <p>_________________________________________________________________________________________________________________</p> <br>\n      <label style=\"font-size:20px\"  for=\"fasta\">Fasta File:&emsp;</label>\n      <input id=\"filefasta\" type=\"file\" name=\"filefasta\" class=\"auto-style1\" style=\"width: 273px; height: 34px\" accept=\".fasta\">\n      <p><label for=\"filefastaDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label>\n        <select id=\"filefastaDEF\" name=\"filefastaDEF\">\n        <option value=\"\">Nessun File</option>\n        <option ng-repeat=\"obj in msg.payload.fasta\" value=\"{{obj}}\">{{ obj }}</option>\n        </select></p> <br>\n      <label style=\"font-size:20px\"  for=\"fasta\">Topat File:&emsp;</label>\n      <input id=\"filetopat\" type=\"file\" name=\"filetopat\" class=\"auto-style1\" style=\"width: 273px; height: 34px\" accept=\".gtf\">\n      <p><label for=\"filetopatDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label>\n        <select id=\"filetopatDEF\" name=\"filetopatDEF\">\n        <option value=\"\">Nessun File</option>\n        <option ng-repeat=\"obj in msg.payload.topat\" value=\"{{obj}}\">{{ obj }}</option>\n        </select></p> <br>\n      <label style=\"font-size:20px\" for=\"outputname\">Output name:&emsp;</label>\n      <input type=\"text\" id=\"outputname\" name=\"outputname\" style=\"width: 200px; height: 20px\" required/>\n      <br><br><br>\n      <label style=\"font-size:20px\" for=\"flanking\">Flanking:&emsp;</label>\n      <input type=\"text\" id=\"flanking\" name=\"flanking\" style=\"width: 200px; height: 20px\"/>\n      <br><br>\n      <label for=\"zip\">Want zip the output(if chose \"NO\" you can download the files individually):</label>\n      <select id=\"zip\" name=\"zip\">\n          <option value=\"yes\">YES</option>\n          <option value=\"no\">NO</option>\n          </select>\n    <p>_________________________________________________________________________________________________________________</p>\n      <br>\n      <button type=\"button\" id=\"sendBtn\" style=\"width: 250px; height: 43px\" onclick=\"uploadFile()\">Invia</button>\n    <br><br>\n    <div style=\"text-align:center;margin-top:40px;\">\n      <progress id=\"progressBar\" value=\"0\" max=\"100\" style=\"width:300px;\"></progress>\n        <p id=\"status\"></p>\n    </div>\n    </form>\n    </center>\n    <script>\n    function uploadFile(){\n    \n    var fileFasta;\n    \n    if(document.getElementById(\"filefastaDEF\").value != \"\")\n    {\n        fileFasta = document.getElementById(\"filefastaDEF\").value;\n    }\n    else {\n        fileFasta = document.getElementById(\"filefasta\").files[0];\n    }\n    \n    var fileTopat;\n    \n    if(document.getElementById(\"filetopatDEF\").value != \"\")\n    {\n        fileTopat = document.getElementById(\"filetopatDEF\").value;\n    }\n    else {\n        fileTopat = document.getElementById(\"filetopat\").files[0];\n    }\n    \n    \n    const prov = new Date;\n    var outputname = document.getElementById('outputname').value +\"_\"+prov.getDate()+\"-\"+(prov.getMonth()+1)+\"-\"+prov.getFullYear()+\"_\"+prov.getHours()+':'+prov.getMinutes()+':'+prov.getSeconds()+\".fasta\";\n    var flanking = document.getElementById('flanking').value\n    var zip = document.getElementById('zip').value\n\n    var formdata = new FormData();\n    formdata.append(\"filefasta\", fileFasta);\n    formdata.append(\"filetopat\", fileTopat);\n    formdata.append(\"outputname\", outputname);\n    formdata.append(\"flanking\", flanking);\n    formdata.append(\"zip\", zip);\n    var ajax = new XMLHttpRequest();\n    ajax.upload.addEventListener(\"progress\", progressHandler, false);\n    ajax.addEventListener(\"load\", completeHandler, false);\n    ajax.addEventListener(\"error\", errorHandler, false);\n    ajax.addEventListener(\"abort\", abortHandler, false);\n    ajax.open(\"POST\", \"/astalavistaintronretention\");\n    ajax.send(formdata);\n}\n\nfunction progressHandler(event){\n    var percent = (event.loaded / event.total) * 100;\n    document.getElementById(\"progressBar\").value = Math.round(percent);\n    document.getElementById(\"status\").innerHTML = Math.round(percent)+\"% uploaded... please wait\";\n}\nfunction completeHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Done\";\n    document.getElementById(\"progressBar\").value = 0;\n}\nfunction errorHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Failed\";\n}\nfunction abortHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Aborted\";\n}\n        </script>\n      </body>\n</html>","storeOutMessages":false,"fwdInMessages":false,"resendOnRefresh":false,"templateScope":"local","x":610,"y":860,"wires":[[]]},{"id":"357e12a1.80eaae","type":"function","z":"2fb3b9ec.cbb936","name":"","func":"var name = msg.payload.outputname;\n\nif(msg.payload.stdout!==\"Error\") {\n    if(msg.payload.zip===\"no\") {\n        if(msg.payload.stdout!==\"Error\" && msg.payload.flanking===\"\") {\n            msg.payload = {\n                fasta : name,\n                fastaPlus : name + \"Plus\"\n            }\n            return [msg,null,null,null];\n        }\n        else if(msg.payload.stdout!==\"Error\" && msg.payload.flanking!==\"\"){\n            msg.filename = name+\"Plus\"\n            msg.payload = {\n                fasta : name,\n                fastaPlus : name+\"Plus\",\n                flDx : \"flanking_Dx_IR_\" + name,\n                flDxPlus : \"flanking_Dx_IR_\" + name + \"Plus\",\n                flSx : \"flanking_Sx_IR_\" + name,\n                flSxPlus : \"flanking_Sx_IR_\" + name + \"Plus\",\n                flIr: \"flanking_IR_\" + name,\n                flIrPlus : \"flanking_IR_\" + name + \"Plus\"\n            }\n            return [null,msg,null,null];\n        }\n    }\n    else if(msg.payload.zip===\"yes\") {\n        msg.payload.outputname = msg.payload.outputname.slice(0,-6) + \".zip\";\n        msg.payload.pathIn = \"extractFromTopat/out\"\n        msg.payload.pathOut = \"extractFromTopat/\"+msg.payload.outputname\n        return [null,null,msg,null]\n    }\n}\nelse {\n    return[null,null,null,msg]\n}","outputs":4,"noerr":0,"initialize":"","finalize":"","x":1860,"y":1020,"wires":[["5116e762.828868"],["91f2862d.977d38"],["58f56f30.c9e6e"],["6f3dba0.e1b8448"]]},{"id":"f7e02259.54413","type":"function","z":"2fb3b9ec.cbb936","name":"","func":"if(msg.req.files.length == 2){\n    var msg1 = { payload: msg.req.files[1].buffer, filename: \"extractFromTopat/out/\" + msg.req.files[1].originalname};\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"extractFromTopat/out/\" + msg.req.files[0].originalname\n\n    return [msg,msg1];\n}\nelse if(msg.req.files.length == 1) {\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"extractFromTopat/out/\" + msg.req.files[0].originalname\n\n    return [msg,null];\n}","outputs":2,"noerr":0,"initialize":"","finalize":"","x":760,"y":1040,"wires":[["61a0f305.bd0eec"],["8e95eeb4.73453"]]},{"id":"61a0f305.bd0eec","type":"file","z":"2fb3b9ec.cbb936","name":"fasta","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":890,"y":980,"wires":[["aa336306.318e3"]]},{"id":"b5359a47.34caa8","type":"function","z":"2fb3b9ec.cbb936","name":"","func":"if (msg.req.files.length ==2) {\n    msg.payload.fasta = \"extractFromTopat/out/\" + msg.req.files[0].originalname\n    msg.payload.tp = \"extractFromTopat/out/\" + msg.req.files[1].originalname\n    msg.payload.pathfolder = \"extractFromTopat/out\"\n    msg.payload.flanking = msg.payload.flanking\n    msg.payload.outputname = msg.payload.outputname\n    return msg;\n}\nelse if (msg.req.files.length ==1) {\n    if(msg.req.files[0].fieldname == \"filefasta\") {\n        msg.payload.fasta = \"extractFromTopat/out/\" + msg.req.files[0].originalname\n        msg.payload.tp = \"standardFiles/\" + msg.payload.filetopat\n        msg.payload.pathfolder = \"extractFromTopat/out\"\n        msg.payload.flanking = msg.payload.flanking\n        msg.payload.outputname = msg.payload.outputname\n        return msg;\n    }\n    if(msg.req.files[0].fieldname == \"filetopat\") {\n        msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n        msg.payload.tp = \"extractFromTopat/out/\" + msg.req.files[0].originalname\n        msg.payload.pathfolder = \"extractFromTopat/out\"\n        msg.payload.flanking = msg.payload.flanking\n        msg.payload.outputname = msg.payload.outputname\n        return msg;\n    }\n}\nelse {\n    msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n    msg.payload.tp = \"standardFiles/\" + msg.payload.filetopat\n    msg.payload.pathfolder = \"extractFromTopat/out\"\n    msg.payload.flanking = msg.payload.flanking\n    msg.payload.outputname = msg.payload.outputname\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1040,"y":920,"wires":[["a64b793c.2fd4f8"]]},{"id":"8e95eeb4.73453","type":"file","z":"2fb3b9ec.cbb936","name":"topat","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":890,"y":1100,"wires":[["42be0a9e.496f54"]]},{"id":"a64b793c.2fd4f8","type":"join","z":"2fb3b9ec.cbb936","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1250,"y":960,"wires":[["5451997a.64b7c8"]]},{"id":"aa336306.318e3","type":"function","z":"2fb3b9ec.cbb936","name":"","func":"msg.payload = null;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1040,"y":980,"wires":[["a64b793c.2fd4f8"]]},{"id":"42be0a9e.496f54","type":"function","z":"2fb3b9ec.cbb936","name":"","func":"msg.payload = null;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1040,"y":1100,"wires":[["a64b793c.2fd4f8"]]},{"id":"5451997a.64b7c8","type":"extract_intron_using_bed_file_from_topat","z":"2fb3b9ec.cbb936","name":"","fasta":"","tp":"","pathfolder":"","outputname":"","flanking":"","x":1500,"y":960,"wires":[["357e12a1.80eaae","b386f8d2.cde948"]]},{"id":"604237a4.68e688","type":"fs-ops-dir","z":"2fb3b9ec.cbb936","name":"","path":"standardFiles","pathType":"str","filter":"*.fasta","filterType":"str","dir":"payload.fasta","dirType":"msg","x":620,"y":700,"wires":[["abcf4693.2a4458"]]},{"id":"50295f44.4dcfd","type":"ui_ui_control","z":"2fb3b9ec.cbb936","name":"Refresh page restore","events":"all","x":520,"y":580,"wires":[["e500c3aa.f2661","71182abf.1f65b4"]]},{"id":"e500c3aa.f2661","type":"function","z":"2fb3b9ec.cbb936","name":"","func":"msg.payload = { group: {\n    show : [\"AstalavistaIntronRetention_Form\"],\n    hide : [\"AstalavistaIntronRetention_Text\", \"AstalavistaIntronRetention_Out\", \"AstalavistaIntronRetention_Error\",\"AstalavistaIntronRetention_Zip\",\"AstalavistaIntronRetention_Flanking\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":500,"wires":[["d71fca6d.5a7958"]]},{"id":"cb50c0fd.26bcb","type":"fs-ops-dir","z":"2fb3b9ec.cbb936","name":"","path":"standardFiles","pathType":"str","filter":"*.gtf","filterType":"str","dir":"payload.topat","dirType":"msg","x":620,"y":660,"wires":[["abcf4693.2a4458"]]},{"id":"71182abf.1f65b4","type":"change","z":"2fb3b9ec.cbb936","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"Go\":\"refresh\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":680,"wires":[["cb50c0fd.26bcb","604237a4.68e688"]]},{"id":"abcf4693.2a4458","type":"join","z":"2fb3b9ec.cbb936","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":790,"y":760,"wires":[["b674825b.53a01"]]},{"id":"d71fca6d.5a7958","type":"ui_ui_control","z":"2fb3b9ec.cbb936","name":"","events":"all","x":900,"y":500,"wires":[[]]},{"id":"67f56636.e3b3b8","type":"function","z":"2fb3b9ec.cbb936","name":"","func":"msg.payload = { group: {\n    show : [\"AstalavistaIntronRetention_Text\"],\n    hide : [\"AstalavistaIntronRetention_Form\"]\n}, text: \"Process in execution... Please wait.\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1000,"y":860,"wires":[["378fcd0f.92e2a2","d71fca6d.5a7958"]]},{"id":"378fcd0f.92e2a2","type":"ui_text","z":"2fb3b9ec.cbb936","group":"41daea1d.0a6e04","order":1,"width":24,"height":4,"name":"","label":"","format":"{{msg.payload.text}}","layout":"col-center","x":1170,"y":860,"wires":[]},{"id":"5116e762.828868","type":"delay","z":"2fb3b9ec.cbb936","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2100,"y":940,"wires":[["82262ae7.186dc8","88d1f3ae.25fe1"]]},{"id":"91f2862d.977d38","type":"delay","z":"2fb3b9ec.cbb936","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2100,"y":1000,"wires":[["1beede32.f30a82","80cf8932.2c79a8"]]},{"id":"58f56f30.c9e6e","type":"zip_folder","z":"2fb3b9ec.cbb936","name":"","pathIn":"","pathOut":"","x":2100,"y":1060,"wires":[["5d79bf85.ac6","9a3f0b63.16c558"]]},{"id":"6f3dba0.e1b8448","type":"delay","z":"2fb3b9ec.cbb936","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":2100,"y":1120,"wires":[["6b5410ec.d1078","40338c15.8dbfa4"]]},{"id":"88d1f3ae.25fe1","type":"ui_template","z":"2fb3b9ec.cbb936","group":"be16c50f.602408","name":"output","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>   \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/extractFromTopat/out/{{msg.payload.fasta}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.fasta}}</a> <br><br>\n    <a href=\"/file/extractFromTopat/out/{{msg.payload.fastaPlus}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.fastaPlus}}</a>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":2390,"y":780,"wires":[[]]},{"id":"172cef33.05d371","type":"ui_ui_control","z":"2fb3b9ec.cbb936","name":"","events":"all","x":2640,"y":1020,"wires":[[]]},{"id":"5d79bf85.ac6","type":"function","z":"2fb3b9ec.cbb936","name":"","func":"msg.payload = { group: {\n    show : [\"AstalavistaIntronRetention_Zip\"],\n    hide : [\"AstalavistaIntronRetention_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2400,"y":1060,"wires":[["172cef33.05d371"]]},{"id":"40338c15.8dbfa4","type":"ui_template","z":"2fb3b9ec.cbb936","group":"1d156d5b.2ed253","name":"error","order":1,"width":0,"height":0,"format":"<html>\n  <body>\n      <center>\n<h1>ERROR during execution!</h1>\n<h3>There was an error in the process. Please, repeat the procedure and check if the inputs files are correct</h3>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":2370,"y":1200,"wires":[[]]},{"id":"6b5410ec.d1078","type":"function","z":"2fb3b9ec.cbb936","name":"","func":"msg.payload = { group: {\n    show : [\"AstalavistaIntronRetention_Error\"],\n    hide : [\"AstalavistaIntronRetention_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2400,"y":1120,"wires":[["172cef33.05d371"]]},{"id":"9a3f0b63.16c558","type":"ui_template","z":"2fb3b9ec.cbb936","group":"f1ea2caf.325de","name":"zip","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>  \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/{{msg.payload.pathOut}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.outputname}}</a>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":2390,"y":860,"wires":[[]]},{"id":"82262ae7.186dc8","type":"function","z":"2fb3b9ec.cbb936","name":"","func":"msg.payload = { group: {\n    show : [\"AstalavistaIntronRetention_Out\"],\n    hide : [\"AstalavistaIntronRetention_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2400,"y":940,"wires":[["172cef33.05d371"]]},{"id":"80cf8932.2c79a8","type":"ui_template","z":"2fb3b9ec.cbb936","group":"7541ab8.3013054","name":"flanking","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>   \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/extractFromTopat/out/{{msg.payload.fasta}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.fasta}}</a> <br><br>\n    <a href=\"/file/extractFromTopat/out/{{msg.payload.fastaPlus}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.fastaPlus}}</a> <br><br>\n    <a href=\"/file/extractFromTopat/out/{{msg.payload.flDx}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flDx}}</a> <br><br>\n    <a href=\"/file/extractFromTopat/out/{{msg.payload.flDxPlus}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flDxPlus}}</a> <br><br>\n    <a href=\"/file/extractFromTopat/out/{{msg.payload.flSx}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flSx}}</a> <br><br>\n    <a href=\"/file/extractFromTopat/out/{{msg.payload.flSxPlus}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flSxPlus}}</a> <br><br>\n    <a href=\"/file/extractFromTopat/out/{{msg.payload.flIr}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flIr}}</a> <br><br>\n    <a href=\"/file/extractFromTopat/out/{{msg.payload.flIrPlus}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flIrPlus}}</a> <br><br>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":2400,"y":820,"wires":[[]]},{"id":"1beede32.f30a82","type":"function","z":"2fb3b9ec.cbb936","name":"","func":"msg.payload = { group: {\n    show : [\"AstalavistaIntronRetention_Flanking\"],\n    hide : [\"AstalavistaIntronRetention_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2400,"y":1000,"wires":[["172cef33.05d371"]]},{"id":"1d570339.adcfbd","type":"fs-ops-mkdir","z":"2fb3b9ec.cbb936","name":"","path":"","pathType":"str","dirname":"extractFromTopat","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":740,"y":1180,"wires":[["e2be4260.8439c"]]},{"id":"e2be4260.8439c","type":"fs-ops-mkdir","z":"2fb3b9ec.cbb936","name":"","path":"extractFromTopat/","pathType":"str","dirname":"out","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":920,"y":1180,"wires":[[]]},{"id":"b386f8d2.cde948","type":"function","z":"2fb3b9ec.cbb936","name":"","func":"if(msg.payload.fasta.startsWith(\"standardFiles\")) {\n    msg.payload.fasta = null\n} else {\n    msg.payload.fasta = msg.payload.fasta.split(\"/\")[2]\n}\nif(msg.payload.tp.startsWith(\"standardFiles\")) {\n    msg.payload.tp = null\n} else {\n    msg.payload.tp = msg.payload.tp.split(\"/\")[2]\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1720,"y":1120,"wires":[["3e71951a.6412ca","ac34ec43.db5a"]]},{"id":"3e71951a.6412ca","type":"fs-ops-move","z":"2fb3b9ec.cbb936","name":"","sourcePath":"extractFromTopat/out/","sourcePathType":"str","sourceFilename":"payload.fasta","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fasta","destFilenameType":"msg","link":false,"x":1920,"y":1180,"wires":[[]]},{"id":"ac34ec43.db5a","type":"fs-ops-move","z":"2fb3b9ec.cbb936","name":"","sourcePath":"extractFromTopat/out/","sourcePathType":"str","sourceFilename":"payload.tp","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.tp","destFilenameType":"msg","link":false,"x":1900,"y":1220,"wires":[[]]},{"id":"eb3c46f8.ec5ec8","type":"exec","z":"2fb3b9ec.cbb936","command":"rm -rf \"extractFromTopat\"","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"rmDir","x":550,"y":1160,"wires":[[],[],["1d570339.adcfbd"]]},{"id":"5cd864e2.76246c","type":"fs-ops-dir","z":"2fb3b9ec.cbb936","name":"get list of files","path":"sourcePath","pathType":"msg","filter":"*","filterType":"str","dir":"payload","dirType":"msg","x":1020,"y":360,"wires":[["a1550727.b57d78"]]},{"id":"508a39db.4ecff8","type":"fs-ops-move","z":"2fb3b9ec.cbb936","name":"","sourcePath":"sourcePath","sourcePathType":"msg","sourceFilename":"payload","sourceFilenameType":"msg","destPath":"destinationPath","destPathType":"msg","destFilename":"payload","destFilenameType":"msg","link":false,"x":1140,"y":440,"wires":[[]]},{"id":"62744edc.e9b76","type":"change","z":"2fb3b9ec.cbb936","name":"","rules":[{"t":"set","p":"sourcePath","pt":"msg","to":"extractFromTopat/out","tot":"str"},{"t":"set","p":"destinationPath","pt":"msg","to":"standardFiles","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":820,"y":360,"wires":[["5cd864e2.76246c"]]},{"id":"a1550727.b57d78","type":"split","z":"2fb3b9ec.cbb936","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":990,"y":440,"wires":[["508a39db.4ecff8"]]},{"id":"a5da24ce.503ee8","type":"ui_button","z":"2fb3b9ec.cbb936","name":"","group":"be16c50f.602408","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":520,"y":320,"wires":[["62744edc.e9b76","e500c3aa.f2661"]]},{"id":"e6a221c4.735e6","type":"ui_button","z":"2fb3b9ec.cbb936","name":"","group":"f1ea2caf.325de","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":520,"y":380,"wires":[["62744edc.e9b76","e500c3aa.f2661"]]},{"id":"10289da7.08bd32","type":"ui_button","z":"2fb3b9ec.cbb936","name":"","group":"7541ab8.3013054","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":520,"y":260,"wires":[["62744edc.e9b76","e500c3aa.f2661"]]},{"id":"a1c86230.6cb87","type":"delay","z":"2fb3b9ec.cbb936","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":600,"y":1000,"wires":[["b5359a47.34caa8","f7e02259.54413"]]},{"id":"e99aee8e.fd0d1","type":"tab","label":"Subtract-fasta-datasets","disabled":false,"info":""},{"id":"1ec4d811.37bc48","type":"http in","z":"e99aee8e.fd0d1","name":"","url":"/removecontingfasta","method":"post","upload":true,"swaggerDoc":"","x":170,"y":860,"wires":[["9e23c74f.014718","da5a0609.040468","f3b70d00.05e8a"]]},{"id":"54c9f23d.64623c","type":"function","z":"e99aee8e.fd0d1","name":"","func":"if(msg.req.files.length == 2) {\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"removeFromFasta/out/\" + msg.req.files[0].originalname\n    var msg1 = { payload: msg.req.files[1].buffer, filename: \"removeFromFasta/out/\" + msg.req.files[1].originalname};\n    return [msg,msg1];\n}\nelse if(msg.req.files.length == 1) {\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"removeFromFasta/out/\" + msg.req.files[0].originalname\n    return [msg,null]\n}","outputs":2,"noerr":0,"initialize":"","finalize":"","x":580,"y":940,"wires":[["37625074.c6381"],["82d52355.84fe9"]]},{"id":"37625074.c6381","type":"file","z":"e99aee8e.fd0d1","name":"","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":710,"y":880,"wires":[["a87d6d0d.7001e"]]},{"id":"beb75fa7.41eb6","type":"function","z":"e99aee8e.fd0d1","name":"","func":"//global.set(\"name\",msg.payload.outputname);\nif (msg.req.files.length ==2) {\n    msg.payload.fasta1 = \"removeFromFasta/out/\" + msg.req.files[0].originalname\n    msg.payload.fasta2 = \"removeFromFasta/out/\" + msg.req.files[1].originalname\n    msg.payload.pathfolder = \"removeFromFasta/out\"\n    msg.payload.outputname = msg.payload.outputname\n    return msg;\n}\nelse if (msg.req.files.length ==1) {\n    if(msg.req.files[0].fieldname == \"filefasta1\") {\n        msg.payload.fasta1 = \"removeFromFasta/out/\" + msg.req.files[0].originalname\n        msg.payload.fasta2 = \"standardFiles/\" + msg.payload.filefasta2\n        msg.payload.pathfolder = \"removeFromFasta/out\"\n        msg.payload.flanking = msg.payload.flanking\n        msg.payload.outputname = msg.payload.outputname\n        return msg;\n    }\n    if(msg.req.files[0].fieldname == \"filefasta2\") {\n        msg.payload.fasta1 = \"standardFiles/\" + msg.payload.filefasta1\n        msg.payload.fasta2 = \"removeFromFasta/out/\" + msg.req.files[0].originalname\n        msg.payload.pathfolder = \"removeFromFasta/out\"\n        msg.payload.flanking = msg.payload.flanking\n        msg.payload.outputname = msg.payload.outputname\n        return msg;\n    }\n}\nelse {\n    msg.payload.fasta1 = \"standardFiles/\" + msg.payload.filefasta1\n    msg.payload.fasta2 = \"standardFiles/\" + msg.payload.filefasta2\n    msg.payload.pathfolder = \"removeFromFasta/out\"\n    msg.payload.flanking = msg.payload.flanking\n    msg.payload.outputname = msg.payload.outputname\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":700,"y":720,"wires":[["b78eb9bd.272bd8"]]},{"id":"ef6df8cd.81f9b8","type":"function","z":"e99aee8e.fd0d1","name":"","func":"//var name = global.get(\"name\");\nif(msg.payload.stdout!==\"Error\") {\n    if(msg.payload.zip===\"no\") {\n        msg.payload = msg.payload.outputname\n        return[msg,null,null]\n    }\n    else if(msg.payload.zip===\"yes\") {\n        msg.payload.outputname = msg.payload.outputname.slice(0,-6) + \".zip\";\n        msg.payload.pathIn = \"removeFromFasta/out\"\n        msg.payload.pathOut = \"removeFromFasta/\"+msg.payload.outputname\n        return [null,msg,null]\n    }\n}\nelse {\n    return [null,null,msg]\n}\n","outputs":3,"noerr":0,"initialize":"","finalize":"","x":1480,"y":860,"wires":[["f9073f6f.d4713"],["d57792c0.b361c"],["d1ce71fb.abc64"]]},{"id":"a87d6d0d.7001e","type":"function","z":"e99aee8e.fd0d1","name":"","func":"msg.payload = {f1: \"yes\"};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":840,"y":880,"wires":[["b78eb9bd.272bd8"]]},{"id":"b78eb9bd.272bd8","type":"join","z":"e99aee8e.fd0d1","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"7","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1050,"y":860,"wires":[["1c9da198.eb61de"]]},{"id":"d381c8a.5633f38","type":"ui_template","z":"e99aee8e.fd0d1","group":"36c2f3a9.d9800c","name":"Data-table","order":1,"width":24,"height":14,"format":"<html>  \n  <head>\n      <style>\n.center {\n  position: absolute;\n  top: 8%;\n  left: 50%;\n  margin: -25px 0 0 -25px;\n}\n .auto-style1 {\n margin-left: 0px;\n }\n </style>\n  </head>\n  <body>\n  <center>\n \n      <br><br><br><br>\n    <form action=\"/removecontingfasta\" method=\"post\" enctype=\"multipart/form-data\">\n    <div style=\"width:700px; height:45px; border:5px outset navy;\"> <font face=\"Verdana\" size=\"6\">Subtract fasta datasets</font><br /></div>\n    <p>The user can remove a subset of sequences from a .fasta file.</p>\n    <p>_________________________________________________________________________________________________________________</p> <br>\n      <br>\n      <label style=\"font-size:20px\"  for=\"filefasta1\">Total Dataset:&emsp;</label>\n      <input id=\"filefasta1\" type=\"file\" name=\"filefasta1\" class=\"auto-style1\" style=\"width: 273px; height: 34px\" accept=\".fasta\" required/>\n       <p><label for=\"filefasta1DEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label>\n        <select id=\"filefasta1DEF\" name=\"filefasta1DEF\">\n        <option value=\"\">Nessun File</option>\n        <option ng-repeat=\"obj in msg.payload.fasta\" value=\"{{obj}}\">{{ obj }}</option>\n        </select></p> <br>\n      <label style=\"font-size:20px\"  for=\"filefasta2\">Dataset to be subtracted:&emsp;</label>\n      <input id=\"filefasta2\" type=\"file\" name=\"filefasta2\" class=\"auto-style1\" style=\"width: 273px; height: 34px\" accept=\".fasta\" required/>\n       <p><label for=\"filefasta2DEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label>\n        <select id=\"filefasta2DEF\" name=\"filefasta2DEF\">\n        <option value=\"\">Nessun File</option>\n        <option ng-repeat=\"obj in msg.payload.fasta\" value=\"{{obj}}\">{{ obj }}</option>\n        </select></p> <br>\n      <label style=\"font-size:20px\" for=\"outputname\">Output name:&emsp;</label>\n      <input type=\"text\" id=\"outputname\" name=\"outputname\" style=\"width: 200px; height: 20px\" required/>\n      <br><br>\n      <label for=\"zip\">Create a .zip output ( if “NO” all files can be downloaded individually):</label>\n      <select id=\"zip\" name=\"zip\">\n          <option value=\"yes\">YES</option>\n          <option value=\"no\">NO</option>\n          </select>\n    <p>_________________________________________________________________________________________________________________</p>\n      <br>\n      <button type=\"button\" id=\"sendBtn\" style=\"width: 250px; height: 43px\" onclick=\"uploadFile()\">Invia</button>\n    <br><br>\n    <div style=\"text-align:center;margin-top:40px;\">\n      <progress id=\"progressBar\" value=\"0\" max=\"100\" style=\"width:300px;\"></progress>\n        <p id=\"status\"></p>\n    </div>\n    </form>\n    </center>\n     <script>\n    function uploadFile(){\n    \n    var fileFasta1;\n    \n    if(document.getElementById(\"filefasta1DEF\").value != \"\")\n    {\n        fileFasta1 = document.getElementById(\"filefasta1DEF\").value;\n    }\n    else {\n        fileFasta1 = document.getElementById(\"filefasta1\").files[0];\n    }\n    \n    var fileFasta2;\n    \n    if(document.getElementById(\"filefasta2DEF\").value != \"\")\n    {\n        fileFasta2 = document.getElementById(\"filefasta2DEF\").value;\n    }\n    else {\n        fileFasta2 = document.getElementById(\"filefasta2\").files[0];\n    }\n    \n    \n    const prov = new Date;\n    var outputname = document.getElementById('outputname').value +\"_\"+prov.getDate()+\"-\"+(prov.getMonth()+1)+\"-\"+prov.getFullYear()+\"_\"+prov.getHours()+':'+prov.getMinutes()+':'+prov.getSeconds()+\".fasta\";\n    var zip = document.getElementById('zip').value\n\n    var formdata = new FormData();\n    formdata.append(\"filefasta1\", fileFasta1);\n    formdata.append(\"filefasta2\", fileFasta2);\n    formdata.append(\"outputname\", outputname);\n    formdata.append(\"zip\", zip);\n    var ajax = new XMLHttpRequest();\n    ajax.upload.addEventListener(\"progress\", progressHandler, false);\n    ajax.addEventListener(\"load\", completeHandler, false);\n    ajax.addEventListener(\"error\", errorHandler, false);\n    ajax.addEventListener(\"abort\", abortHandler, false);\n    ajax.open(\"POST\", \"/removecontingfasta\");\n    ajax.send(formdata);\n}\n\nfunction progressHandler(event){\n    var percent = (event.loaded / event.total) * 100;\n    document.getElementById(\"progressBar\").value = Math.round(percent);\n    document.getElementById(\"status\").innerHTML = Math.round(percent)+\"% uploaded... please wait\";\n}\nfunction completeHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Done\";\n    document.getElementById(\"progressBar\").value = 0;\n}\nfunction errorHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Failed\";\n}\nfunction abortHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Aborted\";\n}\n        </script>\n      </body>\n</html>","storeOutMessages":false,"fwdInMessages":false,"resendOnRefresh":false,"templateScope":"local","x":390,"y":720,"wires":[[]]},{"id":"1c9da198.eb61de","type":"remove_conting_from_fasta","z":"e99aee8e.fd0d1","name":"","fasta1":"","fasta2":"","pathfolder":"","outputname":"","x":1260,"y":860,"wires":[["ef6df8cd.81f9b8","6013d588.c246dc"]]},{"id":"82d52355.84fe9","type":"file","z":"e99aee8e.fd0d1","name":"","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":710,"y":980,"wires":[["78ef8dcd.d59074"]]},{"id":"78ef8dcd.d59074","type":"function","z":"e99aee8e.fd0d1","name":"","func":"msg.payload = {f2: \"yes\"};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":840,"y":980,"wires":[["b78eb9bd.272bd8"]]},{"id":"9c63fc0e.e9693","type":"fs-ops-dir","z":"e99aee8e.fd0d1","name":"","path":"standardFiles","pathType":"str","filter":"*.fasta","filterType":"str","dir":"payload.fasta","dirType":"msg","x":360,"y":580,"wires":[["d381c8a.5633f38"]]},{"id":"18d5b33f.98d00d","type":"ui_ui_control","z":"e99aee8e.fd0d1","name":"Refresh page restore","events":"all","x":420,"y":380,"wires":[["9d499434.61e918","6fc1a5d5.4bbebc"]]},{"id":"9d499434.61e918","type":"function","z":"e99aee8e.fd0d1","name":"","func":"msg.payload = { group: {\n    show : [\"SubtractFastaDatasets_Form\"],\n    hide : [\"SubtractFastaDatasets_Text\", \"SubtractFastaDatasets_Out\", \"SubtractFastaDatasets_Error\",\"SubtractFastaDatasets_Zip\",\"SubtractFastaDatasets_Flanking\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":400,"y":300,"wires":[["56adcb48.f45a14"]]},{"id":"6fc1a5d5.4bbebc","type":"change","z":"e99aee8e.fd0d1","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"Go\":\"refresh\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":480,"wires":[["9c63fc0e.e9693"]]},{"id":"56adcb48.f45a14","type":"ui_ui_control","z":"e99aee8e.fd0d1","name":"","events":"all","x":800,"y":300,"wires":[[]]},{"id":"9e23c74f.014718","type":"function","z":"e99aee8e.fd0d1","name":"","func":"msg.payload = { group: {\n    show : [\"SubtractFastaDatasets_Text\"],\n    hide : [\"SubtractFastaDatasets_Form\"]\n}, text: \"Process in execution... Please wait.\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":700,"y":660,"wires":[["2d53f95.b3daa06","56adcb48.f45a14"]]},{"id":"2d53f95.b3daa06","type":"ui_text","z":"e99aee8e.fd0d1","group":"f2e30963.3f0e58","order":1,"width":24,"height":4,"name":"","label":"","format":"{{msg.payload.text}}","layout":"col-center","x":870,"y":660,"wires":[]},{"id":"f9073f6f.d4713","type":"delay","z":"e99aee8e.fd0d1","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":800,"wires":[["17b46f25.560fe1","a4599d42.1c9e8"]]},{"id":"d57792c0.b361c","type":"zip_folder","z":"e99aee8e.fd0d1","name":"","pathIn":"","pathOut":"","x":1680,"y":860,"wires":[["9a7acb3c.fba8f8","7071a99b.077da8"]]},{"id":"d1ce71fb.abc64","type":"delay","z":"e99aee8e.fd0d1","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1680,"y":920,"wires":[["f5f3664e.6b5258","48b966e6.0f3148"]]},{"id":"a4599d42.1c9e8","type":"ui_template","z":"e99aee8e.fd0d1","group":"6df9caf0.036674","name":"output","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>  \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/removeFromFasta/out/{{msg.payload}}\" onclick=\"clickAndDisable(this);\">{{msg.payload}}</a>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1970,"y":640,"wires":[[]]},{"id":"a06845ac.5ebf98","type":"ui_ui_control","z":"e99aee8e.fd0d1","name":"","events":"all","x":2220,"y":880,"wires":[[]]},{"id":"9a7acb3c.fba8f8","type":"function","z":"e99aee8e.fd0d1","name":"","func":"msg.payload = { group: {\n    show : [\"SubtractFastaDatasets_Zip\"],\n    hide : [\"SubtractFastaDatasets_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1980,"y":860,"wires":[["a06845ac.5ebf98"]]},{"id":"48b966e6.0f3148","type":"ui_template","z":"e99aee8e.fd0d1","group":"c308a23f.10b71","name":"error","order":1,"width":0,"height":0,"format":"<html>\n  <body>\n      <center>\n<h1>ERROR during execution!</h1>\n<h3>There was an error in the process. Please, repeat the procedure and check if the inputs files are correct</h3>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1950,"y":1000,"wires":[[]]},{"id":"f5f3664e.6b5258","type":"function","z":"e99aee8e.fd0d1","name":"","func":"msg.payload = { group: {\n    show : [\"SubtractFastaDatasets_Error\"],\n    hide : [\"SubtractFastaDatasets_Text\",\"SubtractFastaDatasets_Out\",\"SubtractFastaDatasets_Zip\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1980,"y":920,"wires":[["a06845ac.5ebf98"]]},{"id":"7071a99b.077da8","type":"ui_template","z":"e99aee8e.fd0d1","group":"2e821a89.317d16","name":"zip","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>  \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/{{msg.payload.pathOut}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.outputname}}</a>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1970,"y":720,"wires":[[]]},{"id":"17b46f25.560fe1","type":"function","z":"e99aee8e.fd0d1","name":"","func":"msg.payload = { group: {\n    show : [\"SubtractFastaDatasets_Out\"],\n    hide : [\"SubtractFastaDatasets_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1980,"y":800,"wires":[["a06845ac.5ebf98"]]},{"id":"b3816284.e29db","type":"fs-ops-mkdir","z":"e99aee8e.fd0d1","name":"","path":"","pathType":"str","dirname":"removeFromFasta","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":560,"y":1060,"wires":[["e2869a53.46cb58"]]},{"id":"e2869a53.46cb58","type":"fs-ops-mkdir","z":"e99aee8e.fd0d1","name":"","path":"removeFromFasta/","pathType":"str","dirname":"out","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":760,"y":1060,"wires":[[]]},{"id":"6013d588.c246dc","type":"function","z":"e99aee8e.fd0d1","name":"","func":"if(msg.payload.fasta1.startsWith(\"standardFiles\")) {\n    msg.payload.fasta1 = null\n} else {\n    msg.payload.fasta1 = msg.payload.fasta1.split(\"/\")[2]\n}\nif(msg.payload.fasta2.startsWith(\"standardFiles\")) {\n    msg.payload.fasta2 = null\n} else {\n    msg.payload.fasta2 = msg.payload.fasta2.split(\"/\")[2]\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1440,"y":980,"wires":[["c48333e5.42a4e","b1dd6e2a.e9d7"]]},{"id":"c48333e5.42a4e","type":"fs-ops-move","z":"e99aee8e.fd0d1","name":"","sourcePath":"removeFromFasta/out/","sourcePathType":"str","sourceFilename":"payload.fasta1","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fasta1","destFilenameType":"msg","link":false,"x":1640,"y":1040,"wires":[[]]},{"id":"b1dd6e2a.e9d7","type":"fs-ops-move","z":"e99aee8e.fd0d1","name":"","sourcePath":"removeFromFasta/out/","sourcePathType":"str","sourceFilename":"payload.fasta2","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fasta2","destFilenameType":"msg","link":false,"x":1620,"y":1080,"wires":[[]]},{"id":"f3b70d00.05e8a","type":"exec","z":"e99aee8e.fd0d1","command":"rm -rf \"removeFromFasta\"","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"rmDir","x":370,"y":1040,"wires":[["b3816284.e29db"],[],[]]},{"id":"da5a0609.040468","type":"delay","z":"e99aee8e.fd0d1","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":400,"y":900,"wires":[["54c9f23d.64623c","beb75fa7.41eb6"]]},{"id":"32467279.5286ae","type":"fs-ops-dir","z":"e99aee8e.fd0d1","name":"get list of files","path":"sourcePath","pathType":"msg","filter":"*","filterType":"str","dir":"payload","dirType":"msg","x":900,"y":180,"wires":[["ff31d6a4.5a9c98"]]},{"id":"1aebc207.453cfe","type":"fs-ops-move","z":"e99aee8e.fd0d1","name":"","sourcePath":"sourcePath","sourcePathType":"msg","sourceFilename":"payload","sourceFilenameType":"msg","destPath":"destinationPath","destPathType":"msg","destFilename":"payload","destFilenameType":"msg","link":false,"x":1140,"y":280,"wires":[[]]},{"id":"b7f6a53e.fe0b78","type":"change","z":"e99aee8e.fd0d1","name":"","rules":[{"t":"set","p":"sourcePath","pt":"msg","to":"removeFromFasta/out","tot":"str"},{"t":"set","p":"destinationPath","pt":"msg","to":"standardFiles","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":700,"y":180,"wires":[["32467279.5286ae"]]},{"id":"ff31d6a4.5a9c98","type":"split","z":"e99aee8e.fd0d1","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":1070,"y":180,"wires":[["1aebc207.453cfe"]]},{"id":"725faa0.be34b58","type":"ui_button","z":"e99aee8e.fd0d1","name":"","group":"6df9caf0.036674","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":400,"y":140,"wires":[["b7f6a53e.fe0b78","9d499434.61e918"]]},{"id":"753b691a.e936e8","type":"ui_button","z":"e99aee8e.fd0d1","name":"","group":"2e821a89.317d16","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":400,"y":200,"wires":[["b7f6a53e.fe0b78","9d499434.61e918"]]},{"id":"4ae8d91a.38f1c8","type":"tab","label":"Form-Merge-Fasta","disabled":false,"info":""},{"id":"8d53f3e4.46a12","type":"http in","z":"4ae8d91a.38f1c8","name":"","url":"/mergefasta","method":"post","upload":true,"swaggerDoc":"","x":90,"y":700,"wires":[["7c5a57b7.83cfe8","87775c2b.ae74b","b153d659.4b70c8"]]},{"id":"93a6dc0d.04d78","type":"function","z":"4ae8d91a.38f1c8","name":"","func":"if(msg.req.files.length == 2) {\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"mergeFasta/out/\" + msg.req.files[0].originalname\n    var msg1 = { payload: msg.req.files[1].buffer, filename: \"mergeFasta/out/\" + msg.req.files[1].originalname};\n    return [msg,msg1];\n}\nelse if(msg.req.files.length == 1) {\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"mergeFasta/out/\" + msg.req.files[0].originalname\n    return [msg,null]\n}","outputs":2,"noerr":0,"initialize":"","finalize":"","x":500,"y":740,"wires":[["e0e39c1a.dbe48"],["55555f7b.c1ef4"]]},{"id":"e0e39c1a.dbe48","type":"file","z":"4ae8d91a.38f1c8","name":"","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":650,"y":720,"wires":[["c39afb21.c09858"]]},{"id":"40e9c3bc.e19a7c","type":"function","z":"4ae8d91a.38f1c8","name":"","func":"//global.set(\"name\",msg.payload.outputname);\nif(msg.req.files.length ==2) {\n    msg.payload.fasta1 = \"mergeFasta/out/\" + msg.req.files[0].originalname\n    msg.payload.fasta2 = \"mergeFasta/out/\" + msg.req.files[1].originalname\n    msg.payload.pathfolder = \"mergeFasta/out\"\n    msg.payload.outputname = msg.payload.outputname\n    return msg;\n}\nelse if (msg.req.files.length ==1) {\n    if(msg.req.files[0].fieldname == \"filefasta1\") {\n        msg.payload.fasta1 = \"mergeFasta/out/\" + msg.req.files[0].originalname\n        msg.payload.fasta2 = \"standardFiles/\" + msg.payload.filefasta2\n        msg.payload.pathfolder = \"mergeFasta/out\"\n        msg.payload.outputname = msg.payload.outputname\n        return msg;\n    }\n    if(msg.req.files[0].fieldname == \"filefasta2\") {\n        msg.payload.fasta1 = \"standardFiles/\" + msg.payload.filefasta1\n        msg.payload.fasta2 = \"mergeFasta/out/\" + msg.req.files[0].originalname\n        msg.payload.pathfolder = \"mergeFasta/out\"\n        msg.payload.outputname = msg.payload.outputname\n        return msg;\n    }\n}\nelse {\n    msg.payload.fasta1 = \"standardFiles/\" + msg.payload.filefasta1\n    msg.payload.fasta2 = \"standardFiles/\" + msg.payload.filefasta2\n    msg.payload.pathfolder = \"mergeFasta/out\"\n    msg.payload.outputname = msg.payload.outputname\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":640,"y":600,"wires":[["7c2ba981.254968"]]},{"id":"2cb97d1a.3a2bd2","type":"function","z":"4ae8d91a.38f1c8","name":"","func":"//var name = global.get(\"name\");\nif(msg.payload.stdout!==\"Error\") {\n    if(msg.payload.zip===\"no\") {\n        msg.payload = msg.payload.outputname\n        return[msg,null,null]\n    }\n    else if(msg.payload.zip===\"yes\") {\n        msg.payload.outputname = msg.payload.outputname.slice(0,-6) + \".zip\";\n        msg.payload.pathIn = \"mergeFasta/out\"\n        msg.payload.pathOut = \"mergeFasta/\"+msg.payload.outputname\n        return [null,msg,null]\n    }\n}\nelse {\n    return [null,null,msg]\n}\n","outputs":3,"noerr":0,"initialize":"","finalize":"","x":1360,"y":680,"wires":[["272d8196.000f4e"],["3cf8a310.dd2dcc"],["219f2e75.7262f2"]]},{"id":"c39afb21.c09858","type":"function","z":"4ae8d91a.38f1c8","name":"","func":"msg.payload = {f1: \"yes\"};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":780,"y":720,"wires":[["7c2ba981.254968"]]},{"id":"7c2ba981.254968","type":"join","z":"4ae8d91a.38f1c8","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"7","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":950,"y":680,"wires":[["b7a6ae79.5c7c1"]]},{"id":"b8a24c2d.f1bea","type":"ui_template","z":"4ae8d91a.38f1c8","group":"23cf321b.86f3fe","name":"Data-table","order":1,"width":24,"height":14,"format":"<html>  \n  <head>\n      <style>\n.center {\n  position: absolute;\n  top: 8%;\n  left: 50%;\n  margin: -25px 0 0 -25px;\n}\n .auto-style1 {\n margin-left: 0px;\n }\n </style>\n  </head>\n  <body>\n  <center>\n \n      <br><br><br><br>\n    <form action=\"/mergefasta\" method=\"post\" enctype=\"multipart/form-data\">\n    <div style=\"width:700px; height:45px; border:5px outset navy;\"> <font face=\"Verdana\" size=\"6\">Merge fasta</font><br /></div>\n    <p>_________________________________________________________________________________________________________________</p> <br>\n      <br>\n      <label style=\"font-size:20px\"  for=\"fasta1\">Fasta File 1:&emsp;</label>\n      <input id=\"filefasta1\" type=\"file\" name=\"filefasta1\" class=\"auto-style1\" style=\"width: 273px; height: 34px\" accept=\".fasta\">\n      <p><label for=\"filefasta1DEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label>\n      <select id=\"filefasta1DEF\" name=\"filefasta1DEF\">\n        <option value=\"\">Nessun File</option>\n        <option ng-repeat=\"obj in msg.payload.fasta\" value=\"{{obj}}\">{{ obj }}</option>\n        </select></p>\n      <label style=\"font-size:20px\"  for=\"fasta2\">Fasta File 2:&emsp;</label>\n      <input id=\"filefasta2\" type=\"file\" name=\"filefasta2\" class=\"auto-style1\" style=\"width: 273px; height: 34px\" accept=\".fasta\">\n      <p><label for=\"filefasta2DEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label>\n      <select id=\"filefasta2DEF\" name=\"filefasta2DEF\">\n        <option value=\"\">Nessun File</option>\n        <option ng-repeat=\"obj in msg.payload.fasta\" value=\"{{obj}}\">{{ obj }}</option>\n        </select></p>\n      <label style=\"font-size:20px\" for=\"outputname\">Output name:&emsp;</label>\n      <input type=\"text\" id=\"outputname\" name=\"outputname\" style=\"width: 200px; height: 20px\" required/>\n      <br><br>\n      <label for=\"zip\">Create a .zip output ( if “NO” all files can be downloaded individually)</label>\n      <select id=\"zip\" name=\"zip\">\n          <option value=\"yes\">YES</option>\n          <option value=\"no\">NO</option>\n          </select>\n    <p>_________________________________________________________________________________________________________________</p>\n      <br>\n      <button type=\"button\" id=\"sendBtn\" style=\"width: 250px; height: 43px\" onclick=\"uploadFile()\">Invia</button>\n    <br><br>\n    <div style=\"text-align:center;margin-top:40px;\">\n      <progress id=\"progressBar\" value=\"0\" max=\"100\" style=\"width:300px;\"></progress>\n        <p id=\"status\"></p>\n    </div>\n    </form>\n    </center>\n    <script>\n    function uploadFile(){\n    \n    var fileFasta1;\n    \n    if(document.getElementById(\"filefasta1DEF\").value != \"\")\n    {\n        fileFasta1 = document.getElementById(\"filefasta1DEF\").value;\n    }\n    else {\n        fileFasta1 = document.getElementById(\"filefasta1\").files[0];\n    }\n    \n    var fileFasta2;\n    \n    if(document.getElementById(\"filefasta2DEF\").value != \"\")\n    {\n        fileFasta2 = document.getElementById(\"filefasta2DEF\").value;\n    }\n    else {\n        fileFasta2 = document.getElementById(\"filefasta2\").files[0];\n    }\n    \n    \n    const prov = new Date;\n    var outputname = document.getElementById('outputname').value +\"_\"+prov.getDate()+\"-\"+(prov.getMonth()+1)+\"-\"+prov.getFullYear()+\"_\"+prov.getHours()+':'+prov.getMinutes()+':'+prov.getSeconds()+\".fasta\";\n    var zip = document.getElementById('zip').value\n\n    var formdata = new FormData();\n    formdata.append(\"filefasta1\", fileFasta1);\n    formdata.append(\"filefasta2\", fileFasta2);\n    formdata.append(\"outputname\", outputname);\n    formdata.append(\"zip\", zip);\n    var ajax = new XMLHttpRequest();\n    ajax.upload.addEventListener(\"progress\", progressHandler, false);\n    ajax.addEventListener(\"load\", completeHandler, false);\n    ajax.addEventListener(\"error\", errorHandler, false);\n    ajax.addEventListener(\"abort\", abortHandler, false);\n    ajax.open(\"POST\", \"/mergefasta\");\n    ajax.send(formdata);\n}\n\nfunction progressHandler(event){\n    var percent = (event.loaded / event.total) * 100;\n    document.getElementById(\"progressBar\").value = Math.round(percent);\n    document.getElementById(\"status\").innerHTML = Math.round(percent)+\"% uploaded... please wait\";\n}\nfunction completeHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Done\";\n    document.getElementById(\"progressBar\").value = 0;\n}\nfunction errorHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Failed\";\n}\nfunction abortHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Aborted\";\n}\n        </script>\n      </body>\n</html>","storeOutMessages":false,"fwdInMessages":false,"resendOnRefresh":false,"templateScope":"local","x":330,"y":540,"wires":[[]]},{"id":"55555f7b.c1ef4","type":"file","z":"4ae8d91a.38f1c8","name":"","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":650,"y":780,"wires":[["7e07c448.110f7c"]]},{"id":"7e07c448.110f7c","type":"function","z":"4ae8d91a.38f1c8","name":"","func":"msg.payload = {f2: \"yes\"};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":780,"y":780,"wires":[["7c2ba981.254968"]]},{"id":"b7a6ae79.5c7c1","type":"merge_fasta","z":"4ae8d91a.38f1c8","name":"","fasta1":"","fasta2":"","pathfolder":"","outputname":"","x":1120,"y":680,"wires":[["2cb97d1a.3a2bd2","885794e5.f21478"]]},{"id":"64e4490c.b32338","type":"fs-ops-dir","z":"4ae8d91a.38f1c8","name":"","path":"standardFiles","pathType":"str","filter":"*.fasta","filterType":"str","dir":"payload.fasta","dirType":"msg","x":320,"y":420,"wires":[["b8a24c2d.f1bea"]]},{"id":"e7dad36b.17648","type":"ui_ui_control","z":"4ae8d91a.38f1c8","name":"Refresh page restore","events":"all","x":380,"y":220,"wires":[["6f29add8.bfc284","f53b52fb.9b95"]]},{"id":"6f29add8.bfc284","type":"function","z":"4ae8d91a.38f1c8","name":"","func":"msg.payload = { group: {\n    show : [\"MergeFasta_Form\"],\n    hide : [\"MergeFasta_Text\", \"MergeFasta_Out\", \"MergeFasta_Error\",\"MergeFasta_Zip\",\"MergeFasta_Flanking\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":360,"y":140,"wires":[["52e14392.9501bc"]]},{"id":"f53b52fb.9b95","type":"change","z":"4ae8d91a.38f1c8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"Go\":\"refresh\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":320,"y":320,"wires":[["64e4490c.b32338"]]},{"id":"52e14392.9501bc","type":"ui_ui_control","z":"4ae8d91a.38f1c8","name":"","events":"all","x":760,"y":140,"wires":[[]]},{"id":"7c5a57b7.83cfe8","type":"function","z":"4ae8d91a.38f1c8","name":"","func":"msg.payload = { group: {\n    show : [\"MergeFasta_Text\"],\n    hide : [\"MergeFasta_Form\"]\n}, text: \"Process in execution... Please wait.\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":660,"y":500,"wires":[["38beb42c.d2afdc","52e14392.9501bc"]]},{"id":"38beb42c.d2afdc","type":"ui_text","z":"4ae8d91a.38f1c8","group":"99f4bf7c.550e1","order":1,"width":24,"height":4,"name":"","label":"","format":"{{msg.payload.text}}","layout":"col-center","x":830,"y":500,"wires":[]},{"id":"272d8196.000f4e","type":"delay","z":"4ae8d91a.38f1c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1580,"y":620,"wires":[["8607b91b.d355f8","e4e243f3.269e1"]]},{"id":"3cf8a310.dd2dcc","type":"zip_folder","z":"4ae8d91a.38f1c8","name":"","pathIn":"","pathOut":"","x":1580,"y":680,"wires":[["c1a9f98e.69d4a8","d1ab0b8d.6c4d98"]]},{"id":"219f2e75.7262f2","type":"delay","z":"4ae8d91a.38f1c8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1580,"y":740,"wires":[["da0019ad.5e06e8","cd35e5dd.b6e1b8"]]},{"id":"e4e243f3.269e1","type":"ui_template","z":"4ae8d91a.38f1c8","group":"49102c0f.cf00f4","name":"output","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>  \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/mergeFasta/out/{{msg.payload}}\" onclick=\"clickAndDisable(this);\">{{msg.payload}}</a>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1870,"y":460,"wires":[[]]},{"id":"e25e064e.63b488","type":"ui_ui_control","z":"4ae8d91a.38f1c8","name":"","events":"all","x":2120,"y":700,"wires":[[]]},{"id":"c1a9f98e.69d4a8","type":"function","z":"4ae8d91a.38f1c8","name":"","func":"msg.payload = { group: {\n    show : [\"MergeFasta_Zip\"],\n    hide : [\"MergeFasta_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1880,"y":680,"wires":[["e25e064e.63b488"]]},{"id":"cd35e5dd.b6e1b8","type":"ui_template","z":"4ae8d91a.38f1c8","group":"a8b834b9.172ae8","name":"error","order":1,"width":0,"height":0,"format":"<html>\n  <body>\n      <center>\n<h1>ERROR during execution!</h1>\n<h3>There was an error in the process. Please, repeat the procedure and check if the inputs files are correct</h3>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1850,"y":820,"wires":[[]]},{"id":"da0019ad.5e06e8","type":"function","z":"4ae8d91a.38f1c8","name":"","func":"msg.payload = { group: {\n    show : [\"MergeFasta_Error\"],\n    hide : [\"MergeFasta_Text\",\"MergeFasta_Out\",\"MergeFasta_Zip\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1880,"y":740,"wires":[["e25e064e.63b488"]]},{"id":"d1ab0b8d.6c4d98","type":"ui_template","z":"4ae8d91a.38f1c8","group":"6d130006.a1c71","name":"zip","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>  \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/{{msg.payload.pathOut}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.outputname}}</a>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1870,"y":540,"wires":[[]]},{"id":"8607b91b.d355f8","type":"function","z":"4ae8d91a.38f1c8","name":"","func":"msg.payload = { group: {\n    show : [\"MergeFasta_Out\"],\n    hide : [\"MergeFasta_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1880,"y":620,"wires":[["e25e064e.63b488"]]},{"id":"1643d11b.8897df","type":"fs-ops-mkdir","z":"4ae8d91a.38f1c8","name":"","path":"","pathType":"str","dirname":"mergeFasta","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":580,"y":900,"wires":[["a4a5d9d6.274a28"]]},{"id":"a4a5d9d6.274a28","type":"fs-ops-mkdir","z":"4ae8d91a.38f1c8","name":"","path":"mergeFasta/","pathType":"str","dirname":"out","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":780,"y":900,"wires":[[]]},{"id":"885794e5.f21478","type":"function","z":"4ae8d91a.38f1c8","name":"","func":"if(msg.payload.fasta1.startsWith(\"standardFiles\")) {\n    msg.payload.fasta1 = null\n} else {\n    msg.payload.fasta1 = msg.payload.fasta1.split(\"/\")[2]\n}\nif(msg.payload.fasta2.startsWith(\"standardFiles\")) {\n    msg.payload.fasta2 = null\n} else {\n    msg.payload.fasta2 = msg.payload.fasta2.split(\"/\")[2]\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1260,"y":760,"wires":[["313a5c1a.42a954","616589b0.aed658"]]},{"id":"313a5c1a.42a954","type":"fs-ops-move","z":"4ae8d91a.38f1c8","name":"","sourcePath":"mergeFasta/out/","sourcePathType":"str","sourceFilename":"payload.fasta1","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fasta1","destFilenameType":"msg","link":false,"x":1460,"y":820,"wires":[[]]},{"id":"616589b0.aed658","type":"fs-ops-move","z":"4ae8d91a.38f1c8","name":"","sourcePath":"mergeFasta/out/","sourcePathType":"str","sourceFilename":"payload.fasta2","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fasta2","destFilenameType":"msg","link":false,"x":1440,"y":860,"wires":[[]]},{"id":"87775c2b.ae74b","type":"exec","z":"4ae8d91a.38f1c8","command":"rm -rf \"mergeFasta\"","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"rmDir","x":410,"y":900,"wires":[[],[],["1643d11b.8897df"]]},{"id":"b153d659.4b70c8","type":"delay","z":"4ae8d91a.38f1c8","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":340,"y":700,"wires":[["40e9c3bc.e19a7c","93a6dc0d.04d78"]]},{"id":"554c0080.ff304","type":"fs-ops-dir","z":"4ae8d91a.38f1c8","name":"get list of files","path":"sourcePath","pathType":"msg","filter":"*","filterType":"str","dir":"payload","dirType":"msg","x":880,"y":60,"wires":[["9346307e.83a79"]]},{"id":"f9011003.a796f","type":"change","z":"4ae8d91a.38f1c8","name":"","rules":[{"t":"set","p":"sourcePath","pt":"msg","to":"mergeFasta/out","tot":"str"},{"t":"set","p":"destinationPath","pt":"msg","to":"standardFiles","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":680,"y":60,"wires":[["554c0080.ff304"]]},{"id":"9346307e.83a79","type":"split","z":"4ae8d91a.38f1c8","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":1050,"y":60,"wires":[["a42add81.37dfa"]]},{"id":"ff67372a.40dd68","type":"ui_button","z":"4ae8d91a.38f1c8","name":"","group":"49102c0f.cf00f4","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":380,"y":20,"wires":[["f9011003.a796f","6f29add8.bfc284"]]},{"id":"9b23ddee.6ab54","type":"ui_button","z":"4ae8d91a.38f1c8","name":"","group":"6d130006.a1c71","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":380,"y":80,"wires":[["f9011003.a796f","6f29add8.bfc284"]]},{"id":"a42add81.37dfa","type":"fs-ops-move","z":"4ae8d91a.38f1c8","name":"","sourcePath":"sourcePath","sourcePathType":"msg","sourceFilename":"payload","sourceFilenameType":"msg","destPath":"destinationPath","destPathType":"msg","destFilename":"payload","destFilenameType":"msg","link":false,"x":1120,"y":160,"wires":[[]]},{"id":"1a1d4b73.c43d45","type":"tab","label":"Form-Remove-Nucleotides","disabled":false,"info":""},{"id":"14e1cf61.d00751","type":"http in","z":"1a1d4b73.c43d45","name":"","url":"/removenucleotides","method":"post","upload":true,"swaggerDoc":"","x":190,"y":680,"wires":[["ea813433.56e418","a14a722e.2e3bc","205d1712.ab7248"]]},{"id":"1897c378.894fcd","type":"function","z":"1a1d4b73.c43d45","name":"","func":"if(msg.req.files.length == 1) {\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"removeNucleotides/out/\" + msg.req.files[0].originalname\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":580,"y":700,"wires":[["cd323f82.bb391"]]},{"id":"cd323f82.bb391","type":"file","z":"1a1d4b73.c43d45","name":"","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":710,"y":700,"wires":[["4d21e16b.11d18"]]},{"id":"821552af.df742","type":"function","z":"1a1d4b73.c43d45","name":"","func":"//global.set(\"name\",msg.payload.outputname);\n\nif(msg.req.files.length == 1) {\n    msg.payload.fasta = \"removeNucleotides/out/\" + msg.req.files[0].originalname\n}\nelse {\n    msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n}\n\nmsg.payload.n = msg.payload.n\nmsg.payload.pathfolder = \"removeNucleotides/out\"\nmsg.payload.outputname = msg.payload.outputname\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":680,"y":560,"wires":[["e839674.6532598"]]},{"id":"7a1bb66a.ffde28","type":"function","z":"1a1d4b73.c43d45","name":"","func":"//var name = global.get(\"name\");\nif(msg.payload.stdout!==\"Error\") {\n    if(msg.payload.zip===\"no\") {\n        msg.payload = msg.payload.outputname\n        return[msg,null,null]\n    }\n    else if(msg.payload.zip===\"yes\") {\n        msg.payload.outputname = msg.payload.outputname.slice(0,-6) + \".zip\";\n        msg.payload.pathIn = \"removeNucleotides/out\"\n        msg.payload.pathOut = \"removeNucleotides/\"+msg.payload.outputname\n        return [null,msg,null]\n    }\n}\nelse {\n    return [null,null,msg]\n}\n","outputs":3,"noerr":0,"initialize":"","finalize":"","x":1380,"y":660,"wires":[["fcd59cdc.aeff1"],["962c80ac.286d"],["7b5f5423.d19abc"]]},{"id":"4d21e16b.11d18","type":"function","z":"1a1d4b73.c43d45","name":"","func":"msg.payload = null;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":860,"y":700,"wires":[["e839674.6532598"]]},{"id":"e839674.6532598","type":"join","z":"1a1d4b73.c43d45","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":990,"y":660,"wires":[["b95895b.bd3c268"]]},{"id":"9045b5a8.3f8118","type":"ui_template","z":"1a1d4b73.c43d45","group":"112be209.3b267e","name":"Data-table","order":1,"width":24,"height":14,"format":"<html>  \n  <head>\n      <style>\n.center {\n  position: absolute;\n  top: 8%;\n  left: 50%;\n  margin: -25px 0 0 -25px;\n}\n .auto-style1 {\n margin-left: 0px;\n }\n </style>\n  </head>\n  <body>\n  <center>\n \n      <br><br><br><br>\n    <form action=\"/removenucleotides\" method=\"post\" enctype=\"multipart/form-data\">\n    <div style=\"width:700px; height:45px; border:5px outset navy;\"> <font face=\"Verdana\" size=\"6\">REMOVE NUCLEOTIDES</font><br /></div>\n    <p>_________________________________________________________________________________________________________________</p> <br>\n      <br>\n      <label style=\"font-size:20px\"  for=\"fasta\">Fasta File:&emsp;</label>\n      <input id=\"filefasta\" type=\"file\" name=\"filefasta\" class=\"auto-style1\" style=\"width: 273px; height: 34px\" accept=\".fasta\">\n      <p><label for=\"filefastaDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label>\n        <select id=\"filefastaDEF\" name=\"filefastaDEF\">\n        <option value=\"\">Nessun File</option>\n        <option ng-repeat=\"obj in msg.payload\" value=\"{{obj}}\">{{ obj }}</option>\n        </select></p> <br>\n      <label style=\"font-size:20px\"  for=\"fasta2\">Number of Nucleotides to remove:&emsp;</label>\n      <input type=\"text\" name=\"n\" id=\"n\" style=\"width: 200px; height: 20px\" required/>\n      <br><br><br>\n      <label style=\"font-size:20px\" for=\"outputname\">Output name:&emsp;</label>\n      <input type=\"text\" id=\"outputname\" name=\"outputname\" style=\"width: 200px; height: 20px\" required/>\n      <br><br>\n      <label for=\"zip\">Create a .zip output ( if \"NO\" all files can be downloaded individually):</label>\n      <select id=\"zip\" name=\"zip\">\n          <option value=\"yes\">YES</option>\n          <option value=\"no\">NO</option>\n          </select>\n    <p>_________________________________________________________________________________________________________________</p>\n      <br>\n      <button type=\"button\" id=\"sendBtn\" style=\"width: 250px; height: 43px\" onclick=\"uploadFile()\">Invia</button>\n    <br><br>\n    <div style=\"text-align:center;margin-top:40px;\">\n      <progress id=\"progressBar\" value=\"0\" max=\"100\" style=\"width:300px;\"></progress>\n        <p id=\"status\"></p>\n    </div>\n     \n    </form>\n    </center>\n     <script>\n    function uploadFile(){\n    \n    var fileFasta;\n    \n    if(document.getElementById(\"filefastaDEF\").value != \"\")\n    {\n        fileFasta = document.getElementById(\"filefastaDEF\").value;\n    }\n    else {\n        fileFasta = document.getElementById(\"filefasta\").files[0];\n    }\n    \n    \n    const prov = new Date;\n    var outputname = document.getElementById('outputname').value +\"_\"+prov.getDate()+\"-\"+(prov.getMonth()+1)+\"-\"+prov.getFullYear()+\"_\"+prov.getHours()+':'+prov.getMinutes()+':'+prov.getSeconds()+\".fasta\";\n    var zip = document.getElementById('zip').value\n    var n = document.getElementById('n').value\n\n    var formdata = new FormData();\n    formdata.append(\"filefasta\", fileFasta);\n    formdata.append(\"outputname\", outputname);\n    formdata.append(\"zip\", zip);\n    formdata.append(\"n\", n);\n    var ajax = new XMLHttpRequest();\n    ajax.upload.addEventListener(\"progress\", progressHandler, false);\n    ajax.addEventListener(\"load\", completeHandler, false);\n    ajax.addEventListener(\"error\", errorHandler, false);\n    ajax.addEventListener(\"abort\", abortHandler, false);\n    ajax.open(\"POST\", \"/removenucleotides\");\n    ajax.send(formdata);\n}\n\nfunction progressHandler(event){\n    var percent = (event.loaded / event.total) * 100;\n    document.getElementById(\"progressBar\").value = Math.round(percent);\n    document.getElementById(\"status\").innerHTML = Math.round(percent)+\"% uploaded... please wait\";\n}\nfunction completeHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Done\";\n    document.getElementById(\"progressBar\").value = 0;\n}\nfunction errorHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Failed\";\n}\nfunction abortHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Aborted\";\n}\n        </script>\n      </body>\n</html>","storeOutMessages":false,"fwdInMessages":false,"resendOnRefresh":false,"templateScope":"local","x":290,"y":560,"wires":[[]]},{"id":"b95895b.bd3c268","type":"remove_nucleotides","z":"1a1d4b73.c43d45","name":"","fasta":"","n":"","pathfolder":"","outputname":"","x":1180,"y":660,"wires":[["7a1bb66a.ffde28","9f38f35.474d01"]]},{"id":"da9c0798.523388","type":"fs-ops-dir","z":"1a1d4b73.c43d45","name":"","path":"standardFiles","pathType":"str","filter":"*fasta","filterType":"str","dir":"payload","dirType":"msg","x":340,"y":480,"wires":[["9045b5a8.3f8118"]]},{"id":"2b3273ed.13512c","type":"ui_ui_control","z":"1a1d4b73.c43d45","name":"Refresh page restore","events":"all","x":260,"y":400,"wires":[["da9c0798.523388","ada60eb8.625e1"]]},{"id":"ada60eb8.625e1","type":"function","z":"1a1d4b73.c43d45","name":"","func":"msg.payload = { group: {\n    show : [\"RemoveNucleotides_Form\"],\n    hide : [\"RemoveNucleotides_Text\", \"RemoveNucleotides_Out\", \"RemoveNucleotides_Error\",\"RemoveNucleotides_Zip\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":240,"y":320,"wires":[["3f263174.24f84e"]]},{"id":"3f263174.24f84e","type":"ui_ui_control","z":"1a1d4b73.c43d45","name":"","events":"all","x":640,"y":320,"wires":[[]]},{"id":"fcd59cdc.aeff1","type":"delay","z":"1a1d4b73.c43d45","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1640,"y":600,"wires":[["a1db3299.af463","5c5a78db.d78eb8"]]},{"id":"962c80ac.286d","type":"zip_folder","z":"1a1d4b73.c43d45","name":"","pathIn":"","pathOut":"","x":1640,"y":660,"wires":[["5cd46a6c.b15ea4","e99c64c.af8a498"]]},{"id":"7b5f5423.d19abc","type":"delay","z":"1a1d4b73.c43d45","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1640,"y":720,"wires":[["3f5a52ef.e5c56e","141c9308.6d70cd"]]},{"id":"a1db3299.af463","type":"ui_template","z":"1a1d4b73.c43d45","group":"1f86516c.1caddf","name":"output","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>  \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/removeNucleotides/out/flanking_Dx_{{msg.payload}}\" onclick=\"clickAndDisable(this);\">flanking_Dx_{{msg.payload}}</a> <br><br>\n    <a href=\"/file/removeNucleotides/out/flanking_Sx_{{msg.payload}}\" onclick=\"clickAndDisable(this);\">flanking_Sx_{{msg.payload}}</a> <br><br>\n    <a href=\"/file/removeNucleotides/out/no_flanking_{{msg.payload}}\" onclick=\"clickAndDisable(this);\">no_flanking_{{msg.payload}}</a> <br><br>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1750,"y":480,"wires":[[]]},{"id":"cb087423.4df768","type":"ui_ui_control","z":"1a1d4b73.c43d45","name":"","events":"all","x":2080,"y":660,"wires":[[]]},{"id":"5cd46a6c.b15ea4","type":"function","z":"1a1d4b73.c43d45","name":"","func":"msg.payload = { group: {\n    show : [\"RemoveNucleotides_Zip\"],\n    hide : [\"RemoveNucleotides_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1860,"y":660,"wires":[["cb087423.4df768"]]},{"id":"141c9308.6d70cd","type":"ui_template","z":"1a1d4b73.c43d45","group":"1f01b95f.b2eb67","name":"error","order":1,"width":0,"height":0,"format":"<html>\n  <body>\n      <center>\n<h1>ERROR during execution!</h1>\n<h3>There was an error in the process. Please, repeat the procedure and check if the inputs files are correct</h3>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1850,"y":800,"wires":[[]]},{"id":"3f5a52ef.e5c56e","type":"function","z":"1a1d4b73.c43d45","name":"","func":"msg.payload = { group: {\n    show : [\"RemoveNucleotides_Error\"],\n    hide : [\"RemoveNucleotides_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1860,"y":720,"wires":[["cb087423.4df768"]]},{"id":"e99c64c.af8a498","type":"ui_template","z":"1a1d4b73.c43d45","group":"571692af.cbdf1c","name":"zip","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>  \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/{{msg.payload.pathOut}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.outputname}}</a>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1770,"y":540,"wires":[[]]},{"id":"5c5a78db.d78eb8","type":"function","z":"1a1d4b73.c43d45","name":"","func":"msg.payload = { group: {\n    show : [\"RemoveNucleotides_Out\"],\n    hide : [\"RemoveNucleotides_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1860,"y":600,"wires":[["cb087423.4df768"]]},{"id":"af7b87fb.c0a4a8","type":"ui_text","z":"1a1d4b73.c43d45","group":"b519a721.59f3a8","order":1,"width":24,"height":4,"name":"","label":"","format":"Removing Nucleotides... Please wait.","layout":"col-center","x":790,"y":480,"wires":[]},{"id":"ea813433.56e418","type":"function","z":"1a1d4b73.c43d45","name":"","func":"msg.payload = { group: {\n    show : [\"RemoveNucleotides_Text\"],\n    hide : [\"RemoveNucleotides_Form\"]\n}, text: \"Removing Nucleotides... Please wait.\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":600,"y":480,"wires":[["af7b87fb.c0a4a8","3f263174.24f84e"]]},{"id":"4ffc0a55.77e174","type":"fs-ops-mkdir","z":"1a1d4b73.c43d45","name":"","path":"","pathType":"str","dirname":"removeNucleotides","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":560,"y":800,"wires":[["baf3695.ad7aa98"]]},{"id":"baf3695.ad7aa98","type":"fs-ops-mkdir","z":"1a1d4b73.c43d45","name":"","path":"removeNucleotides/","pathType":"str","dirname":"out","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":760,"y":800,"wires":[[]]},{"id":"9f38f35.474d01","type":"function","z":"1a1d4b73.c43d45","name":"","func":"if(msg.payload.fasta.startsWith(\"standardFiles\")) {\n    msg.payload.fasta = null\n}\nelse {\n    msg.payload.fasta = msg.payload.fasta.split(\"/\")[2]\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1160,"y":780,"wires":[["3a4b3fa.5b665c"]]},{"id":"3a4b3fa.5b665c","type":"fs-ops-move","z":"1a1d4b73.c43d45","name":"","sourcePath":"removeNucleotides/out/","sourcePathType":"str","sourceFilename":"payload.fasta","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fasta","destFilenameType":"msg","link":false,"x":1320,"y":780,"wires":[[]]},{"id":"784e4eb4.3b876","type":"fs-ops-dir","z":"1a1d4b73.c43d45","name":"get list of files","path":"sourcePath","pathType":"msg","filter":"*","filterType":"str","dir":"payload","dirType":"msg","x":720,"y":220,"wires":[["9ee8cc7e.104ee"]]},{"id":"d8714938.82f018","type":"change","z":"1a1d4b73.c43d45","name":"","rules":[{"t":"set","p":"sourcePath","pt":"msg","to":"removeNucleotides/out","tot":"str"},{"t":"set","p":"destinationPath","pt":"msg","to":"standardFiles","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":520,"y":220,"wires":[["784e4eb4.3b876"]]},{"id":"9ee8cc7e.104ee","type":"split","z":"1a1d4b73.c43d45","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":890,"y":220,"wires":[["e3745ecc.52321"]]},{"id":"f1d9df6e.8f18a","type":"ui_button","z":"1a1d4b73.c43d45","name":"","group":"1f86516c.1caddf","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":220,"y":180,"wires":[["d8714938.82f018","ada60eb8.625e1"]]},{"id":"74b71037.97b1f","type":"ui_button","z":"1a1d4b73.c43d45","name":"","group":"571692af.cbdf1c","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":220,"y":240,"wires":[["d8714938.82f018","ada60eb8.625e1"]]},{"id":"e3745ecc.52321","type":"fs-ops-move","z":"1a1d4b73.c43d45","name":"","sourcePath":"sourcePath","sourcePathType":"msg","sourceFilename":"payload","sourceFilenameType":"msg","destPath":"destinationPath","destPathType":"msg","destFilename":"payload","destFilenameType":"msg","link":false,"x":960,"y":320,"wires":[[]]},{"id":"a14a722e.2e3bc","type":"delay","z":"1a1d4b73.c43d45","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":420,"y":680,"wires":[["821552af.df742","1897c378.894fcd"]]},{"id":"205d1712.ab7248","type":"exec","z":"1a1d4b73.c43d45","command":"rm -rf \"removeNucleotides\"","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"rmDir","x":390,"y":800,"wires":[[],[],["4ffc0a55.77e174"]]},{"id":"288d6a5.f850896","type":"tab","label":"Augustus-Introns-extraction","disabled":false,"info":""},{"id":"694844a9.6a601c","type":"http in","z":"288d6a5.f850896","name":"","url":"/extractfromaugustus","method":"post","upload":true,"swaggerDoc":"","x":130,"y":880,"wires":[["c907a53d.eb2468","ef36e500.615278","f8bea05b.60532"]]},{"id":"c9d86956.415338","type":"function","z":"288d6a5.f850896","name":"","func":"if(msg.req.files.length == 2) {\n    var msg1 = { payload: msg.req.files[1].buffer, filename: \"extractFromAugustus/out/\" + msg.req.files[1].originalname};\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"extractFromAugustus/out/\" + msg.req.files[0].originalname\n\n    return [msg,msg1];\n}\nelse if(msg.req.files.length == 1) {\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"extractFromAugustus/out/\" + msg.req.files[0].originalname\n\n    return [msg,msg1];\n} ","outputs":2,"noerr":0,"initialize":"","finalize":"","x":500,"y":920,"wires":[["3f6338c7.3ffca8"],["301dbfc0.96849"]]},{"id":"3f6338c7.3ffca8","type":"file","z":"288d6a5.f850896","name":"fasta","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":630,"y":860,"wires":[["b620125b.ff5cc"]]},{"id":"cb4b6cc3.8e56b","type":"function","z":"288d6a5.f850896","name":"","func":"//global.set(\"name\",msg.payload.outputname);\nif(msg.req.files.length == 2) {\n    msg.payload.fasta = \"extractFromAugustus/out/\" + msg.req.files[0].originalname\n    msg.payload.au = \"extractFromAugustus/out/\" + msg.req.files[1].originalname\n    msg.payload.pathfolder = \"extractFromAugustus/out\"\n    msg.payload.flanking = msg.payload.flanking\n    msg.payload.outputname = msg.payload.outputname\n    return msg;\n}\nelse if (msg.req.files.length ==1) {\n    if(msg.req.files[0].fieldname == \"filefasta\") {\n        msg.payload.fasta = \"extractFromAugustus/out/\" + msg.req.files[0].originalname\n        msg.payload.au = \"standardFiles/\" + msg.payload.fileaug\n        msg.payload.pathfolder = \"extractFromAugustus/out\"\n        msg.payload.flanking = msg.payload.flanking\n        msg.payload.outputname = msg.payload.outputname\n        return msg;\n    }\n    if(msg.req.files[0].fieldname == \"fileaug\") {\n        msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n        msg.payload.au = \"extractFromAugustus/out/\" + msg.req.files[0].originalname\n        msg.payload.pathfolder = \"extractFromAugustus/out\"\n        msg.payload.flanking = msg.payload.flanking\n        msg.payload.outputname = msg.payload.outputname\n        return msg;\n    }\n}\nelse {\n    msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n    msg.payload.au = \"standardFiles/\" + msg.payload.fileaug\n    msg.payload.pathfolder = \"extractFromAugustus/out\"\n    msg.payload.flanking = msg.payload.flanking\n    msg.payload.outputname = msg.payload.outputname\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":760,"y":800,"wires":[["d81bcd57.f6b38"]]},{"id":"24b5f5a2.17010a","type":"ui_template","z":"288d6a5.f850896","group":"6d2be4c0.312fcc","name":"Data-table","order":1,"width":24,"height":18,"format":"<html>  \n  <head>\n      <style>\n.center {\n  position: absolute;\n  top: 8%;\n  left: 50%;\n  margin: -25px 0 0 -25px;\n}\n .auto-style1 {\n margin-left: 0px;\n }\n </style>\n  </head>\n  <body>\n  <center>\n \n      <br><br><br><br>\n    <form action=\"/extractfromaugustus\" method=\"post\" enctype=\"multipart/form-data\">\n    <div style=\"width:700px; height:45px; border:5px outset navy;\"> <font face=\"Verdana\" size=\"6\">Augustus Introns extraction</font><br /></div>\n    <p>The user can extract introns using provided Augustus coordinates. A variable length flanking regions dataset can be created.</p>\n    <p>_________________________________________________________________________________________________________________</p> <br>\n      <label style=\"font-size:20px\"  for=\"fasta\">Fasta File:&emsp;</label>\n      <input id=\"filefasta\" type=\"file\" name=\"filefasta\" class=\"auto-style1\" style=\"width: 273px; height: 34px\" accept=\".fasta\">\n      <p><label for=\"filefastaDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label>\n        <select id=\"filefastaDEF\" name=\"filefastaDEF\">\n        <option value=\"\">Nessun File</option>\n        <option ng-repeat=\"obj in msg.payload.fasta\" value=\"{{obj}}\">{{ obj }}</option>\n        </select></p> <br>\n      <label style=\"font-size:20px\"  for=\"fileaug\">AUGUSTUS File:&emsp;</label>\n      <input id=\"fileaug\" type=\"file\" name=\"fileaug\" class=\"auto-style1\" style=\"width: 273px; height: 34px\" accept=\".gtf\">\n      <p><label for=\"fileaugDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label>\n        <select id=\"fileaugDEF\" name=\"fileaugDEF\">\n        <option value=\"\">Nessun File</option>\n        <option ng-repeat=\"obj in msg.payload.gtf\" value=\"{{obj}}\">{{ obj }}</option>\n        </select></p> <br>\n      <label style=\"font-size:20px\" for=\"outputname\">Output name:&emsp;</label>\n      <input type=\"text\" id=\"outputname\" name=\"outputname\" style=\"width: 200px; height: 20px\" required/>\n      <br><br><br>\n      <label style=\"font-size:20px\" for=\"flanking\">Bb extension to flanking regions 3'/5':&emsp;</label>\n      <input type=\"text\" id=\"flanking\" name=\"flanking\" style=\"width: 200px; height: 20px\"/>\n      <br><br>\n      <label for=\"zip\">Create a .zip output ( if \"NO\" all files can be downloaded individually):</label>\n      <select id=\"zip\" name=\"zip\">\n          <option value=\"yes\">YES</option>\n          <option value=\"no\">NO</option>\n          </select>\n    <p>_________________________________________________________________________________________________________________</p>\n      <br>\n      <button type=\"button\" id=\"sendBtn\" style=\"width: 250px; height: 43px\" onclick=\"uploadFile()\">Invia</button>\n    <br><br>\n    <div style=\"text-align:center;margin-top:40px;\">\n      <progress id=\"progressBar\" value=\"0\" max=\"100\" style=\"width:300px;\"></progress>\n        <p id=\"status\"></p>\n    </div>\n    </form>\n    </center>\n    <script>\n    function uploadFile(){\n    \n    var fileFasta;\n    \n    if(document.getElementById(\"filefastaDEF\").value != \"\")\n    {\n        fileFasta = document.getElementById(\"filefastaDEF\").value;\n    }\n    else {\n        fileFasta = document.getElementById(\"filefasta\").files[0];\n    }\n    \n    var fileAug;\n    \n    if(document.getElementById(\"fileaugDEF\").value != \"\")\n    {\n        fileAug = document.getElementById(\"fileaugDEF\").value;\n    }\n    else {\n        fileAug = document.getElementById(\"fileaug\").files[0];\n    }\n    \n    \n    const prov = new Date;\n    var outputname = document.getElementById('outputname').value +\"_\"+prov.getDate()+\"-\"+(prov.getMonth()+1)+\"-\"+prov.getFullYear()+\"_\"+prov.getHours()+':'+prov.getMinutes()+':'+prov.getSeconds()+\".fasta\";\n    var flanking = document.getElementById('flanking').value\n    var zip = document.getElementById('zip').value\n\n    var formdata = new FormData();\n    formdata.append(\"filefasta\", fileFasta);\n    formdata.append(\"fileaug\", fileAug);\n    formdata.append(\"outputname\", outputname);\n    formdata.append(\"flanking\", flanking);\n    formdata.append(\"zip\", zip);\n    var ajax = new XMLHttpRequest();\n    ajax.upload.addEventListener(\"progress\", progressHandler, false);\n    ajax.addEventListener(\"load\", completeHandler, false);\n    ajax.addEventListener(\"error\", errorHandler, false);\n    ajax.addEventListener(\"abort\", abortHandler, false);\n    ajax.open(\"POST\", \"/extractfromaugustus\");\n    ajax.send(formdata);\n}\n\nfunction progressHandler(event){\n    var percent = (event.loaded / event.total) * 100;\n    document.getElementById(\"progressBar\").value = Math.round(percent);\n    document.getElementById(\"status\").innerHTML = Math.round(percent)+\"% uploaded... please wait\";\n}\nfunction completeHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Done\";\n    document.getElementById(\"progressBar\").value = 0;\n}\nfunction errorHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Failed\";\n}\nfunction abortHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Aborted\";\n}\n        </script>\n      </body>\n</html>","storeOutMessages":false,"fwdInMessages":false,"resendOnRefresh":false,"templateScope":"local","x":290,"y":720,"wires":[[]]},{"id":"301dbfc0.96849","type":"file","z":"288d6a5.f850896","name":"CUFF","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":630,"y":980,"wires":[["35b17cb7.df7794"]]},{"id":"d81bcd57.f6b38","type":"join","z":"288d6a5.f850896","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"8","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":930,"y":840,"wires":[["2d8f3b6d.734c04"]]},{"id":"b620125b.ff5cc","type":"function","z":"288d6a5.f850896","name":"","func":"msg.payload = {f1: \"yes\"};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":760,"y":860,"wires":[["d81bcd57.f6b38"]]},{"id":"35b17cb7.df7794","type":"function","z":"288d6a5.f850896","name":"","func":"msg.payload = {f2: \"yes\"};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":760,"y":980,"wires":[["d81bcd57.f6b38"]]},{"id":"866be00c.6f326","type":"function","z":"288d6a5.f850896","name":"","func":"var name = msg.payload.outputname\n\nif(msg.payload.stdout!==\"Error\") {\nif(msg.payload.zip===\"no\") {\n    if(msg.payload.stdout!==\"Error\" && msg.payload.flanking===\"\") {\n        msg.payload = {\n            fasta : name,\n            fastaPlus : name + \"Plus\"\n        }\n        return [msg,null,null,null];\n    }\n    else if(msg.payload.stdout!==\"Error\" && msg.payload.flanking!==\"\"){\n        msg.filename = name+\"Plus\"\n        msg.payload = {\n            fasta : name,\n            fastaPlus : name+\"Plus\",\n            flDx : \"flanking_Dx_\" + name,\n            flDxPlus : \"flanking_Dx_\" + name + \"Plus\",\n            flSx : \"flanking_Sx_\" + name,\n            flSxPlus : \"flanking_Sx_\" + name + \"Plus\",\n            flTot: \"flanking_tot_\" + name,\n            flTotPlus : \"flanking_tot_\" + name + \"Plus\"\n        }\n        return [null,msg,null,null];\n    }\n}\nelse if(msg.payload.zip===\"yes\") {\n    msg.payload.outputname = msg.payload.outputname.slice(0,-6) + \".zip\";\n    msg.payload.pathIn = \"extractFromAugustus/out\"\n    msg.payload.pathOut = \"extractFromAugustus/\"+msg.payload.outputname\n    return [null,null,msg,null]\n}\n}\nelse {\n    return [null,null,null,msg]\n}","outputs":4,"noerr":0,"initialize":"","finalize":"","x":1400,"y":840,"wires":[["c7f758c9.f63308"],["cc54eb57.196cb8"],["c176c195.e9791"],["f9d83be9.fa56d8"]]},{"id":"2d8f3b6d.734c04","type":"extract_intron_from_gtf_augustus","z":"288d6a5.f850896","name":"","fasta":"","au":"","pathfolder":"","outputname":"","flanking":"","x":1160,"y":840,"wires":[["866be00c.6f326","44049cd9.8857e4"]]},{"id":"e9a128bb.ddf2d8","type":"fs-ops-dir","z":"288d6a5.f850896","name":"","path":"standardFiles","pathType":"str","filter":"*.fasta","filterType":"str","dir":"payload.fasta","dirType":"msg","x":360,"y":500,"wires":[["da5df9c8.621a88"]]},{"id":"b022f839.396bb8","type":"fs-ops-dir","z":"288d6a5.f850896","name":"","path":"standardFiles","pathType":"str","filter":"*.gtf","filterType":"str","dir":"payload.gtf","dirType":"msg","x":360,"y":460,"wires":[["da5df9c8.621a88"]]},{"id":"9934f581.d4ded8","type":"change","z":"288d6a5.f850896","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"Go\":\"refresh\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":200,"y":480,"wires":[["b022f839.396bb8","e9a128bb.ddf2d8"]]},{"id":"396c0c21.babe54","type":"ui_ui_control","z":"288d6a5.f850896","name":"Refresh page restore","events":"all","x":260,"y":380,"wires":[["bce01439.b49b58","9934f581.d4ded8"]]},{"id":"bce01439.b49b58","type":"function","z":"288d6a5.f850896","name":"","func":"msg.payload = { group: {\n    show : [\"AugustusIntronsExtraction_Form\"],\n    hide : [\"AugustusIntronsExtraction_Text\", \"AugustusIntronsExtraction_Out\", \"AugustusIntronsExtraction_Error\",\"AugustusIntronsExtraction_Zip\",\"AugustusIntronsExtraction_Flanking\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":240,"y":300,"wires":[["eb3d8cdd.786ec"]]},{"id":"eb3d8cdd.786ec","type":"ui_ui_control","z":"288d6a5.f850896","name":"","events":"all","x":640,"y":300,"wires":[[]]},{"id":"c907a53d.eb2468","type":"function","z":"288d6a5.f850896","name":"","func":"msg.payload = { group: {\n    show : [\"AugustusIntronsExtraction_Text\"],\n    hide : [\"AugustusIntronsExtraction_Form\"]\n}, text: \"Process in execution... Please wait.\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":760,"y":700,"wires":[["f7447fab.054a4","eb3d8cdd.786ec"]]},{"id":"f7447fab.054a4","type":"ui_text","z":"288d6a5.f850896","group":"33aeab03.cc5714","order":1,"width":24,"height":4,"name":"","label":"","format":"{{msg.payload.text}}","layout":"col-center","x":990,"y":700,"wires":[]},{"id":"da5df9c8.621a88","type":"join","z":"288d6a5.f850896","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":530,"y":560,"wires":[["24b5f5a2.17010a"]]},{"id":"55fd8d.96ced274","type":"fs-ops-mkdir","z":"288d6a5.f850896","name":"","path":"","pathType":"str","dirname":"extractFromAugustus","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":460,"y":1040,"wires":[["df3510b7.9c7ba"]]},{"id":"df3510b7.9c7ba","type":"fs-ops-mkdir","z":"288d6a5.f850896","name":"","path":"extractFromAugustus/","pathType":"str","dirname":"out","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":660,"y":1040,"wires":[[]]},{"id":"c7f758c9.f63308","type":"delay","z":"288d6a5.f850896","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1640,"y":740,"wires":[["56d234d5.1fde7c","1603045e.45c18c"]]},{"id":"cc54eb57.196cb8","type":"delay","z":"288d6a5.f850896","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1640,"y":800,"wires":[["90934043.ffa3f","e789379e.661c18"]]},{"id":"c176c195.e9791","type":"zip_folder","z":"288d6a5.f850896","name":"","pathIn":"","pathOut":"","x":1640,"y":860,"wires":[["fdba1db.06e21e","7e7dc5a7.f002ac"]]},{"id":"f9d83be9.fa56d8","type":"delay","z":"288d6a5.f850896","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1640,"y":920,"wires":[["4294b744.df70d8","ef5e6428.bd0618"]]},{"id":"1603045e.45c18c","type":"ui_template","z":"288d6a5.f850896","group":"bd167470.1eb8d8","name":"output","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>   \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/extractFromAugustus/out/{{msg.payload.fasta}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.fasta}}</a> <br><br>\n    <a href=\"/file/extractFromAugustus/out/{{msg.payload.fastaPlus}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.fastaPlus}}</a>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1930,"y":580,"wires":[[]]},{"id":"f4d38a36.1cb148","type":"ui_ui_control","z":"288d6a5.f850896","name":"","events":"all","x":2180,"y":820,"wires":[[]]},{"id":"fdba1db.06e21e","type":"function","z":"288d6a5.f850896","name":"","func":"msg.payload = { group: {\n    show : [\"AugustusIntronsExtraction_Zip\"],\n    hide : [\"AugustusIntronsExtraction_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1940,"y":860,"wires":[["f4d38a36.1cb148"]]},{"id":"ef5e6428.bd0618","type":"ui_template","z":"288d6a5.f850896","group":"b9557d96.4ea13","name":"error","order":1,"width":0,"height":0,"format":"<html>\n  <body>\n      <center>\n<h1>ERROR during execution!</h1>\n<h3>There was an error in the process. Please, repeat the procedure and check if the inputs files are correct</h3>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1910,"y":1000,"wires":[[]]},{"id":"4294b744.df70d8","type":"function","z":"288d6a5.f850896","name":"","func":"msg.payload = { group: {\n    show : [\"AugustusIntronsExtraction_Error\"],\n    hide : [\"AugustusIntronsExtraction_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1940,"y":920,"wires":[["f4d38a36.1cb148"]]},{"id":"7e7dc5a7.f002ac","type":"ui_template","z":"288d6a5.f850896","group":"2356e44f.08888c","name":"zip","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>  \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/{{msg.payload.pathOut}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.outputname}}</a>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1930,"y":660,"wires":[[]]},{"id":"56d234d5.1fde7c","type":"function","z":"288d6a5.f850896","name":"","func":"msg.payload = { group: {\n    show : [\"AugustusIntronsExtraction_Out\"],\n    hide : [\"AugustusIntronsExtraction_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1940,"y":740,"wires":[["f4d38a36.1cb148"]]},{"id":"e789379e.661c18","type":"ui_template","z":"288d6a5.f850896","group":"7f7949c2.f3b448","name":"flanking","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>   \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/extractFromAugustus/out/{{msg.payload.fasta}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.fasta}}</a> <br><br>\n    <a href=\"/file/extractFromAugustus/out/{{msg.payload.fastaPlus}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.fastaPlus}}</a> <br><br>\n    <a href=\"/file/extractFromAugustus/out/{{msg.payload.flDx}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flDx}}</a> <br><br>\n    <a href=\"/file/extractFromAugustus/out/{{msg.payload.flDxPlus}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flDxPlus}}</a> <br><br>\n    <a href=\"/file/extractFromAugustus/out/{{msg.payload.flSx}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flSx}}</a> <br><br>\n    <a href=\"/file/extractFromAugustus/out/{{msg.payload.flSxPlus}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flSxPlus}}</a> <br><br>\n    <a href=\"/file/extractFromAugustus/out/{{msg.payload.flTot}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flTot}}</a> <br><br>\n    <a href=\"/file/extractFromAugustus/out/{{msg.payload.flTotPlus}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.flTotPlus}}</a> <br><br>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1940,"y":620,"wires":[[]]},{"id":"90934043.ffa3f","type":"function","z":"288d6a5.f850896","name":"","func":"msg.payload = { group: {\n    show : [\"AugustusIntronsExtraction_Flanking\"],\n    hide : [\"AugustusIntronsExtraction_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1940,"y":800,"wires":[["f4d38a36.1cb148"]]},{"id":"44049cd9.8857e4","type":"function","z":"288d6a5.f850896","name":"","func":"if(msg.payload.fasta.startsWith(\"standardFiles\")) {\n    msg.payload.fasta = null\n} else {\n    msg.payload.fasta = msg.payload.fasta.split(\"/\")[2]\n}\nif(msg.payload.au.startsWith(\"standardFiles\")) {\n    msg.payload.au = null\n} else {\n    msg.payload.au = msg.payload.au.split(\"/\")[2]\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1320,"y":960,"wires":[["7180e02f.a628","8eb4a7b.d56d558"]]},{"id":"7180e02f.a628","type":"fs-ops-move","z":"288d6a5.f850896","name":"","sourcePath":"extractFromAugustus/out/","sourcePathType":"str","sourceFilename":"payload.fasta","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fasta","destFilenameType":"msg","link":false,"x":1520,"y":1020,"wires":[[]]},{"id":"8eb4a7b.d56d558","type":"fs-ops-move","z":"288d6a5.f850896","name":"","sourcePath":"extractFromAugustus/out/","sourcePathType":"str","sourceFilename":"payload.au","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.au","destFilenameType":"msg","link":false,"x":1500,"y":1060,"wires":[[]]},{"id":"c527e69c.a022e8","type":"fs-ops-dir","z":"288d6a5.f850896","name":"get list of files","path":"sourcePath","pathType":"msg","filter":"*","filterType":"str","dir":"payload","dirType":"msg","x":740,"y":180,"wires":[["23976089.dae0d"]]},{"id":"1deb223d.a33e6e","type":"fs-ops-move","z":"288d6a5.f850896","name":"","sourcePath":"sourcePath","sourcePathType":"msg","sourceFilename":"payload","sourceFilenameType":"msg","destPath":"destinationPath","destPathType":"msg","destFilename":"payload","destFilenameType":"msg","link":false,"x":860,"y":260,"wires":[[]]},{"id":"7a034d46.25c7b4","type":"change","z":"288d6a5.f850896","name":"","rules":[{"t":"set","p":"sourcePath","pt":"msg","to":"extractFromAugustus/out","tot":"str"},{"t":"set","p":"destinationPath","pt":"msg","to":"standardFiles","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":180,"wires":[["c527e69c.a022e8"]]},{"id":"23976089.dae0d","type":"split","z":"288d6a5.f850896","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":710,"y":260,"wires":[["1deb223d.a33e6e"]]},{"id":"e9c9b760.d1a318","type":"ui_button","z":"288d6a5.f850896","name":"","group":"bd167470.1eb8d8","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":240,"y":140,"wires":[["7a034d46.25c7b4","bce01439.b49b58"]]},{"id":"553a313f.73cd5","type":"ui_button","z":"288d6a5.f850896","name":"","group":"2356e44f.08888c","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":240,"y":200,"wires":[["7a034d46.25c7b4","bce01439.b49b58"]]},{"id":"3a24a70e.74d9c8","type":"ui_button","z":"288d6a5.f850896","name":"","group":"7f7949c2.f3b448","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":240,"y":80,"wires":[["7a034d46.25c7b4","bce01439.b49b58"]]},{"id":"ef36e500.615278","type":"delay","z":"288d6a5.f850896","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":340,"y":900,"wires":[["cb4b6cc3.8e56b","c9d86956.415338"]]},{"id":"f8bea05b.60532","type":"exec","z":"288d6a5.f850896","command":"rm -rf \"extractFromAugustus\"","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"rmDir","x":310,"y":1020,"wires":[[],[],["55fd8d.96ced274"]]},{"id":"cbd5ada6.b4a2c","type":"tab","label":"Stringtie-Introns-extraction","disabled":false,"info":""},{"id":"fa394c77.5eb9f","type":"http in","z":"cbd5ada6.b4a2c","name":"","url":"/extractfromstringtie","method":"post","upload":true,"swaggerDoc":"","x":150,"y":680,"wires":[["74047eca.47517","eb1af763.e6b678","f6898688.5763d8"]]},{"id":"a1699eee.1d9a8","type":"function","z":"cbd5ada6.b4a2c","name":"","func":"if(msg.req.files.length == 2) {\n    var msg1 = { payload: msg.req.files[1].buffer, filename: \"extractFromFileTie/out/\" + msg.req.files[1].originalname};\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"extractFromFileTie/out/\" + msg.req.files[0].originalname\n\n    return [msg,msg1];\n}\nelse if (msg.req.files.length == 2) {\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"extractFromFileTie/out/\" + msg.req.files[0].originalname\n\n    return [msg];\n}","outputs":2,"noerr":0,"initialize":"","finalize":"","x":600,"y":680,"wires":[["9b22b103.bb83d"],["1cc841fe.26446e"]]},{"id":"9b22b103.bb83d","type":"file","z":"cbd5ada6.b4a2c","name":"fasta","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":730,"y":620,"wires":[["73ce2dcf.a8ade4"]]},{"id":"fc7fa5e.fa8db58","type":"function","z":"cbd5ada6.b4a2c","name":"","func":"if(msg.req.files.length == 2) {\n    msg.payload.fasta = \"extractFromFileTie/out/\" + msg.req.files[0].originalname\n    msg.payload.st = \"extractFromFileTie/out/\" + msg.req.files[1].originalname\n    msg.payload.pathfolder = \"extractFromFileTie/out\"\n    msg.payload.outputname = msg.payload.outputname\n    return msg;\n}\nelse if (msg.req.files.length == 1) {\n    if(msg.req.files[0].fieldname == \"filefasta\") {\n        msg.payload.fasta = \"extractFromFileTie/out/\" + msg.req.files[0].originalname\n        msg.payload.st = \"standardFiles/\" + msg.payload.filest\n        msg.payload.pathfolder = \"extractFromFileTie/out\"\n        msg.payload.outputname = msg.payload.outputname\n        return msg;\n    }\n    if(msg.req.files[0].fieldname == \"fileaug\") {\n        msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n        msg.payload.st = \"extractFromFileTie/out/\" + msg.req.files[0].originalname\n        msg.payload.pathfolder = \"extractFromFileTie/out\"\n        msg.payload.outputname = msg.payload.outputname\n        return msg;\n    }\n}\nelse {\n    msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n    msg.payload.st = \"standardFiles/\" + msg.payload.filest\n    msg.payload.pathfolder = \"extractFromFileTie/out\"\n    msg.payload.outputname = msg.payload.outputname\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":680,"y":540,"wires":[["1cc18111.f3e2af"]]},{"id":"edae4cf2.a8ed6","type":"ui_template","z":"cbd5ada6.b4a2c","group":"86746bf5.623248","name":"Data-table","order":1,"width":24,"height":14,"format":"<html>  \n  <head>\n      <style>\n.center {\n  position: absolute;\n  top: 8%;\n  left: 50%;\n  margin: -25px 0 0 -25px;\n}\n .auto-style1 {\n margin-left: 0px;\n }\n </style>\n  </head>\n  <body>\n  <center>\n \n      <br><br><br><br>\n    <form action=\"/extractfromstringtie\" method=\"post\" enctype=\"multipart/form-data\">\n    <div style=\"width:700px; height:45px; border:5px outset navy;\"> <font face=\"Verdana\" size=\"6\">Stringtie Introns extraction</font><br /></div>\n    <p>The user can extract introns using provided Stringtie coordinates.</p>\n    <p>_________________________________________________________________________________________________________________</p> <br>\n      <label style=\"font-size:20px\"  for=\"fasta\">Fasta File:&emsp;</label>\n      <input id=\"filefasta\" type=\"file\" name=\"filefasta\" class=\"auto-style1\" style=\"width: 273px; height: 34px\" accept=\".fasta\">\n      <p><label for=\"filefastaDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label>\n        <select id=\"filefastaDEF\" name=\"filefastaDEF\">\n        <option value=\"\">Nessun File</option>\n        <option ng-repeat=\"obj in msg.payload.fasta\" value=\"{{obj}}\">{{ obj }}</option>\n        </select></p> <br>\n      <label style=\"font-size:20px\"  for=\"filest\">Stringtie coordinates (.gtf):&emsp;</label>\n      <input id=\"filest\" type=\"file\" name=\"filest\" class=\"auto-style1\" style=\"width: 273px; height: 34px\" accept=\".gtf\">\n      <p><label for=\"filestDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label>\n        <select id=\"filestDEF\" name=\"filestDEF\">\n        <option value=\"\">Nessun File</option>\n        <option ng-repeat=\"obj in msg.payload.gtf\" value=\"{{obj}}\">{{ obj }}</option>\n        </select></p> <br>\n      <label style=\"font-size:20px\" for=\"outputname\">Output name:&emsp;</label>\n      <input type=\"text\" id=\"outputname\" name=\"outputname\" style=\"width: 200px; height: 20px\" required/>\n      <br><br>\n      <label style=\"font-size:20px\" for=\"start\">Start:</label>\n      <input type=\"text\" id=\"start\" name=\"start\" style=\"width: 20px; height: 20px\"/>\n      \n      <label style=\"font-size:20px\" for=\"end\">&emsp;End:</label>\n      <input type=\"text\" id=\"end\" name=\"end\" style=\"width: 20px; height: 20px\"/>\n      \n      <label style=\"font-size:20px\" for=\"contig\">&emsp;Contig:</label>\n      <input type=\"text\" id=\"contig\" name=\"contig\" style=\"width: 20px; height: 20px\"/>\n      <br><br>\n      <label style=\"font-size:20px\" for=\"strand\">Strand:</label>\n      <input type=\"text\" id=\"strand\" name=\"strand\" style=\"width: 20px; height: 20px\"/>\n   \n      <label style=\"font-size:20px\" for=\"coverage\">&emsp;Coverage:</label>\n      <input type=\"text\" id=\"coverage\" name=\"coverage\" style=\"width: 20px; height: 20px\"/>\n     \n      <label style=\"font-size:20px\" for=\"label\">&emsp;Label:</label>\n      <input type=\"text\" id=\"label\" name=\"label\" style=\"width: 20px; height: 20px\"/>\n      <br><br>\n      <label for=\"zip\">Create a .zip output ( if \"NO\" all files can be downloaded individually):</label>\n      <select id=\"zip\" name=\"zip\">\n          <option value=\"yes\">YES</option>\n          <option value=\"no\">NO</option>\n          </select>\n    <p>_________________________________________________________________________________________________________________</p>\n      <br>\n      <button type=\"button\" id=\"sendBtn\" style=\"width: 250px; height: 43px\" onclick=\"uploadFile()\">Invia</button>\n    <br><br>\n    <div style=\"text-align:center;margin-top:40px;\">\n      <progress id=\"progressBar\" value=\"0\" max=\"100\" style=\"width:300px;\"></progress>\n        <p id=\"status\"></p>\n    </div>\n    </form>\n    </center>\n    <script>\n    function uploadFile(){\n    \n    var fileFasta;\n    \n    if(document.getElementById(\"filefastaDEF\").value != \"\")\n    {\n        fileFasta = document.getElementById(\"filefastaDEF\").value;\n    }\n    else {\n        fileFasta = document.getElementById(\"filefasta\").files[0];\n    }\n    \n    var fileSt;\n    \n    if(document.getElementById(\"filestDEF\").value != \"\")\n    {\n        fileSt = document.getElementById(\"filestDEF\").value;\n    }\n    else {\n        fileSt = document.getElementById(\"filest\").files[0];\n    }\n    \n    \n    const prov = new Date;\n    var outputname = document.getElementById('outputname').value +\"_\"+prov.getDate()+\"-\"+(prov.getMonth()+1)+\"-\"+prov.getFullYear()+\"_\"+prov.getHours()+':'+prov.getMinutes()+':'+prov.getSeconds()+\".fasta\";\n    var zip = document.getElementById('zip').value\n    var start = document.getElementById('start').value\n    var end = document.getElementById('end').value\n    var contig = document.getElementById('contig').value\n    var strand = document.getElementById('strand').value\n    var coverage = document.getElementById('coverage').value\n    var label = document.getElementById('label').value\n\n    var formdata = new FormData();\n    formdata.append(\"filefasta\", fileFasta);\n    formdata.append(\"filest\", fileSt);\n    formdata.append(\"outputname\", outputname);\n    formdata.append(\"zip\", zip);\n    formdata.append(\"start\", start);\n    formdata.append(\"end\", end);\n    formdata.append(\"contig\", contig);\n    formdata.append(\"strand\", strand);\n    formdata.append(\"coverage\", coverage);\n    formdata.append(\"label\", label);\n    var ajax = new XMLHttpRequest();\n    ajax.upload.addEventListener(\"progress\", progressHandler, false);\n    ajax.addEventListener(\"load\", completeHandler, false);\n    ajax.addEventListener(\"error\", errorHandler, false);\n    ajax.addEventListener(\"abort\", abortHandler, false);\n    ajax.open(\"POST\", \"/extractfromstringtie\");\n    ajax.send(formdata);\n}\n\nfunction progressHandler(event){\n    var percent = (event.loaded / event.total) * 100;\n    document.getElementById(\"progressBar\").value = Math.round(percent);\n    document.getElementById(\"status\").innerHTML = Math.round(percent)+\"% uploaded... please wait\";\n}\nfunction completeHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Done\";\n    document.getElementById(\"progressBar\").value = 0;\n}\nfunction errorHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Failed\";\n}\nfunction abortHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Aborted\";\n}\n        </script>\n      </body>\n</html>","storeOutMessages":false,"fwdInMessages":false,"resendOnRefresh":false,"templateScope":"local","x":210,"y":520,"wires":[[]]},{"id":"1cc841fe.26446e","type":"file","z":"cbd5ada6.b4a2c","name":"CUFF","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":730,"y":740,"wires":[["beeea3a4.03832"]]},{"id":"1cc18111.f3e2af","type":"join","z":"cbd5ada6.b4a2c","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"13","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1050,"y":600,"wires":[["126541b1.d0da3e"]]},{"id":"73ce2dcf.a8ade4","type":"function","z":"cbd5ada6.b4a2c","name":"","func":"msg.payload = {f1: \"yes\"};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":880,"y":620,"wires":[["1cc18111.f3e2af"]]},{"id":"beeea3a4.03832","type":"function","z":"cbd5ada6.b4a2c","name":"","func":"msg.payload = {f2: \"yes\"};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":880,"y":740,"wires":[["1cc18111.f3e2af"]]},{"id":"8aa8ce8f.85a3e","type":"function","z":"cbd5ada6.b4a2c","name":"","func":"var name = msg.payload.outputname\n\nif(msg.payload.stdout!==\"Error\") {\nif(msg.payload.zip===\"no\") {\n    if(msg.payload.stdout!==\"Error\") {\n        msg.payload = {\n            fasta : name,\n            fastaPlus : name + \"Plus\"\n        }\n        return [msg,null,null];\n    }\n}\n    else if(msg.payload.zip===\"yes\") {\n        msg.payload.outputname = msg.payload.outputname.slice(0,-6) + \".zip\";\n        msg.payload.pathIn = \"extractFromFileTie/out\"\n        msg.payload.pathOut = \"extractFromFileTie/\"+msg.payload.outputname\n        return [null,msg,null]\n    }\n}\nelse {\n    return [null,null,msg]\n}","outputs":3,"noerr":0,"initialize":"","finalize":"","x":1520,"y":600,"wires":[["d37fa807.767198"],["4ab2bf4c.f7c24"],["4110e1b2.7a633"]]},{"id":"126541b1.d0da3e","type":"extract_intron_from_string_tie","z":"cbd5ada6.b4a2c","name":"","fasta":"","au":"","pathfolder":"","outputname":"","start":"","end":"","contig":"","strand":"","coverage":"","label":"","x":1270,"y":600,"wires":[["8aa8ce8f.85a3e","b9614981.7584d8"]]},{"id":"37e2a7ed.90d998","type":"fs-ops-dir","z":"cbd5ada6.b4a2c","name":"","path":"standardFiles","pathType":"str","filter":"*.fasta","filterType":"str","dir":"payload.fasta","dirType":"msg","x":380,"y":360,"wires":[["d8f6441c.f24308"]]},{"id":"8c01095c.f1fdd8","type":"fs-ops-dir","z":"cbd5ada6.b4a2c","name":"","path":"standardFiles","pathType":"str","filter":"*.gtf","filterType":"str","dir":"payload.gtf","dirType":"msg","x":380,"y":320,"wires":[["d8f6441c.f24308"]]},{"id":"7f5ceb89.fed4e4","type":"change","z":"cbd5ada6.b4a2c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"Go\":\"refresh\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":220,"y":340,"wires":[["8c01095c.f1fdd8","37e2a7ed.90d998"]]},{"id":"b7c47889.7c0358","type":"ui_ui_control","z":"cbd5ada6.b4a2c","name":"Refresh page restore","events":"all","x":280,"y":240,"wires":[["4b0f5b07.e44964","7f5ceb89.fed4e4"]]},{"id":"4b0f5b07.e44964","type":"function","z":"cbd5ada6.b4a2c","name":"","func":"msg.payload = { group: {\n    show : [\"StringtieIntronsExtraction_Form\"],\n    hide : [\"StringtieIntronsExtraction_Text\", \"StringtieIntronsExtraction_Out\", \"StringtieIntronsExtraction_Error\",\"StringtieIntronsExtraction_Zip\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":260,"y":160,"wires":[["5bd6874e.dfded8"]]},{"id":"5bd6874e.dfded8","type":"ui_ui_control","z":"cbd5ada6.b4a2c","name":"","events":"all","x":660,"y":160,"wires":[[]]},{"id":"74047eca.47517","type":"function","z":"cbd5ada6.b4a2c","name":"","func":"msg.payload = { group: {\n    show : [\"StringtieIntronsExtraction_Text\"],\n    hide : [\"StringtieIntronsExtraction_Form\"]\n}, text: \"Process in execution... Please wait.\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":720,"y":480,"wires":[["a297cd1a.e7af","5bd6874e.dfded8"]]},{"id":"a297cd1a.e7af","type":"ui_text","z":"cbd5ada6.b4a2c","group":"56423b78.7b9c94","order":1,"width":24,"height":4,"name":"","label":"","format":"{{msg.payload.text}}","layout":"col-center","x":890,"y":480,"wires":[]},{"id":"d8f6441c.f24308","type":"join","z":"cbd5ada6.b4a2c","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":550,"y":420,"wires":[["edae4cf2.a8ed6"]]},{"id":"6334966a.473ce8","type":"fs-ops-mkdir","z":"cbd5ada6.b4a2c","name":"","path":"","pathType":"str","dirname":"extractFromFileTie","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":560,"y":820,"wires":[["c7f7b9cd.48e508"]]},{"id":"c7f7b9cd.48e508","type":"fs-ops-mkdir","z":"cbd5ada6.b4a2c","name":"","path":"extractFromFileTie/","pathType":"str","dirname":"out","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":760,"y":820,"wires":[[]]},{"id":"d37fa807.767198","type":"delay","z":"cbd5ada6.b4a2c","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1780,"y":540,"wires":[["588248a6.e7a4e8","86d9626d.e2286"]]},{"id":"4ab2bf4c.f7c24","type":"zip_folder","z":"cbd5ada6.b4a2c","name":"","pathIn":"","pathOut":"","x":1780,"y":600,"wires":[["44557f61.9e9fa","1817d188.f6576e"]]},{"id":"4110e1b2.7a633","type":"delay","z":"cbd5ada6.b4a2c","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1780,"y":660,"wires":[["a87a6b30.e36468","746ae339.bf53cc"]]},{"id":"588248a6.e7a4e8","type":"ui_template","z":"cbd5ada6.b4a2c","group":"16767678.55b4ea","name":"output","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>   \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/extractFromFileTie/out/{{msg.payload.fasta}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.fasta}}</a> <br><br>\n    <a href=\"/file/extractFromFileTie/out/{{msg.payload.fastaPlus}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.fastaPlus}}</a>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1970,"y":420,"wires":[[]]},{"id":"aca6376a.bc7f08","type":"ui_ui_control","z":"cbd5ada6.b4a2c","name":"","events":"all","x":2220,"y":600,"wires":[[]]},{"id":"44557f61.9e9fa","type":"function","z":"cbd5ada6.b4a2c","name":"","func":"msg.payload = { group: {\n    show : [\"StringtieIntronsExtraction_Zip\"],\n    hide : [\"StringtieIntronsExtraction_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2000,"y":600,"wires":[["aca6376a.bc7f08"]]},{"id":"746ae339.bf53cc","type":"ui_template","z":"cbd5ada6.b4a2c","group":"7b824e4d.3d82a","name":"error","order":1,"width":0,"height":0,"format":"<html>\n  <body>\n      <center>\n<h1>ERROR during execution!</h1>\n<h3>There was an error in the process. Please, repeat the procedure and check if the inputs files are correct</h3>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1990,"y":740,"wires":[[]]},{"id":"a87a6b30.e36468","type":"function","z":"cbd5ada6.b4a2c","name":"","func":"msg.payload = { group: {\n    show : [\"StringtieIntronsExtraction_Error\"],\n    hide : [\"StringtieIntronsExtraction_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2000,"y":660,"wires":[["aca6376a.bc7f08"]]},{"id":"1817d188.f6576e","type":"ui_template","z":"cbd5ada6.b4a2c","group":"5c6a6d1.5f89794","name":"zip","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>  \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/{{msg.payload.pathOut}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.outputname}}</a>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1990,"y":480,"wires":[[]]},{"id":"86d9626d.e2286","type":"function","z":"cbd5ada6.b4a2c","name":"","func":"msg.payload = { group: {\n    show : [\"StringtieIntronsExtraction_Out\"],\n    hide : [\"StringtieIntronsExtraction_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2000,"y":540,"wires":[["aca6376a.bc7f08"]]},{"id":"b9614981.7584d8","type":"function","z":"cbd5ada6.b4a2c","name":"","func":"if(msg.payload.fasta.startsWith(\"standardFiles\")) {\n    msg.payload.fasta = null\n} else {\n    msg.payload.fasta = msg.payload.fasta.split(\"/\")[2]\n}\nif(msg.payload.st.startsWith(\"standardFiles\")) {\n    msg.payload.st = null\n} else {\n    msg.payload.st = msg.payload.st.split(\"/\")[2]\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1440,"y":720,"wires":[["8f149cf5.9e4c7","a5890528.540d88"]]},{"id":"8f149cf5.9e4c7","type":"fs-ops-move","z":"cbd5ada6.b4a2c","name":"","sourcePath":"extractFromFileTie/out/","sourcePathType":"str","sourceFilename":"payload.fasta","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fasta","destFilenameType":"msg","link":false,"x":1640,"y":780,"wires":[[]]},{"id":"a5890528.540d88","type":"fs-ops-move","z":"cbd5ada6.b4a2c","name":"","sourcePath":"extractFromFileTie/out/","sourcePathType":"str","sourceFilename":"payload.st","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.st","destFilenameType":"msg","link":false,"x":1620,"y":820,"wires":[[]]},{"id":"cd28c513.2b9388","type":"fs-ops-dir","z":"cbd5ada6.b4a2c","name":"get list of files","path":"sourcePath","pathType":"msg","filter":"*","filterType":"str","dir":"payload","dirType":"msg","x":780,"y":80,"wires":[["dcb3278.9e222d8"]]},{"id":"fb361ae0.577fe8","type":"change","z":"cbd5ada6.b4a2c","name":"","rules":[{"t":"set","p":"sourcePath","pt":"msg","to":"extractFromFileTie/out","tot":"str"},{"t":"set","p":"destinationPath","pt":"msg","to":"standardFiles","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":80,"wires":[["cd28c513.2b9388"]]},{"id":"dcb3278.9e222d8","type":"split","z":"cbd5ada6.b4a2c","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":950,"y":80,"wires":[["ac7bb415.6ab588"]]},{"id":"b824e29d.fb3e","type":"ui_button","z":"cbd5ada6.b4a2c","name":"","group":"16767678.55b4ea","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":280,"y":40,"wires":[["fb361ae0.577fe8","4b0f5b07.e44964"]]},{"id":"1ed49d57.575a23","type":"ui_button","z":"cbd5ada6.b4a2c","name":"","group":"5c6a6d1.5f89794","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":280,"y":100,"wires":[["fb361ae0.577fe8","4b0f5b07.e44964"]]},{"id":"ac7bb415.6ab588","type":"fs-ops-move","z":"cbd5ada6.b4a2c","name":"","sourcePath":"sourcePath","sourcePathType":"msg","sourceFilename":"payload","sourceFilenameType":"msg","destPath":"destinationPath","destPathType":"msg","destFilename":"payload","destFilenameType":"msg","link":false,"x":1020,"y":180,"wires":[[]]},{"id":"f6898688.5763d8","type":"exec","z":"cbd5ada6.b4a2c","command":"rm -rf \"extractFromFileTie\"","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"rmDir","x":370,"y":800,"wires":[[],[],["6334966a.473ce8"]]},{"id":"eb1af763.e6b678","type":"delay","z":"cbd5ada6.b4a2c","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":400,"y":680,"wires":[["fc7fa5e.fa8db58","a1699eee.1d9a8"]]},{"id":"58ac1d24.895954","type":"tab","label":"DotBracket_Notation","disabled":false,"info":""},{"id":"a633442d.843b88","type":"http in","z":"58ac1d24.895954","name":"","url":"/createdotfromfasta","method":"post","upload":true,"swaggerDoc":"","x":130,"y":460,"wires":[["36e2ce23.9fa672","23b4a15c.b388ae","841451c4.53905"]]},{"id":"8218786d.1a3768","type":"function","z":"58ac1d24.895954","name":"","func":"//msg.name = msg.req.files[0].originalname;\n//global.set(\"name\",msg.req.files[0].originalname);\nif(msg.req.files.length == 1) {\nmsg.payload = msg.req.files[0].buffer\nmsg.filename = \"createDot/out/\" + msg.req.files[0].originalname\n\nreturn msg\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":560,"y":460,"wires":[["40d66cca.b9af04"]]},{"id":"40d66cca.b9af04","type":"file","z":"58ac1d24.895954","name":"","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":690,"y":460,"wires":[["82e4d685.2c7c08"]]},{"id":"d07e9a0.8630a68","type":"function","z":"58ac1d24.895954","name":"","func":"//global.set(\"name\",msg.payload.outputname);\nif(msg.req.files.length == 1) {\n    msg.payload.fasta = \"createDot/out/\" + msg.req.files[0].originalname\n}\nelse {\n    msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n}\nmsg.payload.pathfolder = \"createDot/out\"\nmsg.payload.outputname = msg.payload.outputname\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":620,"y":340,"wires":[["dd07bb24.d24298"]]},{"id":"cdb4ef00.fce48","type":"function","z":"58ac1d24.895954","name":"","func":"//var name = global.get(\"name\");\nif(msg.payload.stdout!==\"Error\") {\nif(msg.payload.zip===\"no\") {\n    msg.filename = msg.payload.outputname\n    msg.payload = \"createDot/out/\" + msg.payload.outputname\n    return[msg,null,null]\n}\nelse if(msg.payload.zip===\"yes\") {\n    msg.payload.outputname = msg.payload.outputname.slice(0,-4) + \".zip\";\n    msg.payload.pathIn = \"createDot/out\"\n    msg.payload.pathOut = \"createDot/\" +msg.payload.outputname\n    return [null,msg,null]\n}\n}\nelse {\n    return [null,null,msg]\n}\n","outputs":3,"noerr":0,"initialize":"","finalize":"","x":1400,"y":420,"wires":[["ae6d39e3.6e89c8"],["887892d8.40e1b"],["67cab46b.e05fac"]]},{"id":"82e4d685.2c7c08","type":"function","z":"58ac1d24.895954","name":"","func":"msg.payload = null;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":820,"y":460,"wires":[["dd07bb24.d24298"]]},{"id":"dd07bb24.d24298","type":"join","z":"58ac1d24.895954","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":950,"y":420,"wires":[["95e9a0f5.21f97"]]},{"id":"ae6d39e3.6e89c8","type":"delay","z":"58ac1d24.895954","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1600,"y":400,"wires":[["3ccadbb1.db9f64","45c37237.4117fc"]]},{"id":"398a5496.88553c","type":"ui_template","z":"58ac1d24.895954","group":"d5d7f87d.3a2d78","name":"Data-table","order":1,"width":24,"height":14,"format":"<html>  \n  <head>\n      <style>\n.center {\n  position: absolute;\n  top: 8%;\n  left: 50%;\n  margin: -25px 0 0 -25px;\n}\n .auto-style1 {\n margin-left: 0px;\n }\n </style>\n  </head>\n  <body>\n  <center>\n \n      <br><br><br><br>\n    <form action=\"/createdotfromfasta\" method=\"post\" enctype=\"multipart/form-data\">\n    <div style=\"width:700px; height:45px; border:5px outset navy;\"> <font face=\"Verdana\" size=\"6\">DotBracket Notation</font><br /></div>\n    <p>The user can create the optimal secondary structure in-dot-bracket notation-with a minimum free energy. \n\nRef. Lorenz, R. and Bernhart, S.H. and Höner zu Siederdissen, C. and Tafer, H. and Flamm, C. and Stadler, P.F. and Hofacker, I.L. \"ViennaRNA Package 2.0\", Algorithms for Molecular Biology, 6:1 page(s): 26, 2011\n</p>\n    <p>_________________________________________________________________________________________________________________</p> <br>\n      <br>\n      <label style=\"font-size:20px\"  for=\"fasta\">Fasta File:&emsp;</label>\n      <input id=\"filefasta\" type=\"file\" name=\"filefasta\" class=\"auto-style1\" style=\"width: 273px; height: 34px\" accept=\".fasta\">\n      <p><label for=\"filefastaDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label>\n        <select id=\"filefastaDEF\" name=\"filefastaDEF\">\n        <option value=\"\">Nessun File</option>\n        <option ng-repeat=\"obj in msg.payload\" value=\"{{obj}}\">{{ obj }}</option>\n        </select></p> <br>\n      <label style=\"font-size:20px\" for=\"outputname\">Output name:&emsp;</label>\n      <input type=\"text\" name=\"outputname\" id=\"outputname\" style=\"width: 200px; height: 20px\" required/>\n      <br><br>\n      <label for=\"zip\">Create a .zip output ( if \"NO\" all files can be downloaded individually):</label>\n      <select id=\"zip\" name=\"zip\">\n          <option value=\"no\">NO</option>\n          <option value=\"yes\">YES</option>\n          </select>\n    <p>_________________________________________________________________________________________________________________</p>\n    <br>\n    <button type=\"button\" id=\"sendBtn\" style=\"width: 250px; height: 43px\" onclick=\"uploadFile()\">Invia</button>\n    <br><br>\n    <div style=\"text-align:center;margin-top:40px;\">\n      <progress id=\"progressBar\" value=\"0\" max=\"100\" style=\"width:300px;\"></progress>\n        <p id=\"status\"></p>\n    </div>\n     \n    </form>\n    </center>\n    <script>\n    function uploadFile(){\n    \n    var fileFasta;\n    \n    if(document.getElementById(\"filefastaDEF\").value != \"\")\n    {\n        fileFasta = document.getElementById(\"filefastaDEF\").value;\n    }\n    else {\n        fileFasta = document.getElementById(\"filefasta\").files[0];\n    }\n    \n    \n     const prov = new Date;\n    var outputname = document.getElementById('outputname').value +\"_\"+prov.getDate()+\"-\"+(prov.getMonth()+1)+\"-\"+prov.getFullYear()+\"_\"+prov.getHours()+':'+prov.getMinutes()+':'+prov.getSeconds()+\".dot\";\n    var zip = document.getElementById('zip').value\n\n    var formdata = new FormData();\n    formdata.append(\"filefasta\", fileFasta);\n    formdata.append(\"outputname\", outputname);\n    formdata.append(\"zip\", zip);\n    var ajax = new XMLHttpRequest();\n    ajax.upload.addEventListener(\"progress\", progressHandler, false);\n    ajax.addEventListener(\"load\", completeHandler, false);\n    ajax.addEventListener(\"error\", errorHandler, false);\n    ajax.addEventListener(\"abort\", abortHandler, false);\n    ajax.open(\"POST\", \"/createdotfromfasta\");\n    ajax.send(formdata);\n}\n\nfunction progressHandler(event){\n    var percent = (event.loaded / event.total) * 100;\n    document.getElementById(\"progressBar\").value = Math.round(percent);\n    document.getElementById(\"status\").innerHTML = Math.round(percent)+\"% uploaded... please wait\";\n}\nfunction completeHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Done\";\n    document.getElementById(\"progressBar\").value = 0;\n}\nfunction errorHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Failed\";\n}\nfunction abortHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Aborted\";\n}\n        </script>\n      </body>\n</html>","storeOutMessages":false,"fwdInMessages":false,"resendOnRefresh":false,"templateScope":"local","x":130,"y":360,"wires":[[]]},{"id":"887892d8.40e1b","type":"zip_folder","z":"58ac1d24.895954","name":"","pathIn":"","pathOut":"","x":1600,"y":460,"wires":[["69094dcd.b91904","45c37237.4117fc"]]},{"id":"67cab46b.e05fac","type":"delay","z":"58ac1d24.895954","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1600,"y":520,"wires":[["ec9adece.fca28","e2e74880.050c38"]]},{"id":"95e9a0f5.21f97","type":"create_dot_from_fasta","z":"58ac1d24.895954","name":"","fasta":"","pathfolder":"","outputname":"","x":1140,"y":420,"wires":[["cdb4ef00.fce48","17cf7140.90f90f"]]},{"id":"bd562e1.cb1cbd","type":"ui_ui_control","z":"58ac1d24.895954","name":"Refresh page restore","events":"all","x":140,"y":220,"wires":[["ef93fe6d.af991","3b8589e6.5762f6"]]},{"id":"ef93fe6d.af991","type":"fs-ops-dir","z":"58ac1d24.895954","name":"","path":"standardFiles","pathType":"str","filter":"*fasta","filterType":"str","dir":"payload","dirType":"msg","x":120,"y":300,"wires":[["398a5496.88553c"]]},{"id":"3ccadbb1.db9f64","type":"ui_template","z":"58ac1d24.895954","group":"96d17bc4.75e078","name":"output","order":1,"width":24,"height":9,"format":"<html>\n    <script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>  \n<body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"/file/{{msg.payload}}\" onclick=\"clickAndDisable(this);\">{{msg.filename}}</a>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1950,"y":280,"wires":[[]]},{"id":"624aeb62.c50344","type":"ui_ui_control","z":"58ac1d24.895954","name":"","events":"all","x":2000,"y":500,"wires":[[]]},{"id":"45c37237.4117fc","type":"function","z":"58ac1d24.895954","name":"","func":"msg.payload = { group: {\n    show : [\"DotBracketNotation_Out\"],\n    hide : [\"DotBracketNotation_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1820,"y":460,"wires":[["624aeb62.c50344"]]},{"id":"36e2ce23.9fa672","type":"function","z":"58ac1d24.895954","name":"","func":"msg.payload = { group: {\n    show : [\"DotBracketNotation_Text\"],\n    hide : [\"DotBracketNotation_Form\"]\n}, text: \"Creating Dot... Please wait.\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":280,"wires":[["ffae5719.1ff6c8","2383b8d0.7dc888"]]},{"id":"ffae5719.1ff6c8","type":"ui_ui_control","z":"58ac1d24.895954","name":"","events":"all","x":520,"y":140,"wires":[[]]},{"id":"3b8589e6.5762f6","type":"function","z":"58ac1d24.895954","name":"","func":"msg.payload = { group: {\n    show : [\"DotBracketNotation_Form\"],\n    hide : [\"DotBracketNotation_Text\", \"DotBracketNotation_Out\", \"DotBracketNotation_Error\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":120,"y":140,"wires":[["ffae5719.1ff6c8"]]},{"id":"69094dcd.b91904","type":"function","z":"58ac1d24.895954","name":"","func":"msg.filename = msg.payload.outputname\nmsg.payload = msg.payload.pathOut\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1860,"y":380,"wires":[["3ccadbb1.db9f64"]]},{"id":"e2e74880.050c38","type":"ui_template","z":"58ac1d24.895954","group":"570b0f5.92fecf","name":"error","order":1,"width":0,"height":0,"format":"<html>\n  <body>\n      <center>\n<h1>ERROR during execution!</h1>\n<h3>There was an error in the process. Please, repeat the procedure and check if the inputs files are correct</h3>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1790,"y":600,"wires":[[]]},{"id":"ec9adece.fca28","type":"function","z":"58ac1d24.895954","name":"","func":"msg.payload = { group: {\n    show : [\"DotBracketNotation_Error\"],\n    hide : [\"DotBracketNotation_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1820,"y":520,"wires":[["624aeb62.c50344"]]},{"id":"2383b8d0.7dc888","type":"ui_text","z":"58ac1d24.895954","group":"f78220cf.a311","order":1,"width":24,"height":6,"name":"","label":"","format":"{{msg.payload.text}}","layout":"col-center","x":690,"y":280,"wires":[]},{"id":"e1ca7e1d.5794b","type":"fs-ops-mkdir","z":"58ac1d24.895954","name":"","path":"","pathType":"str","dirname":"createDot","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":500,"y":600,"wires":[["2c0ec21b.a7584e"]]},{"id":"2c0ec21b.a7584e","type":"fs-ops-mkdir","z":"58ac1d24.895954","name":"","path":"createDot/","pathType":"str","dirname":"out","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":700,"y":600,"wires":[[]]},{"id":"17cf7140.90f90f","type":"function","z":"58ac1d24.895954","name":"","func":"if(msg.payload.fasta.startsWith(\"standardFiles\")) {\n    msg.payload.fasta = null\n}\nelse {\n    msg.payload.fasta = msg.payload.fasta.split(\"/\")[2]\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1280,"y":520,"wires":[["24a6343c.1d72cc"]]},{"id":"24a6343c.1d72cc","type":"fs-ops-move","z":"58ac1d24.895954","name":"","sourcePath":"createDot/out/","sourcePathType":"str","sourceFilename":"payload.fasta","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fasta","destFilenameType":"msg","link":false,"x":1340,"y":600,"wires":[[]]},{"id":"a81402d4.7dc44","type":"fs-ops-dir","z":"58ac1d24.895954","name":"get list of files","path":"sourcePath","pathType":"msg","filter":"*","filterType":"str","dir":"payload","dirType":"msg","x":580,"y":60,"wires":[["91cea838.4348f8"]]},{"id":"22306430.4c759c","type":"change","z":"58ac1d24.895954","name":"","rules":[{"t":"set","p":"sourcePath","pt":"msg","to":"createDot/out","tot":"str"},{"t":"set","p":"destinationPath","pt":"msg","to":"standardFiles","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":380,"y":60,"wires":[["a81402d4.7dc44"]]},{"id":"91cea838.4348f8","type":"split","z":"58ac1d24.895954","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":750,"y":60,"wires":[["464b103f.ddad3"]]},{"id":"c81468f8.0de5f8","type":"ui_button","z":"58ac1d24.895954","name":"","group":"96d17bc4.75e078","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":140,"y":60,"wires":[["22306430.4c759c","3b8589e6.5762f6"]]},{"id":"464b103f.ddad3","type":"fs-ops-move","z":"58ac1d24.895954","name":"","sourcePath":"sourcePath","sourcePathType":"msg","sourceFilename":"payload","sourceFilenameType":"msg","destPath":"destinationPath","destPathType":"msg","destFilename":"payload","destFilenameType":"msg","link":false,"x":840,"y":140,"wires":[[]]},{"id":"23b4a15c.b388ae","type":"exec","z":"58ac1d24.895954","command":"rm -rf \"createDot\"","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"rmDir","x":290,"y":560,"wires":[[],[],["e1ca7e1d.5794b"]]},{"id":"841451c4.53905","type":"delay","z":"58ac1d24.895954","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":360,"y":460,"wires":[["8218786d.1a3768","d07e9a0.8630a68"]]},{"id":"63b68fe2.3b37","type":"tab","label":"GetFile","disabled":false,"info":""},{"id":"13ff97c4.a5f538","type":"function","z":"63b68fe2.3b37","name":"Set base path","func":"msg.filename = msg.req.params.dir + \"/out/\" + msg.req.params.name\nmsg.payload = msg.filename\nreturn [msg, null];","outputs":1,"noerr":0,"initialize":"","finalize":"","x":360,"y":100,"wires":[["51ee434.ca5e4bc"]]},{"id":"f06c313.12678d","type":"http response","z":"63b68fe2.3b37","name":"","statusCode":"","headers":{},"x":870,"y":100,"wires":[]},{"id":"51ee434.ca5e4bc","type":"file in","z":"63b68fe2.3b37","name":"","filename":"","format":"","chunk":false,"sendError":false,"encoding":"none","x":590,"y":100,"wires":[["f06c313.12678d"]]},{"id":"1387fc34.2c3434","type":"catch","z":"63b68fe2.3b37","name":"","scope":null,"uncaught":false,"x":900,"y":220,"wires":[["23abde6b.41ee62","9e5fc35d.49927"]]},{"id":"23abde6b.41ee62","type":"function","z":"63b68fe2.3b37","name":"Set 404","func":"msg.payload = msg.error;\nmsg.statusCode = 404;//resource not found\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1100,"y":220,"wires":[["f06c313.12678d"]]},{"id":"9e5fc35d.49927","type":"debug","z":"63b68fe2.3b37","name":"msg","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1010,"y":280,"wires":[]},{"id":"7f63574.fcf6fa8","type":"http in","z":"63b68fe2.3b37","name":"","url":"/file/:dir/out/:name","method":"get","upload":false,"swaggerDoc":"","x":140,"y":100,"wires":[["13ff97c4.a5f538"]]},{"id":"ca48cca7.f8a3e","type":"fs-ops-delete","z":"63b68fe2.3b37","name":"","path":"","pathType":"str","filename":"filename","filenameType":"msg","x":570,"y":280,"wires":[[]]},{"id":"392209ea.000b96","type":"function","z":"63b68fe2.3b37","name":"","func":"msg.payload = null;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":620,"y":160,"wires":[["ec39603e.bb803"]]},{"id":"ec39603e.bb803","type":"join","z":"63b68fe2.3b37","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":510,"y":220,"wires":[["ca48cca7.f8a3e"]]},{"id":"4a627d3f.a89a34","type":"function","z":"63b68fe2.3b37","name":"Set base path","func":"msg.filename = msg.req.params.dir + \"/\" + msg.req.params.name\nmsg.payload = msg.filename\nreturn [msg, null];","outputs":1,"noerr":0,"initialize":"","finalize":"","x":360,"y":380,"wires":[["b5d5b065.bf6e6"]]},{"id":"cd0d2cd6.dfb8a","type":"http response","z":"63b68fe2.3b37","name":"","statusCode":"","headers":{},"x":870,"y":380,"wires":[]},{"id":"b5d5b065.bf6e6","type":"file in","z":"63b68fe2.3b37","name":"","filename":"","format":"","chunk":false,"sendError":false,"encoding":"none","x":590,"y":380,"wires":[["cd0d2cd6.dfb8a"]]},{"id":"2870aaa2.27a3f6","type":"catch","z":"63b68fe2.3b37","name":"","scope":null,"uncaught":false,"x":900,"y":500,"wires":[["86b1ae36.a342a","559ae3f7.61c55c"]]},{"id":"86b1ae36.a342a","type":"function","z":"63b68fe2.3b37","name":"Set 404","func":"msg.payload = msg.error;\nmsg.statusCode = 404;//resource not found\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1100,"y":500,"wires":[["cd0d2cd6.dfb8a"]]},{"id":"559ae3f7.61c55c","type":"debug","z":"63b68fe2.3b37","name":"msg","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1010,"y":560,"wires":[]},{"id":"c40c222e.8a00b","type":"http in","z":"63b68fe2.3b37","name":"","url":"/file/:dir/:name","method":"get","upload":false,"swaggerDoc":"","x":130,"y":380,"wires":[["4a627d3f.a89a34"]]},{"id":"52843386.d2f10c","type":"fs-ops-delete","z":"63b68fe2.3b37","name":"","path":"","pathType":"str","filename":"filename","filenameType":"msg","x":570,"y":560,"wires":[[]]},{"id":"ab275e7b.b2e1a","type":"function","z":"63b68fe2.3b37","name":"","func":"msg.payload = null;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":620,"y":440,"wires":[["49df8561.af493c"]]},{"id":"49df8561.af493c","type":"join","z":"63b68fe2.3b37","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":510,"y":500,"wires":[["52843386.d2f10c"]]},{"id":"add0bf2d.e6903","type":"tab","label":"Complex-Process","disabled":false,"info":""},{"id":"4c37975e.5242b8","type":"http in","z":"add0bf2d.e6903","name":"","url":"/process","method":"post","upload":true,"swaggerDoc":"","x":540,"y":480,"wires":[["c0a2fd02.0d9dc","1bc97fd6.7d2c9","5095196b.125908","b0aca77d.e06a28","bf4ed318.78564","2d438f51.6f20b","8311023c.9eba9"]]},{"id":"f637bde7.c922b","type":"function","z":"add0bf2d.e6903","name":"","func":"//msg.name = msg.req.files[0].originalname;\n//global.set(\"name\",msg.payload.outputname);\n//global.set(\"flanking\",msg.payload.flanking);\nvar msg1\n\nif (msg.req.files.length ==2) {\n    msg1 = null\n    if(msg.req.files[1].fieldname != \"filegtf\") {\n        msg1 = { payload: msg.req.files[1].buffer, filename: \"extractFromTopat/out/\" + msg.req.files[1].originalname};\n    }\n    if(msg.req.files[0].fieldname != \"filegtf\") {\n        msg.payload = msg.req.files[0].buffer\n        msg.filename = \"extractFromTopat/out/\" + msg.req.files[0].originalname\n    }\n    else {\n        msg = null\n    }\n    return [msg,msg1]\n}\nelse if(msg.req.files.length ==3 ) {\n    msg1 = { payload: msg.req.files[2].buffer, filename: \"extractFromTopat/out/\" + msg.req.files[2].originalname};\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"extractFromTopat/out/\" + msg.req.files[0].originalname\n\n    return [msg,msg1];\n}\nelse if(msg.req.files.leght == 1) {\n    if(msg.req.files[0].fieldname != \"filegtf\") {\n        msg.payload = msg.req.files[0].buffer\n        msg.filename = \"extractFromTopat/out/\" + msg.req.files[0].originalname\n        return [msg,null];\n    }\n}\n/*\nvar msg1 = { payload: msg.req.files[2].buffer, filename: \"extractFromTopat/out/\" + msg.req.files[2].originalname};\nmsg.payload = msg.req.files[0].buffer\nmsg.filename = \"extractFromTopat/out/\" + msg.req.files[0].originalname\n\nreturn [msg,msg1];*/","outputs":2,"noerr":0,"initialize":"","finalize":"","x":1380,"y":640,"wires":[["5fb2b1cc.05d9e"],["59e37a89.975914"]]},{"id":"5fb2b1cc.05d9e","type":"file","z":"add0bf2d.e6903","name":"fasta","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":1510,"y":580,"wires":[["8942883e.0b5748"]]},{"id":"42295bd8.15dcf4","type":"function","z":"add0bf2d.e6903","name":"","func":"/*msg.payload.fasta = \"extractFromTopat/out/\" + msg.req.files[0].originalname\nmsg.payload.tp = \"extractFromTopat/out/\" + msg.req.files[2].originalname\nmsg.payload.pathfolder = \"outputProcess/out\"\nmsg.payload.flanking = msg.payload.flanking\nmsg.payload.outputname = \"IR_\" + msg.payload.outputname\nreturn msg;*/\n\n//global.set(\"name\",msg.payload.outputname);\nif(msg.req.files.length == 3) {\n    msg.payload.fasta = \"extractFromTopat/out/\" + msg.req.files[0].originalname\n    msg.payload.tp = \"extractFromTopat/out/\" + msg.req.files[2].originalname\n    msg.payload.pathfolder = \"outputProcess/out\"\n    msg.payload.flanking = msg.payload.flanking\n    msg.payload.outputname = \"IR_\" + msg.payload.outputname\n    return msg;\n}\nelse if(msg.req.files.length == 2 && (msg.req.files[0].fieldname == \"filefasta\" && msg.req.files[1].fieldname == \"fileirgtf\")) {\n    msg.payload.fasta = \"extractFromTopat/out/\" + msg.req.files[0].originalname\n    msg.payload.tp = \"extractFromTopat/out/\" + msg.req.files[1].originalname\n    msg.payload.pathfolder = \"outputProcess/out\"\n    msg.payload.flanking = msg.payload.flanking\n    msg.payload.outputname = \"IR_\" + msg.payload.outputname\n    return msg;\n}\nelse if( msg.req.files.length == 2) {\n    if(msg.req.files[0].fieldname == \"filefasta\") {\n        msg.payload.fasta = \"extractFromTopat/out/\" + msg.req.files[0].originalname\n        msg.payload.tp = \"standardFiles/\" + msg.payload.filefasta\n        msg.payload.pathfolder = \"outputProcess/out\"\n        msg.payload.flanking = msg.payload.flanking\n        msg.payload.outputname = \"IR_\" + msg.payload.outputname\n        return msg;\n    }\n    else if (msg.req.files[1].fieldname == \"fileirgtf\") {\n        msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n        msg.payload.tp = \"extractFromTopat/out/\" + msg.req.files[1].originalname\n        msg.payload.pathfolder = \"outputProcess/out\"\n        msg.payload.flanking = msg.payload.flanking\n        msg.payload.outputname = \"IR_\" + msg.payload.outputname\n        return msg;\n    }\n}\nelse if(msg.req.files.length == 1) {\n    if(msg.req.files[0].fieldname == \"filefasta\") {\n        msg.payload.fasta = \"extractFromTopat/out/\" + msg.req.files[0].originalname\n        msg.payload.tp = \"standardFiles/\" + msg.payload.fileirgtf\n        msg.payload.pathfolder = \"outputProcess/out\"\n        msg.payload.flanking = msg.payload.flanking\n        msg.payload.outputname = \"IR_\" + msg.payload.outputname\n        return msg;\n    }\n    else if (msg.req.files[0].fieldname == \"fileirgtf\") {\n        msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n        msg.payload.tp = \"extractFromTopat/out/\" + msg.req.files[0].originalname\n        msg.payload.pathfolder = \"outputProcess/out\"\n        msg.payload.flanking = msg.payload.flanking\n        msg.payload.outputname = \"IR_\" + msg.payload.outputname\n        return msg;\n    }\n}\nelse {\n    msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n    msg.payload.tp = \"standardFiles/\" + msg.payload.fileirgtf\n    msg.payload.pathfolder = \"outputProcess/out\"\n    msg.payload.flanking = msg.payload.flanking\n    msg.payload.outputname = \"IR_\" + msg.payload.outputname\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1400,"y":880,"wires":[["ce6bf5ab.754608"]]},{"id":"59e37a89.975914","type":"file","z":"add0bf2d.e6903","name":"topat","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":1510,"y":700,"wires":[["26da12c4.bfbfae"]]},{"id":"ce6bf5ab.754608","type":"join","z":"add0bf2d.e6903","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"8","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1890,"y":680,"wires":[["6f3cc181.d8dcb"]]},{"id":"8942883e.0b5748","type":"function","z":"add0bf2d.e6903","name":"","func":"msg.payload = {\n    f1:\"done\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1660,"y":580,"wires":[["ce6bf5ab.754608"]]},{"id":"26da12c4.bfbfae","type":"function","z":"add0bf2d.e6903","name":"","func":"msg.payload = {\n    f2:\"done\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1660,"y":700,"wires":[["ce6bf5ab.754608"]]},{"id":"6f3cc181.d8dcb","type":"extract_intron_using_bed_file_from_topat","z":"add0bf2d.e6903","name":"","fasta":"","tp":"","pathfolder":"","outputname":"","flanking":"","x":2140,"y":680,"wires":[["4b466555.83a33c","1c740024.f6af2","c11e1752.634138","b96594c4.c492f8"]]},{"id":"eb21c545.a34408","type":"function","z":"add0bf2d.e6903","name":"","func":"//msg.name = msg.req.files[0].originalname;\n//global.set(\"name\",msg.payload.outputname);\nvar msg1\n\nif (msg.req.files.length ==2) {\n    msg1 = null\n    if(msg.req.files[1].fieldname != \"fileirgtf\") {\n        msg1 = { payload: msg.req.files[1].buffer, filename: \"extractFromCUFF/out/\" + msg.req.files[1].originalname};\n    }\n    if(msg.req.files[0].fieldname != \"fileirgtf\") {\n        msg.payload = msg.req.files[0].buffer\n        msg.filename = \"extractFromCUFF/out/\" + msg.req.files[0].originalname\n    }\n    else {\n        msg = null\n    }\n    return [msg,msg1]\n}\nelse if(msg.req.files.length ==3 ) {\n    msg1 = { payload: msg.req.files[1].buffer, filename: \"extractFromCUFF/out/\" + msg.req.files[1].originalname};\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"extractFromCUFF/out/\" + msg.req.files[0].originalname\n\n    return [msg,msg1];\n}\nelse if(msg.req.files.leght == 1) {\n    if(msg.req.files[0].fieldname != \"fileirgtf\") {\n        msg.payload = msg.req.files[0].buffer\n        msg.filename = \"extractFromCUFF/out/\" + msg.req.files[0].originalname\n        return [msg,null];\n    }\n}","outputs":2,"noerr":0,"initialize":"","finalize":"","x":1380,"y":360,"wires":[["9702bc26.a8f2e"],["443e3c41.4540b4"]]},{"id":"9702bc26.a8f2e","type":"file","z":"add0bf2d.e6903","name":"fasta","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":1510,"y":300,"wires":[["795ec842.6d1838"]]},{"id":"f3780d1e.c31c8","type":"function","z":"add0bf2d.e6903","name":"","func":"//global.set(\"name\",msg.payload.outputname);\nif(msg.req.files.length == 3 || msg.req.files.length == 2 && (msg.req.files[0].fieldname == \"filefasta\" && msg.req.files[1].fieldname == \"filegtf\")) {\n    msg.payload.fasta = \"extractFromCUFF/out/\" + msg.req.files[0].originalname\n    msg.payload.cuff = \"extractFromCUFF/out/\" + msg.req.files[1].originalname\n    msg.payload.pathfolder = \"extractFromCUFF/out\"\n    msg.payload.flanking = msg.payload.flanking\n    msg.payload.outputname = msg.payload.outputname\n    return msg;\n}\nelse if( msg.req.files.length == 2) {\n    if(msg.req.files[0].fieldname == \"filefasta\") {\n        msg.payload.fasta = \"extractFromCUFF/out/\" + msg.req.files[0].originalname\n        msg.payload.cuff = \"standardFiles/\" + msg.payload.filegtf\n        msg.payload.pathfolder = \"extractFromCUFF/out\"\n        msg.payload.flanking = msg.payload.flanking\n        msg.payload.outputname = msg.payload.outputname\n        return msg;\n    }\n    else if (msg.req.files[0].fieldname == \"filegtf\") {\n        msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n        msg.payload.cuff = \"extractFromCUFF/out/\" + msg.req.files[0].originalname\n        msg.payload.pathfolder = \"extractFromCUFF/out\"\n        msg.payload.flanking = msg.payload.flanking\n        msg.payload.outputname = msg.payload.outputname\n        return msg;\n    }\n}\nelse if(msg.req.files.length == 1) {\n    if(msg.req.files[0].fieldname == \"filefasta\") {\n        msg.payload.fasta = \"extractFromCUFF/out/\" + msg.req.files[0].originalname\n        msg.payload.cuff = \"standardFiles/\" + msg.payload.filefasta\n        msg.payload.pathfolder = \"extractFromCUFF/out\"\n        msg.payload.flanking = msg.payload.flanking\n        msg.payload.outputname = msg.payload.outputname\n        return msg;\n    }\n    else if (msg.req.files[0].fieldname == \"filegtf\") {\n        msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n        msg.payload.cuff = \"extractFromCUFF/out/\" + msg.req.files[0].originalname\n        msg.payload.pathfolder = \"extractFromCUFF/out\"\n        msg.payload.flanking = msg.payload.flanking\n        msg.payload.outputname = msg.payload.outputname\n        return msg;\n    }\n}\nelse {\n    msg.payload.fasta = \"standardFiles/\" + msg.payload.filefasta\n    msg.payload.cuff = \"standardFiles/\" + msg.payload.filegtf\n    msg.payload.pathfolder = \"extractFromCUFF/out\"\n    msg.payload.flanking = msg.payload.flanking\n    msg.payload.outputname = msg.payload.outputname\n    return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1400,"y":160,"wires":[["1d93e356.8d7f8d"]]},{"id":"443e3c41.4540b4","type":"file","z":"add0bf2d.e6903","name":"CUFF","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":1510,"y":420,"wires":[["da2fe97d.ebb038"]]},{"id":"1d93e356.8d7f8d","type":"join","z":"add0bf2d.e6903","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"8","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1870,"y":280,"wires":[["e5a6ea8d.c98d88"]]},{"id":"795ec842.6d1838","type":"function","z":"add0bf2d.e6903","name":"","func":"msg.payload = {\n    f1:\"done\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1660,"y":300,"wires":[["1d93e356.8d7f8d"]]},{"id":"da2fe97d.ebb038","type":"function","z":"add0bf2d.e6903","name":"","func":"msg.payload = {\n    f2:\"done\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1660,"y":420,"wires":[["1d93e356.8d7f8d"]]},{"id":"e5a6ea8d.c98d88","type":"extract_intron_from_cuff_gtf","z":"add0bf2d.e6903","name":"","fasta":"","cuff":"","pathfolder":"","outputname":"","flanking":"","x":2100,"y":280,"wires":[["9ca65b60.a1c108","e02d70f9.58c7a","f9664b21.b3cc48","5ad309c8.a76308"]]},{"id":"9ca65b60.a1c108","type":"function","z":"add0bf2d.e6903","name":"","func":"msg.payload = {\n    fasta1: msg.payload.pathfolder + \"/\" + msg.payload.outputname,\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2140,"y":440,"wires":[["1ae2eb9a.ea99a4"]]},{"id":"4b466555.83a33c","type":"function","z":"add0bf2d.e6903","name":"","func":"msg.payload = {\n    fasta2: msg.payload.pathfolder + \"/\" + msg.payload.outputname\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2140,"y":520,"wires":[["1ae2eb9a.ea99a4"]]},{"id":"1ae2eb9a.ea99a4","type":"join","z":"add0bf2d.e6903","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"5","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":2330,"y":480,"wires":[["2d5d2b17.e47244","a81b14c2.556b58","e87966f6.60d448"]]},{"id":"ee1f377f.890388","type":"function","z":"add0bf2d.e6903","name":"","func":"//var name = global.get(\"name\");\nif(msg.payload.stdout!==\"Error\") {\n    if(msg.payload.zip===\"no\") {\n        msg.payload.path = \"/file/outputProcess/out/\"+msg.payload.outputname\n        msg.payload.fasta2 = \"/file/\"+msg.payload.fasta2\n        return[msg,null,null]\n    }\n    else if(msg.payload.zip===\"yes\") {\n        msg.payload.outputname = msg.payload.outzip.slice(0,-6) + \".zip\";\n        msg.payload.pathIn = \"outputProcess/out\"\n        msg.payload.pathOut = \"outputProcess/\"+msg.payload.outputname\n        return [null,msg,null]\n    }\n}\nelse {\n    return [null,null,msg]\n}\n","outputs":3,"noerr":0,"initialize":"","finalize":"","x":3240,"y":480,"wires":[["febf238d.9008d","75634428.f4bfcc"],["436d076f.ddd688"],["7713fc64.bd1774"]]},{"id":"436d076f.ddd688","type":"zip_folder","z":"add0bf2d.e6903","name":"","pathIn":"","pathOut":"","x":3440,"y":480,"wires":[["3f5cea71.cba526","37d6f7bc.496f98"]]},{"id":"e5b89891.b043b8","type":"remove_conting_from_fasta","z":"add0bf2d.e6903","name":"","fasta1":"","fasta2":"","pathfolder":"","outputname":"","x":2720,"y":480,"wires":[["61abe7ee.e82218","2a8ce9ff.0e4906","332effb.dd624"]]},{"id":"2d5d2b17.e47244","type":"function","z":"add0bf2d.e6903","name":"","func":"msg.payload.pathfolder = \"outputProcess/out\"\nmsg.payload.outzip = msg.payload.outputname\nmsg.payload.outputname = \"INR_\" + msg.payload.outputname\nmsg.payload.text = \"Remove contig from Fasta is processing...\"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2500,"y":480,"wires":[["e5b89891.b043b8","ce59961f.a62498"]]},{"id":"a81b14c2.556b58","type":"fs-ops-mkdir","z":"add0bf2d.e6903","name":"","path":"","pathType":"str","dirname":"removeFromFasta","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":2520,"y":420,"wires":[["de43ecb6.2cdfe"]]},{"id":"de43ecb6.2cdfe","type":"fs-ops-mkdir","z":"add0bf2d.e6903","name":"","path":"removeFromFasta/","pathType":"str","dirname":"out","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":2720,"y":420,"wires":[[]]},{"id":"1c740024.f6af2","type":"json","z":"add0bf2d.e6903","name":"","property":"payload.stdout","action":"","pretty":true,"x":2590,"y":680,"wires":[["78dc8f10.eb768","e46dcb01.a67f28"]]},{"id":"78dc8f10.eb768","type":"ui_gauge","z":"add0bf2d.e6903","name":"","group":"fa38ca41.d37ef8","order":5,"width":5,"height":3,"gtype":"gage","title":"Intron removed","label":"","format":"{{msg.payload.stdout.intron_removed}}","min":0,"max":"1","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":2780,"y":680,"wires":[]},{"id":"e46dcb01.a67f28","type":"ui_gauge","z":"add0bf2d.e6903","name":"","group":"fa38ca41.d37ef8","order":7,"width":5,"height":3,"gtype":"gage","title":"Total intron reteined","label":"","format":"{{msg.payload.stdout.total_intron_reteined}}","min":0,"max":"1","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":2790,"y":720,"wires":[]},{"id":"e02d70f9.58c7a","type":"json","z":"add0bf2d.e6903","name":"","property":"payload.stdout","action":"","pretty":false,"x":2430,"y":280,"wires":[["18a62cd2.50f5b3","9e290ec.6397bf","9c796330.d73c4","79f049d9.5df148"]]},{"id":"9c796330.d73c4","type":"ui_gauge","z":"add0bf2d.e6903","name":"","group":"fa38ca41.d37ef8","order":27,"width":6,"height":3,"gtype":"gage","title":"Total intron found","label":"","format":"{{msg.payload.stdout.total_intron_foud}}","min":0,"max":"1","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":2790,"y":280,"wires":[]},{"id":"9e290ec.6397bf","type":"ui_gauge","z":"add0bf2d.e6903","name":"","group":"fa38ca41.d37ef8","order":16,"width":5,"height":3,"gtype":"gage","title":"Total intron removed","label":"","format":"{{msg.payload.stdout.total_intron_removed}}","min":0,"max":"1","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":2800,"y":320,"wires":[]},{"id":"79f049d9.5df148","type":"ui_text","z":"add0bf2d.e6903","group":"fa38ca41.d37ef8","order":2,"width":8,"height":1,"name":"","label":"Intron Candidate","format":"{{msg.payload.stdout.candidate_intron}}","layout":"col-center","x":2790,"y":240,"wires":[]},{"id":"18a62cd2.50f5b3","type":"function","z":"add0bf2d.e6903","name":"","func":"msg = {ui_control:{max:msg.payload.stdout.candidate_intron}};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2520,"y":340,"wires":[["9e290ec.6397bf","9c796330.d73c4","78dc8f10.eb768","e46dcb01.a67f28","3201a296.3000ee"]]},{"id":"75634428.f4bfcc","type":"function","z":"add0bf2d.e6903","name":"Output_group","func":"msg = {};\nmsg.payload = { group: {\n    show : [\"ComplexProcess_Download\",\"ComplexProcess_Output\"],\n    hide : [\"ComplexProcess_Text\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3400,"y":620,"wires":[["ce30eb48.1d3998"]]},{"id":"ce30eb48.1d3998","type":"ui_ui_control","z":"add0bf2d.e6903","name":"Go to Group","events":"all","x":3690,"y":680,"wires":[[]]},{"id":"adb2762e.155738","type":"ui_ui_control","z":"add0bf2d.e6903","name":"Refresh page restore","events":"all","x":140,"y":500,"wires":[["8f9433d8.9daa8","20ae0c55.8390c4"]]},{"id":"8f9433d8.9daa8","type":"function","z":"add0bf2d.e6903","name":"","func":"msg.payload = { group: {\n    show : [\"ComplexProcess_Process\"],\n    hide : [\"ComplexProcess_Text\",\"ComplexProcess_Download\",\"ComplexProcess_Output\",\"ComplexProcess_Error\",\"ComplexProcess_Zip\"]\n}\n};\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":180,"y":420,"wires":[["191b7877.613de8"]]},{"id":"191b7877.613de8","type":"ui_ui_control","z":"add0bf2d.e6903","name":"","events":"all","x":320,"y":420,"wires":[[]]},{"id":"61abe7ee.e82218","type":"json","z":"add0bf2d.e6903","name":"","property":"payload.stdout","action":"","pretty":true,"x":2890,"y":400,"wires":[["3201a296.3000ee"]]},{"id":"3201a296.3000ee","type":"ui_gauge","z":"add0bf2d.e6903","name":"","group":"fa38ca41.d37ef8","order":18,"width":5,"height":3,"gtype":"gage","title":"Total not reteined intron","label":"","format":"{{msg.payload.stdout.Total_Not_Reteined_Intron}}","min":0,"max":"1","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":3090,"y":340,"wires":[]},{"id":"5e55561c.a02018","type":"ui_text","z":"add0bf2d.e6903","group":"68bbb66e.e5e278","order":1,"width":8,"height":1,"name":"","label":"","format":"{{msg.payload}}","layout":"col-center","x":1870,"y":440,"wires":[]},{"id":"c354ff5e.3d26d","type":"ui_text","z":"add0bf2d.e6903","group":"68bbb66e.e5e278","order":2,"width":8,"height":1,"name":"","label":"","format":"{{msg.payload}}","layout":"col-center","x":1870,"y":520,"wires":[]},{"id":"8311023c.9eba9","type":"function","z":"add0bf2d.e6903","name":"","func":"var msg1 = {payload:\"Extract intron from Astalavista is processing....\"}\nmsg.payload = \"Extract intron from CUFF is processing....\"\nreturn [msg,msg1]","outputs":2,"noerr":0,"initialize":"","finalize":"","x":1660,"y":480,"wires":[["5e55561c.a02018"],["c354ff5e.3d26d"]]},{"id":"c0a2fd02.0d9dc","type":"function","z":"add0bf2d.e6903","name":"Redirection","func":"msg = {};\nmsg.payload = { group: {\n    show : [\"ComplexProcess_Text\"],\n    hide : [\"ComplexProcess_Process\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":550,"y":380,"wires":[["a8aef1d6.91af1"]]},{"id":"a8aef1d6.91af1","type":"ui_ui_control","z":"add0bf2d.e6903","name":"Go to Group","events":"all","x":550,"y":320,"wires":[[]]},{"id":"c11e1752.634138","type":"function","z":"add0bf2d.e6903","name":"","func":"msg.payload = \"Process Extract intron from Astalavista: DONE!\"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1990,"y":600,"wires":[["c354ff5e.3d26d"]]},{"id":"f9664b21.b3cc48","type":"function","z":"add0bf2d.e6903","name":"","func":"msg.payload = \"Process Extract intron from CUFF: DONE!\"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1960,"y":360,"wires":[["5e55561c.a02018"]]},{"id":"febf238d.9008d","type":"ui_template","z":"add0bf2d.e6903","group":"b6b24a48.ac4c28","name":"Dowlnload","order":1,"width":24,"height":4,"format":"<script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>  \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"{{msg.payload.path}}\" onclick=\"clickAndDisable(this);\">Fasta Intron Not Retained</a> <br>\n    <a href=\"{{msg.payload.fasta2}}\" onclick=\"clickAndDisable(this);\">Fasta Intron Retained</a> <br>\n    <a href=\"{{msg.payload.path}}Plus\" onclick=\"clickAndDisable(this);\">Fasta Intron Not Retained PLUS</a> <br>\n    <a href=\"{{msg.payload.fasta2}}Plus\" onclick=\"clickAndDisable(this);\">Fasta Intron Retained PLUS</a>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":3710,"y":420,"wires":[[]]},{"id":"3f5cea71.cba526","type":"function","z":"add0bf2d.e6903","name":"","func":"msg.payload.path = \"/file/\"+msg.payload.pathOut\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3600,"y":480,"wires":[["9a84fea6.d65fb"]]},{"id":"ce59961f.a62498","type":"ui_text","z":"add0bf2d.e6903","group":"68bbb66e.e5e278","order":3,"width":0,"height":0,"name":"","label":"","format":"{{msg.payload.text}}","layout":"col-center","x":2670,"y":1000,"wires":[]},{"id":"1bc97fd6.7d2c9","type":"function","z":"add0bf2d.e6903","name":"","func":"msg.payload.text =\"\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1380,"y":1020,"wires":[["ce59961f.a62498"]]},{"id":"2a8ce9ff.0e4906","type":"function","z":"add0bf2d.e6903","name":"","func":"msg.payload.text = \"Process Remove contig from Fasta: DONE!\"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3000,"y":860,"wires":[["ce59961f.a62498"]]},{"id":"6f8522be.11d34c","type":"ui_template","z":"add0bf2d.e6903","group":"7ab29b4.3dca464","name":"Error","order":1,"width":8,"height":3,"format":"<html>\n  <body>\n      <center>\n<h1>ERROR during execution!</h1>\n<h3>There was an error in the process. Please, repeat the procedure and check if the inputs files are correct</h3>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":3770,"y":540,"wires":[[]]},{"id":"7713fc64.bd1774","type":"function","z":"add0bf2d.e6903","name":"Error_group","func":"msg.payload = { group: {\n    show : [\"ComplexProcess_Error\"],\n    hide : [\"ComplexProcess_Text\"]\n}}\nreturn msg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3450,"y":560,"wires":[["ce30eb48.1d3998"]]},{"id":"b92e3743.b89d58","type":"fs-ops-mkdir","z":"add0bf2d.e6903","name":"","path":"","pathType":"str","dirname":"outputProcess","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":1440,"y":1200,"wires":[["7092df7d.ee53f"]]},{"id":"7092df7d.ee53f","type":"fs-ops-mkdir","z":"add0bf2d.e6903","name":"","path":"outputProcess/","pathType":"str","dirname":"out","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":1640,"y":1200,"wires":[[]]},{"id":"9a84fea6.d65fb","type":"ui_template","z":"add0bf2d.e6903","group":"9b368654.c443b8","name":"Zip","order":1,"width":24,"height":3,"format":"<script> \n   function clickAndDisable(link) {\n     // disable subsequent clicks\n     link.onclick = function(event) {\n        event.preventDefault();\n     }\n   }   \n</script>  \n  <body>\n      <center>\n<h1>Process Done !</h1>\n<h3>Click the name for download it</h3>\n<div>\n    <a href=\"{{msg.payload.path}}\" onclick=\"clickAndDisable(this);\">{{msg.payload.outputname}}</a> <br>\n</div>\n<br><br><br><h5>If you don't storage the files to the server or download them, they will be DELETED</h5>\n</center>\n</body>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":3770,"y":480,"wires":[[]]},{"id":"37d6f7bc.496f98","type":"function","z":"add0bf2d.e6903","name":"zip_group","func":"msg.payload = { group: {\n    show : [\"ComplexProcess_Zip\",\"ComplexProcess_Output\"],\n    hide : [\"ComplexProcess_Text\"]\n}}\nreturn msg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3540,"y":520,"wires":[["ce30eb48.1d3998"]]},{"id":"a48b7e14.0db7d","type":"remove_conting_from_fasta","z":"add0bf2d.e6903","name":"","fasta1":"","fasta2":"","pathfolder":"","outputname":"","x":2720,"y":540,"wires":[["163bbcb6.7cc863"]]},{"id":"e87966f6.60d448","type":"function","z":"add0bf2d.e6903","name":"","func":"msg.payload.pathfolder = \"outputProcess/out\"\nmsg.payload.outzip = msg.payload.outputname+\"Plus\"\nmsg.payload.outputname = \"INR_\" + msg.payload.outputname + \"Plus\"\nmsg.payload.fasta1 = msg.payload.fasta1 + \"Plus\"\nmsg.payload.fasta2 = msg.payload.fasta2 + \"Plus\"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2500,"y":540,"wires":[["a48b7e14.0db7d"]]},{"id":"163bbcb6.7cc863","type":"function","z":"add0bf2d.e6903","name":"","func":"msg.payload = {go:\"y\"}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2980,"y":540,"wires":[["332effb.dd624"]]},{"id":"332effb.dd624","type":"join","z":"add0bf2d.e6903","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"10","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":3070,"y":480,"wires":[["ee1f377f.890388"]]},{"id":"2a10be7f.09bea2","type":"ui_template","z":"add0bf2d.e6903","group":"a5a41cc4.d37da","name":"","order":1,"width":0,"height":0,"format":"<!DOCTYPE html>\n<html>\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<link href=\"https://fonts.googleapis.com/css?family=Raleway\" rel=\"stylesheet\">\n<style>\n* {\n  box-sizing: border-box;\n}\n\nbody {\n  background-color: #f1f1f1;\n}\n\n#regForm {\n  background-color: #ffffff;\n  margin: 100px auto;\n  font-family: Raleway;\n  padding: 40px;\n  width: 70%;\n  min-width: 300px;\n}\n\nh1 {\n  text-align: center;  \n}\n\ninput {\n  padding: 10px;\n  width: 100%;\n  font-size: 17px;\n  font-family: Raleway;\n  border: 1px solid #aaaaaa;\n}\n\n/* Mark input boxes that gets an error on validation: */\ninput.invalid {\n  background-color: #ffdddd;\n}\n\n/* Hide all steps by default: */\n.tab {\n  display: none;\n}\n\nbutton {\n  background-color: #4CAF50;\n  color: #ffffff;\n  border: none;\n  padding: 10px 20px;\n  font-size: 17px;\n  font-family: Raleway;\n  cursor: pointer;\n}\n\nbutton:hover {\n  opacity: 0.8;\n}\n\n#prevBtn {\n  background-color: #bbbbbb;\n}\n\n/* Make circles that indicate the steps of the form: */\n.step {\n  height: 15px;\n  width: 15px;\n  margin: 0 2px;\n  background-color: #bbbbbb;\n  border: none;  \n  border-radius: 50%;\n  display: inline-block;\n  opacity: 0.5;\n}\n\n.step.active {\n  opacity: 1;\n}\n\n/* Mark the steps that are finished and valid: */\n.step.finish {\n  background-color: #4CAF50;\n}\n</style>\n<body>\n\n<form id=\"regForm\" action=\"/step\" method=\"post\" enctype=\"multipart/form-data\">\n  <h1>Complex Process</h1>\n  <!-- One \"tab\" for each step in the form: -->\n  <div class=\"tab\">Insert Genoma file:\n    <p><input placeholder=\"Fasta File\" id=\"filefasta\" type=\"file\" name=\"filefasta\"  accept=\".fasta\" oninput=\"this.className = ''\"></p>\n     <p><label for=\"filefastaDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label><br>\n    <select id=\"filefastaDEF\" name=\"filefastaDEF\">\n    <option value=\"\">Nessun File</option>\n    <option ng-repeat=\"obj in msg.payload.fasta\" value=\"{{obj}}\">{{ obj }}</option>\n    </select></p>\n  </div>\n  <div class=\"tab\">Insert CUFF file:\n    <p><input placeholder=\"Cuff File\" id=\"filegtf\" type=\"file\" name=\"filegtf\" oninput=\"this.className = ''\" accept=\".gtf\"></p>\n     <p><label for=\"filegtfDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label><br>\n    <select id=\"filegtfDEF\" name=\"filegtfDEF\">\n    <option value=\"\">Nessun File</option>\n    <option ng-repeat=\"obj in msg.payload.gtf\" value=\"{{obj}}\">{{ obj }}</option>\n    </select></p>\n  </div>\n  <div class=\"tab\">Insert Astalavista file:\n    <p><input placeholder=\"Astalavista File\" id=\"fileirgtf\" type=\"file\" name=\"fileirgtf\" class=\"auto-style1\" accept=\".gtf\" oninput=\"this.className = ''\"></p>\n     <p><label for=\"fileirgtfDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label><br>\n    <select id=\"fileirgtfDEF\" name=\"fileirgtfDEF\">\n    <option value=\"\">Nessun File</option>\n    <option ng-repeat=\"obj in msg.payload.gtf\" value=\"{{obj}}\">{{ obj }}</option>\n    </select></p>\n  </div>\n  <div class=\"tab\">Insert output options:\n    <p><input placeholder=\"Name...\" oninput=\"this.className = ''\" name=\"outputname\" id=\"outputname\"></p>\n    <p><input placeholder=\"Flanking... (OPTIONAL)\" name=\"flanking\" id=\"flanking\"></p>\n    <label for=\"zip\">Want zip the output (if chose \"NO\" you can download the files individually):</label>\n      <select id=\"zip\" name=\"zip\">\n          <option value=\"yes\">YES</option>\n          <option value=\"no\">NO</option>\n          </select> <br><br>\n  </div>\n  <div style=\"overflow:auto;\">\n    <div style=\"float:right;\">\n      <button type=\"button\" id=\"prevBtn\" onclick=\"nextPrev(-1)\">Previous</button>\n      <button type=\"button\" id=\"nextBtn\" onclick=\"nextPrev(1)\">Next</button>\n    </div>\n  </div>\n  <!-- Circles which indicates the steps of the form: -->\n  <div style=\"text-align:center;margin-top:40px;\">\n    <span class=\"step\"></span>\n    <span class=\"step\"></span>\n    <span class=\"step\"></span>\n    <span class=\"step\"></span>\n  </div>\n  \n  <div style=\"text-align:center;margin-top:40px;\">\n      <progress id=\"progressBar\" value=\"0\" max=\"100\" style=\"width:300px;\"></progress>\n        <p id=\"status\"></p>\n  </div>\n</form>\n\n<script>\nvar currentTab = 0; // Current tab is set to be the first tab (0)\nshowTab(currentTab); // Display the current tab\n\nfunction showTab(n) {\n    document.getElementById(\"progressBar\").style.display = \"none\";\n  // This function will display the specified tab of the form...\n  var x = document.getElementsByClassName(\"tab\");\n  x[n].style.display = \"block\";\n  //... and fix the Previous/Next buttons:\n  if (n == 0) {\n    document.getElementById(\"prevBtn\").style.display = \"none\";\n  } else {\n    document.getElementById(\"prevBtn\").style.display = \"inline\";\n  }\n  if (n == (x.length - 1)) {\n    document.getElementById(\"nextBtn\").innerHTML = \"Submit\";\n  } else {\n    document.getElementById(\"nextBtn\").innerHTML = \"Next\";\n  }\n  //... and run a function that will display the correct step indicator:\n  fixStepIndicator(n)\n}\n\nfunction nextPrev(n) {\n  // This function will figure out which tab to display\n  var x = document.getElementsByClassName(\"tab\");\n  // Exit the function if any field in the current tab is invalid:\n  if (n == 1 && !validateForm()) return false;\n  // Hide the current tab:\n  x[currentTab].style.display = \"none\";\n  // Increase or decrease the current tab by 1:\n  currentTab = currentTab + n;\n  // if you have reached the end of the form...\n  if (currentTab >= x.length) {\n    // ... the form gets submitted:\n    //document.getElementById(\"regForm\").submit();\n     document.getElementById(\"progressBar\").style.display = \"inline\";\n    document.getElementById(\"prevBtn\").style.display = \"none\";\n    document.getElementById(\"nextBtn\").style.display = \"none\";\n    uploadFile();\n    return false;\n  }\n  // Otherwise, display the correct tab:\n  showTab(currentTab);\n}\n\nfunction validateForm() {\n  // This function deals with validation of the form fields\n  var x, y, i, valid = true;\n  x = document.getElementsByClassName(\"tab\");\n  y = x[currentTab].getElementsByTagName(\"input\");\n  // A loop that checks every input field in the current tab:\n  for (i = 0; i < y.length; i++) {\n    // If a field is empty...\n    if (y[i].value == \"\" && y[i].name != \"flanking\") {\n      if( y[i].name == \"filefasta\" && document.getElementById(\"filefastaDEF\").value == \"\") {\n        // add an \"invalid\" class to the field:\n        y[i].className += \" invalid\";\n        valid = false;\n        // and set the current valid status to false\n        }\n        if( y[i].name == \"filegtf\" && document.getElementById(\"filegtfDEF\").value == \"\") {\n        // add an \"invalid\" class to the field:\n        y[i].className += \" invalid\";\n        valid = false;\n        // and set the current valid status to false\n        }\n        if( y[i].name == \"fileirgtf\" && document.getElementById(\"fileirgtfDEF\").value == \"\") {\n        // add an \"invalid\" class to the field:\n        y[i].className += \" invalid\";\n        valid = false;\n        // and set the current valid status to false\n        }\n        if( y[i].name == \"outputname\") {\n        // add an \"invalid\" class to the field:\n        y[i].className += \" invalid\";\n        // and set the current valid status to false\n        valid = false;\n        }\n    }\n  }\n  // If the valid status is true, mark the step as finished and valid:\n  if (valid) {\n    document.getElementsByClassName(\"step\")[currentTab].className += \" finish\";\n  }\n  return valid; // return the valid status\n}\n\nfunction fixStepIndicator(n) {\n  // This function removes the \"active\" class of all steps...\n  var i, x = document.getElementsByClassName(\"step\");\n  for (i = 0; i < x.length; i++) {\n    x[i].className = x[i].className.replace(\" active\", \"\");\n  }\n  //... and adds the \"active\" class on the current step:\n  x[n].className += \" active\";\n}\n\nfunction uploadFile(){\n    \n    var fileFasta;\n    \n    if(document.getElementById(\"filefastaDEF\").value != \"\")\n    {\n        fileFasta = document.getElementById(\"filefastaDEF\").value;\n    }\n    else {\n        fileFasta = document.getElementById(\"filefasta\").files[0];\n    }\n    \n    var fileGTF;\n    \n    if(document.getElementById(\"filegtfDEF\").value != \"\")\n    {\n        fileGTF = document.getElementById(\"filegtfDEF\").value;\n    }\n    else {\n        fileGTF = document.getElementById(\"filegtf\").files[0];\n    }\n    \n    var fileIRGTF = document.getElementById(\"fileirgtf\").files[0];\n    \n    if(document.getElementById(\"fileirgtfDEF\").value != \"\")\n    {\n        fileIRGTF = document.getElementById(\"fileirgtfDEF\").value;\n    }\n    else {\n        fileIRGTF = document.getElementById(\"fileirgtf\").files[0];\n    }\n    \n    const prov = new Date;\n    var outputname = document.getElementById('outputname').value +\"_\"+prov.getDate()+\"-\"+(prov.getMonth()+1)+\"-\"+prov.getFullYear()+\"_\"+prov.getHours()+':'+prov.getMinutes()+':'+prov.getSeconds()+\".fasta\";\n    var flanking = document.getElementById('flanking').value\n    var zip = document.getElementById('zip').value\n\n    var formdata = new FormData();\n    formdata.append(\"filefasta\", fileFasta);\n    formdata.append(\"filegtf\", fileGTF);\n    formdata.append(\"fileirgtf\", fileIRGTF);\n    formdata.append(\"outputname\", outputname);\n    formdata.append(\"flanking\", flanking);\n    formdata.append(\"zip\", zip);\n    var ajax = new XMLHttpRequest();\n    ajax.upload.addEventListener(\"progress\", progressHandler, false);\n    ajax.addEventListener(\"load\", completeHandler, false);\n    ajax.addEventListener(\"error\", errorHandler, false);\n    ajax.addEventListener(\"abort\", abortHandler, false);\n    ajax.open(\"POST\", \"/process\");\n    ajax.send(formdata);\n}\n\nfunction progressHandler(event){\n    var percent = (event.loaded / event.total) * 100;\n    document.getElementById(\"progressBar\").value = Math.round(percent);\n    document.getElementById(\"status\").innerHTML = Math.round(percent)+\"% uploaded... please wait\";\n}\nfunction completeHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Done\";\n    document.getElementById(\"progressBar\").value = 0;\n}\nfunction errorHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Failed\";\n}\nfunction abortHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Aborted\";\n}\n</script>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":520,"y":560,"wires":[[]]},{"id":"2ee91fb8.1e79","type":"function","z":"add0bf2d.e6903","name":"","func":"var msg1 = { \n    payload: {\n        \"outputname\": msg.payload.outputname, \n        \"flanking\": msg.payload.flanking, \n        \"zip\": msg.payload.zip\n    }\n}\nreturn msg1;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2000,"y":480,"wires":[["1ae2eb9a.ea99a4"]]},{"id":"208c56cb.cd032a","type":"fs-ops-mkdir","z":"add0bf2d.e6903","name":"","path":"","pathType":"str","dirname":"extractFromCUFF","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":1440,"y":1120,"wires":[["a30c581.71541a8"]]},{"id":"a30c581.71541a8","type":"fs-ops-mkdir","z":"add0bf2d.e6903","name":"","path":"extractFromCUFF/","pathType":"str","dirname":"out","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":1640,"y":1120,"wires":[[]]},{"id":"6b905e82.ee20c","type":"fs-ops-mkdir","z":"add0bf2d.e6903","name":"","path":"","pathType":"str","dirname":"extractFromTopat","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":1440,"y":1280,"wires":[["e0f88e0.503697"]]},{"id":"e0f88e0.503697","type":"fs-ops-mkdir","z":"add0bf2d.e6903","name":"","path":"extractFromTopat/","pathType":"str","dirname":"out","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":1640,"y":1280,"wires":[[]]},{"id":"20ae0c55.8390c4","type":"change","z":"add0bf2d.e6903","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"Go\":\"refresh\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":200,"y":660,"wires":[["350fe610.b37eea","eaf9e5fe.c51108"]]},{"id":"350fe610.b37eea","type":"fs-ops-dir","z":"add0bf2d.e6903","name":"","path":"standardFiles","pathType":"str","filter":"*.gtf","filterType":"str","dir":"payload.gtf","dirType":"msg","x":360,"y":640,"wires":[["8993dead.41d15"]]},{"id":"eaf9e5fe.c51108","type":"fs-ops-dir","z":"add0bf2d.e6903","name":"","path":"standardFiles","pathType":"str","filter":"*.fasta","filterType":"str","dir":"payload.fasta","dirType":"msg","x":360,"y":680,"wires":[["8993dead.41d15"]]},{"id":"8993dead.41d15","type":"join","z":"add0bf2d.e6903","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":530,"y":660,"wires":[["2a10be7f.09bea2"]]},{"id":"b96594c4.c492f8","type":"function","z":"add0bf2d.e6903","name":"","func":"if(msg.payload.fasta.startsWith(\"standardFiles\")) {\n    msg.payload.fasta = null\n} else {\n    msg.payload.fasta = msg.payload.fasta.split(\"/\")[2]\n}\nif(msg.payload.tp.startsWith(\"standardFiles\")) {\n    msg.payload.tp = null\n} else {\n    msg.payload.tp = msg.payload.tp.split(\"/\")[2]\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2240,"y":760,"wires":[["50c145b2.a0480c","6622591f.a7d6f8"]]},{"id":"50c145b2.a0480c","type":"fs-ops-move","z":"add0bf2d.e6903","name":"","sourcePath":"extractFromTopat/out/","sourcePathType":"str","sourceFilename":"payload.fasta","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fasta","destFilenameType":"msg","link":false,"x":2440,"y":820,"wires":[[]]},{"id":"6622591f.a7d6f8","type":"fs-ops-move","z":"add0bf2d.e6903","name":"","sourcePath":"extractFromTopat/out/","sourcePathType":"str","sourceFilename":"payload.tp","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.tp","destFilenameType":"msg","link":false,"x":2420,"y":860,"wires":[[]]},{"id":"5ad309c8.a76308","type":"function","z":"add0bf2d.e6903","name":"","func":"if(msg.payload.fasta.startsWith(\"standardFiles\")) {\n    msg.payload.fasta = null\n} else {\n    msg.payload.fasta = msg.payload.fasta.split(\"/\")[2]\n}\nif(msg.payload.cuff.startsWith(\"standardFiles\")) {\n    msg.payload.cuff = null\n} else {\n    msg.payload.cuff = msg.payload.cuff.split(\"/\")[2]\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2320,"y":180,"wires":[["d2062e11.3e354","17a0c13f.d3a4af"]]},{"id":"d2062e11.3e354","type":"fs-ops-move","z":"add0bf2d.e6903","name":"","sourcePath":"extractFromCUFF/out/","sourcePathType":"str","sourceFilename":"payload.fasta","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fasta","destFilenameType":"msg","link":false,"x":2480,"y":80,"wires":[[]]},{"id":"17a0c13f.d3a4af","type":"fs-ops-move","z":"add0bf2d.e6903","name":"","sourcePath":"extractFromCUFF/out/","sourcePathType":"str","sourceFilename":"payload.cuff","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.cuff","destFilenameType":"msg","link":false,"x":2500,"y":140,"wires":[[]]},{"id":"5095196b.125908","type":"exec","z":"add0bf2d.e6903","command":"rm -rf \"extractFromCUFF\"","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"rmDir","x":1190,"y":1100,"wires":[[],[],["208c56cb.cd032a"]]},{"id":"b0aca77d.e06a28","type":"exec","z":"add0bf2d.e6903","command":"rm -rf \"outputProcess\"","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"rmDir","x":1190,"y":1180,"wires":[[],[],["b92e3743.b89d58"]]},{"id":"bf4ed318.78564","type":"exec","z":"add0bf2d.e6903","command":"rm -rf \"extractFromTopat\"","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"rmDir","x":1190,"y":1260,"wires":[[],[],["6b905e82.ee20c"]]},{"id":"2d438f51.6f20b","type":"delay","z":"add0bf2d.e6903","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":780,"y":480,"wires":[["f3780d1e.c31c8","eb21c545.a34408","2ee91fb8.1e79","f637bde7.c922b","42295bd8.15dcf4"]]},{"id":"d896d9cf.337188","type":"fs-ops-dir","z":"add0bf2d.e6903","name":"get list of files","path":"sourcePath","pathType":"msg","filter":"*","filterType":"str","dir":"payload","dirType":"msg","x":720,"y":160,"wires":[["7b8ba47a.35991c"]]},{"id":"9fc5cc60.0e8b","type":"change","z":"add0bf2d.e6903","name":"","rules":[{"t":"set","p":"sourcePath","pt":"msg","to":"outputProcess/out","tot":"str"},{"t":"set","p":"destinationPath","pt":"msg","to":"standardFiles","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":520,"y":160,"wires":[["d896d9cf.337188"]]},{"id":"7b8ba47a.35991c","type":"split","z":"add0bf2d.e6903","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":890,"y":160,"wires":[["aeaf9d93.8e531"]]},{"id":"57be1368.8854dc","type":"ui_button","z":"add0bf2d.e6903","name":"","group":"b6b24a48.ac4c28","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":220,"y":120,"wires":[["9fc5cc60.0e8b","8f9433d8.9daa8"]]},{"id":"308f3c3a.44ab14","type":"ui_button","z":"add0bf2d.e6903","name":"","group":"9b368654.c443b8","order":3,"width":8,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":220,"y":180,"wires":[["9fc5cc60.0e8b","8f9433d8.9daa8"]]},{"id":"aeaf9d93.8e531","type":"fs-ops-move","z":"add0bf2d.e6903","name":"","sourcePath":"sourcePath","sourcePathType":"msg","sourceFilename":"payload","sourceFilenameType":"msg","destPath":"destinationPath","destPathType":"msg","destFilename":"payload","destFilenameType":"msg","link":false,"x":960,"y":260,"wires":[[]]},{"id":"6087391.d6400c8","type":"tab","label":"Python","disabled":false,"info":""},{"id":"3ba7b825.d052b8","type":"ui_template","z":"6087391.d6400c8","group":"b9639dff.66bf1","name":"Data-table","order":2,"width":18,"height":14,"format":"<html>\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<link href=\"https://fonts.googleapis.com/css?family=Raleway\" rel=\"stylesheet\">\n<style>\n * {\n  box-sizing: border-box;\n}\n\nbody {\n  background-color: #f1f1f1;\n}\n\n#upload_form {\n  background-color: #ffffff;\n  margin: 100px auto;\n  font-family: Raleway;\n  padding: 40px;\n  width: 70%;\n  min-width: 300px;\n}\n\nh1 {\n  text-align: center;  \n}\n\ninput {\n  padding: 10px;\n  width: 100%;\n  font-size: 17px;\n  font-family: Raleway;\n  border: 1px solid #aaaaaa;\n}\n\nbutton {\n  background-color: #4CAF50;\n  color: #ffffff;\n  border: none;\n  padding: 10px 20px;\n  font-size: 17px;\n  font-family: Raleway;\n  cursor: pointer;\n}\n\nbutton:hover {\n  opacity: 0.8;\n}\n </style>\n <body>\n\n <form id=\"upload_form\" method=\"post\" enctype=\"multipart/form-data\">\n  <h1>Intron Classification Model</h1>\n  <!-- One \"tab\" for each step in the form: -->\n  <div class=\"tab\">Excel File:\n    <p><input id=\"fileexcel\" type=\"file\" name=\"fileexcel\" accept=\".xlsx\"></p>\n    <p><label for=\"fileexcelDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label><br>\n    <select id=\"fileexcelDEF\" name=\"fileexcelDEF\">\n    <option value=\"\">Nessun File</option>\n    <option ng-repeat=\"obj in msg.payload\" value=\"{{obj}}\">{{ obj }}</option>\n    </select></p>\n  </div>\n  \n  <div style=\"overflow:auto;\">\n    <div style=\"float:right;\">\n      <button type=\"button\" id=\"start\" onclick=\"uploadFile()\">Start</button>\n    </div>\n  </div>\n  \n  <div style=\"text-align:center;margin-top:40px;\">\n      <progress id=\"progressBar\" value=\"0\" max=\"100\" style=\"width:300px;\"></progress>\n        <p id=\"status\"></p>\n  </div>\n</form>\n    <script>\n    function _(el){\n    return document.getElementById(el);\n}\nfunction uploadFile(){\n    var fileFasta;\n    if(document.getElementById(\"fileexcelDEF\").value != \"\")\n    {\n        fileFasta = document.getElementById(\"fileexcelDEF\").value;\n    }\n    else {\n        fileFasta = document.getElementById(\"fileexcel\").files[0];\n    }\n\n    var formdata = new FormData();\n    formdata.append(\"fileexcel\", fileFasta);\n    var ajax = new XMLHttpRequest();\n    ajax.upload.addEventListener(\"progress\", progressHandler, false);\n    ajax.addEventListener(\"load\", completeHandler, false);\n    ajax.addEventListener(\"error\", errorHandler, false);\n    ajax.addEventListener(\"abort\", abortHandler, false);\n    ajax.open(\"POST\", \"/python\");\n    ajax.send(formdata);\n}\nfunction progressHandler(event){\n    var percent = (event.loaded / event.total) * 100;\n    _(\"progressBar\").value = Math.round(percent);\n    _(\"status\").innerHTML = Math.round(percent)+\"% uploaded... please wait\";\n}\nfunction completeHandler(event){\n    _(\"status\").innerHTML = \"Upload Done\";\n    _(\"progressBar\").value = 0;\n}\nfunction errorHandler(event){\n    _(\"status\").innerHTML = \"Upload Failed\";\n}\nfunction abortHandler(event){\n    _(\"status\").innerHTML = \"Upload Aborted\";\n}\n</script>\n</body>\n</html>","storeOutMessages":false,"fwdInMessages":false,"resendOnRefresh":false,"templateScope":"local","x":390,"y":500,"wires":[[]]},{"id":"59b04090.b4ebf","type":"http in","z":"6087391.d6400c8","name":"","url":"/python","method":"post","upload":true,"swaggerDoc":"","x":130,"y":180,"wires":[["3cf698be.85ab88","3947563e.ba6fea","b3abae18.b0863","9b885661.1be178"]]},{"id":"3cf698be.85ab88","type":"function","z":"6087391.d6400c8","name":"","func":"//msg.name = msg.req.files[0].originalname;\n//global.set(\"name\",msg.req.files[0].originalname);\nif(msg.req.files.length == 1) {\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"python/\" + msg.req.files[0].originalname\n\n    return [msg,null];\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":340,"y":220,"wires":[["1b4806fd.0290e9"]]},{"id":"1b4806fd.0290e9","type":"file","z":"6087391.d6400c8","name":"","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":470,"y":220,"wires":[["4a24aed1.0db98"]]},{"id":"3947563e.ba6fea","type":"function","z":"6087391.d6400c8","name":"","func":"//global.set(\"name\",msg.payload.outputname);\nif(msg.req.files.length == 1) {\n    msg.payload = {path:(\"python/\" + msg.req.files[0].originalname)}\n}\nelse {\n    msg.payload = {path: (\"standardFiles/\" + msg.payload.fileexcel)}\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":460,"y":100,"wires":[["be44b39a.90a0f"]]},{"id":"4a24aed1.0db98","type":"function","z":"6087391.d6400c8","name":"","func":"msg.payload = {upload:\"yes\"}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":600,"y":220,"wires":[["be44b39a.90a0f"]]},{"id":"be44b39a.90a0f","type":"join","z":"6087391.d6400c8","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":730,"y":180,"wires":[["973ac83f.52d148","23b1efe1.042c6"]]},{"id":"360b3985.a0b266","type":"python-function","z":"6087391.d6400c8","name":"","func":"import pandas as pd\nfrom sklearn.decomposition import PCA\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom sklearn.model_selection import train_test_split\nimport json\n\n\npy_obj =json.dumps(msg)\nresp = json.loads(py_obj)\npath = resp['payload']\n\n#import the dataset\ndata=pd.read_excel(path)\nX=data.iloc[:,1:6] #11:20 senza phi\nY=data.iloc[:,0]\nY=np.ravel(Y)\ntrain_X, test_X, train_y, test_y = train_test_split(X, Y, random_state=1, stratify=Y)\nfrom sklearn.ensemble import AdaBoostClassifier\nfrom sklearn.tree import DecisionTreeClassifier, ExtraTreeClassifier\nfrom sklearn.linear_model import LogisticRegression\n#from sklearn.svm import SVC\nfrom sklearn.metrics import confusion_matrix, classification_report\n#we construct and fit our model to the training set\n##max_depth tells our model the structure of our trees\n##n_estimators specifies the total number of trees in the forest\n\n##DecisionTreeClassifier estimator \nclassifier = AdaBoostClassifier(\n    DecisionTreeClassifier(max_depth=2),\n    n_estimators=500, random_state=0,learning_rate=0.6,\n    algorithm=\"SAMME.R\")\n\n#classifier = AdaBoostClassifier(\n#SVC(probability=True , kernel='rbf'),\n#n_estimators=1000, random_state=0,learning_rate=0.6,\n#algorithm=\"SAMME.R\")\n\n####Support Vector Classification \n##with kernel rbf]]]\n#from sklearn.svm import SVC\n#svclassifier = SVC(kernel='rbf')\n#svclassifier.fit(train_X, train_y)\n#y_pred = svclassifier.predict(test_X)\n#from sklearn.metrics import classification_report\n#print(confusion_matrix(test_y,y_pred))\n#print(classification_report(test_y,y_pred))\n\n####LogisticRegression estimator \n#classifier = AdaBoostClassifier(\n#    LogisticRegression())\n\n####ExtraTreeClassifier estimator \n#classifier = AdaBoostClassifier(\n#   ExtraTreeClassifier())\n\n####SVC estimator\n#classifier = AdaBoostClassifier(\n# SVC(probability=True , kernel='linear'))\n\n####Undefined estimator, which corresponds to a decision stump, i.e.,\n#### a decision tree with max_depth=1 with a single decision node and two leaves\n#classifier = AdaBoostClassifier()\n\n#we fit our model to the training set\nclassifier.fit(train_X, train_y)\n#we use our model to make predictions\npredictions = classifier.predict(test_X)\n#probability predictions used to compute the ROC curve\npredictions_proba= classifier.predict_proba(test_X)\n#we compute the confusion matrix \nmatrix_adaboost=confusion_matrix(test_y, predictions)\nprint(matrix_adaboost)\n#we compute precision, recall, f1 score\nmsg = classification_report(test_y,predictions)\n#ROC curve\n#import scikitplot\n#scikitplot.metrics.plot_roc(test_y,predictions_proba,plot_micro=False,plot_macro=False)\n#DF = np.c_[X,Y]\n#import seaborn as sns\n#sns.pairplot(DF, hue=\"labels\")\n\n\nreturn msg","outputs":1,"x":1120,"y":180,"wires":[["a584592c.570238"]]},{"id":"973ac83f.52d148","type":"function","z":"6087391.d6400c8","name":"","func":"var path = msg.payload.path\nmsg.payload = path\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":180,"wires":[["360b3985.a0b266"]]},{"id":"28a32113.fc5cfe","type":"ui_text","z":"6087391.d6400c8","group":"8710f5f1.856a38","order":2,"width":18,"height":6,"name":"","label":"","format":"{{msg.payload.out}}","layout":"col-center","x":1470,"y":40,"wires":[]},{"id":"b3abae18.b0863","type":"function","z":"6087391.d6400c8","name":"Output_group","func":"msg = {};\nmsg.payload = { group: {\n    show : [\"Python_Output\"],\n    hide : [\"Python_Form\"]\n}\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":340,"y":280,"wires":[["21950776.19f698"]]},{"id":"21950776.19f698","type":"ui_ui_control","z":"6087391.d6400c8","name":"Go to Group","events":"all","x":530,"y":360,"wires":[[]]},{"id":"3c40324.f202ace","type":"ui_ui_control","z":"6087391.d6400c8","name":"Refresh page restore","events":"all","x":120,"y":320,"wires":[["3e2dec39.bbc494","a93740b5.716e1"]]},{"id":"3e2dec39.bbc494","type":"function","z":"6087391.d6400c8","name":"","func":"if(msg.payload == \"connect\" || msg.payload == \"change\") {\n    msg.payload = { group: {\n    show : [\"Python_Form\"],\n    hide : [\"Python_Output\"]\n}\n};\n    return msg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":140,"y":380,"wires":[["e57ee68.6de7118"]]},{"id":"e57ee68.6de7118","type":"ui_ui_control","z":"6087391.d6400c8","name":"","events":"all","x":140,"y":440,"wires":[[]]},{"id":"a584592c.570238","type":"function","z":"6087391.d6400c8","name":"","func":"var str = msg\nmsg = {payload: {out:str}}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1300,"y":180,"wires":[["28a32113.fc5cfe","23b1efe1.042c6"]]},{"id":"9b885661.1be178","type":"function","z":"6087391.d6400c8","name":"","func":"msg.payload.out = \"Process in execution... Please wait.\"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":460,"y":40,"wires":[["28a32113.fc5cfe"]]},{"id":"a93740b5.716e1","type":"fs-ops-dir","z":"6087391.d6400c8","name":"","path":"standardFiles","pathType":"str","filter":"*.xl*","filterType":"str","dir":"payload","dirType":"msg","x":380,"y":440,"wires":[["3ba7b825.d052b8"]]},{"id":"e75cca9b.8d8668","type":"function","z":"6087391.d6400c8","name":"","func":"if(msg.payload.path.startsWith(\"standardFiles\")) {\n    msg.payload.path = \"\"\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1280,"y":260,"wires":[["ba0fa0e6.152f7"]]},{"id":"ba0fa0e6.152f7","type":"fs-ops-delete","z":"6087391.d6400c8","name":"","path":"","pathType":"str","filename":"payload.path","filenameType":"msg","x":1390,"y":360,"wires":[[]]},{"id":"23b1efe1.042c6","type":"join","z":"6087391.d6400c8","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1090,"y":260,"wires":[["e75cca9b.8d8668"]]},{"id":"3520573e.bc7c78","type":"tab","label":"Create-Dataset","disabled":false,"info":""},{"id":"cacd77e9.b80188","type":"ui_template","z":"3520573e.bc7c78","group":"6955ba29.31b9a4","name":"","order":1,"width":18,"height":12,"format":"<!DOCTYPE html>\n<html>\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<link href=\"https://fonts.googleapis.com/css?family=Raleway\" rel=\"stylesheet\">\n<style>\n* {\n  box-sizing: border-box;\n}\n\nbody {\n  background-color: #f1f1f1;\n}\n\n#regForm {\n  background-color: #ffffff;\n  margin: 100px auto;\n  font-family: Raleway;\n  padding: 40px;\n  width: 70%;\n  min-width: 300px;\n}\n\nh1 {\n  text-align: center;  \n}\n\ninput {\n  padding: 10px;\n  width: 100%;\n  font-size: 17px;\n  font-family: Raleway;\n  border: 1px solid #aaaaaa;\n}\n\n/* Mark input boxes that gets an error on validation: */\ninput.invalid {\n  background-color: #ffdddd;\n}\n\n/* Hide all steps by default: */\n.tab {\n  display: none;\n}\n\nbutton {\n  background-color: #4CAF50;\n  color: #ffffff;\n  border: none;\n  padding: 10px 20px;\n  font-size: 17px;\n  font-family: Raleway;\n  cursor: pointer;\n}\n\nbutton:hover {\n  opacity: 0.8;\n}\n\n#prevBtn {\n  background-color: #bbbbbb;\n}\n\n/* Make circles that indicate the steps of the form: */\n.step {\n  height: 15px;\n  width: 15px;\n  margin: 0 2px;\n  background-color: #bbbbbb;\n  border: none;  \n  border-radius: 50%;\n  display: inline-block;\n  opacity: 0.5;\n}\n\n.step.active {\n  opacity: 1;\n}\n\n/* Mark the steps that are finished and valid: */\n.step.finish {\n  background-color: #4CAF50;\n}\n</style>\n<body>\n\n<form id=\"regForm\" action=\"/createdataset\" method=\"post\" enctype=\"multipart/form-data\">\n  <h1>Create Dateset Feature</h1>\n  <!-- One \"tab\" for each step in the form: -->\n  <div class=\"tab\">Introni retenuti Fasta:\n    <p><input placeholder=\"Fasta File\" id=\"fileirf\" type=\"file\" name=\"fileirf\"  accept=\".fasta\" oninput=\"this.className = ''\"></p>\n    <p><label for=\"fileirfDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label><br>\n    <select id=\"fileirfDEF\" name=\"fileirfDEF\">\n    <option value=\"\">Nessun File</option>\n    <option ng-repeat=\"obj in msg.payload.fasta\" value=\"{{obj}}\">{{ obj }}</option>\n    </select></p>\n  </div>\n  <div class=\"tab\">Introni non retenuti Fasta:\n    <p><input placeholder=\"Fasta File\" id=\"fileinrf\" type=\"file\" name=\"fileinrf\" oninput=\"this.className = ''\" accept=\".fasta\"></p>\n    <p><label for=\"fileinrfDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label><br>\n    <select id=\"fileinrfDEF\" name=\"fileinrfDEF\">\n    <option value=\"\">Nessun File</option>\n    <option ng-repeat=\"obj in msg.payload.fasta\" value=\"{{obj}}\">{{ obj }}</option>\n    </select></p>\n  </div>\n  <div class=\"tab\">Introni retenuti Dot:\n    <p><input placeholder=\"Dot File\" id=\"fileird\" type=\"file\" name=\"fileird\" class=\"auto-style1\" accept=\".dot\" oninput=\"this.className = ''\"></p>\n    <p><label for=\"fileirdDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label><br>\n    <select id=\"fileirdDEF\" name=\"fileirdDEF\">\n    <option value=\"\">Nessun File</option>\n    <option ng-repeat=\"obj in msg.payload.dot\" value=\"{{obj}}\">{{ obj }}</option>\n    </select></p>\n    Introni non retenuti Dot:\n    <p><input placeholder=\"Dot File\" id=\"fileinrd\" type=\"file\" name=\"fileinrd\" class=\"auto-style1\" accept=\".dot\" oninput=\"this.className = ''\"></p>\n    <p><label for=\"fileinrdDEF\">You can choose one default file: (IF UPLOAD YOUR FILE select \"Nessun File\")</label><br>\n    <select id=\"fileinrdDEF\" name=\"fileinrdDEF\">\n    <option value=\"\">Nessun File</option>\n    <option ng-repeat=\"obj in msg.payload.dot\" value=\"{{obj}}\">{{ obj }}</option>\n    </select></p>\n  </div>\n  <div class=\"tab\">Insert output options:\n  <p><label for=\"pNu\">pNu:</label>\n      <select id=\"pNu\" name=\"pNu\">\n          <option value=\"yes\">YES</option>\n          <option value=\"no\">NO</option>\n          </select> </p>\n    <p><label for=\"kMir\">kMir:</label>\n      <select id=\"kMir\" name=\"kMir\">\n          <option value=\"yes\">YES</option>\n          <option value=\"no\">NO</option>\n          </select> </p>\n    <p><label for=\"eNt\">eNt:</label>\n      <select id=\"eNt\" name=\"eNt\">\n          <option value=\"yes\">YES</option>\n          <option value=\"no\">NO</option>\n          </select></p>\n    <p><input placeholder=\"nf\" oninput=\"this.className = ''\" name=\"nf\" id=\"nf\"></p>\n    <p><input placeholder=\"ni\" name=\"ni\" id=\"ni\"></p>\n    <p><input placeholder=\"nni\" name=\"nni\" id=\"nni\"></p>\n  </div>\n  <div style=\"overflow:auto;\">\n    <div style=\"float:right;\">\n      <button type=\"button\" id=\"prevBtn\" onclick=\"nextPrev(-1)\">Previous</button>\n      <button type=\"button\" id=\"nextBtn\" onclick=\"nextPrev(1)\">Next</button>\n    </div>\n  </div>\n  <!-- Circles which indicates the steps of the form: -->\n  <div style=\"text-align:center;margin-top:40px;\">\n    <span class=\"step\"></span>\n    <span class=\"step\"></span>\n    <span class=\"step\"></span>\n    <span class=\"step\"></span>\n  </div>\n  \n  <div style=\"text-align:center;margin-top:40px;\">\n      <progress id=\"progressBar\" value=\"0\" max=\"100\" style=\"width:300px;\"></progress>\n        <p id=\"status\"></p>\n  </div>\n</form>\n\n<script>\nvar currentTab = 0; // Current tab is set to be the first tab (0)\nshowTab(currentTab); // Display the current tab\n\nfunction showTab(n) {\n    document.getElementById(\"progressBar\").style.display = \"none\";\n  // This function will display the specified tab of the form...\n  var x = document.getElementsByClassName(\"tab\");\n  x[n].style.display = \"block\";\n  //... and fix the Previous/Next buttons:\n  if (n == 0) {\n    document.getElementById(\"prevBtn\").style.display = \"none\";\n  } else {\n    document.getElementById(\"prevBtn\").style.display = \"inline\";\n  }\n  if (n == (x.length - 1)) {\n    document.getElementById(\"nextBtn\").innerHTML = \"Submit\";\n  } else {\n    document.getElementById(\"nextBtn\").innerHTML = \"Next\";\n  }\n  //... and run a function that will display the correct step indicator:\n  fixStepIndicator(n)\n}\n\nfunction nextPrev(n) {\n  // This function will figure out which tab to display\n  var x = document.getElementsByClassName(\"tab\");\n  // Exit the function if any field in the current tab is invalid:\n  if (n == 1 && !validateForm()) return false;\n  // Hide the current tab:\n  x[currentTab].style.display = \"none\";\n  // Increase or decrease the current tab by 1:\n  currentTab = currentTab + n;\n  // if you have reached the end of the form...\n  if (currentTab >= x.length) {\n    // ... the form gets submitted:\n    //document.getElementById(\"regForm\").submit();\n     document.getElementById(\"progressBar\").style.display = \"inline\";\n    document.getElementById(\"prevBtn\").style.display = \"none\";\n    document.getElementById(\"nextBtn\").style.display = \"none\";\n    document.getElementById(\"status\").style.display = \"none\";\n    document.getElementById(\"progressBar\").style.display = \"none\";\n    uploadFile();\n    return false;\n  }\n  // Otherwise, display the correct tab:\n  showTab(currentTab);\n}\n\nfunction validateForm() {\n  // This function deals with validation of the form fields\n  var x, y, i, valid = true;\n  x = document.getElementsByClassName(\"tab\");\n  y = x[currentTab].getElementsByTagName(\"input\");\n  // A loop that checks every input field in the current tab:\n  for (i = 0; i < y.length; i++) {\n    // If a field is empty...\n    if (y[i].value == \"\" && (y[i].name == \"fileirf\" || y[i].name == \"fileinrf\")) {\n        if( y[i].name == \"fileirf\" && document.getElementById(\"fileirfDEF\").value == \"\") {\n        // add an \"invalid\" class to the field:\n        y[i].className += \" invalid\";\n        valid = false;\n        // and set the current valid status to false\n        }\n        if( y[i].name == \"fileinrf\" && document.getElementById(\"fileinrfDEF\").value == \"\") {\n        // add an \"invalid\" class to the field:\n        y[i].className += \" invalid\";\n        valid = false;\n        // and set the current valid status to false\n        }\n    }\n  }\n  // If the valid status is true, mark the step as finished and valid:\n  if (valid) {\n    document.getElementsByClassName(\"step\")[currentTab].className += \" finish\";\n  }\n  return valid; // return the valid status\n}\n\nfunction fixStepIndicator(n) {\n  // This function removes the \"active\" class of all steps...\n  var i, x = document.getElementsByClassName(\"step\");\n  for (i = 0; i < x.length; i++) {\n    x[i].className = x[i].className.replace(\" active\", \"\");\n  }\n  //... and adds the \"active\" class on the current step:\n  x[n].className += \" active\";\n}\n\nfunction uploadFile(){\n    var fileirf\n    if(document.getElementById(\"fileirfDEF\").value != \"\")\n    {\n        fileirf = document.getElementById(\"fileirfDEF\").value;\n    }\n    else {\n        fileirf = document.getElementById(\"fileirf\").files[0];\n    }\n    \n    var fileinrf\n    if(document.getElementById(\"fileinrfDEF\").value != \"\")\n    {\n        fileinrf = document.getElementById(\"fileinrfDEF\").value;\n    }\n    else {\n        fileinrf = document.getElementById(\"fileinrf\").files[0];\n    }\n    \n    var fileird\n    \n    if(document.getElementById(\"fileirdDEF\").value != \"\")\n    {\n        fileird = document.getElementById(\"fileirdDEF\").value;\n    }\n    else {\n        fileird = document.getElementById(\"fileird\").files[0];\n    }\n    \n    var fileinrd \n    \n    if(document.getElementById(\"fileinrdDEF\").value != \"\")\n    {\n        fileinrd = document.getElementById(\"fileinrdDEF\").value;\n    }\n    else {\n        fileinrd = document.getElementById(\"fileinrd\").files[0];\n    }\n    \n    var pNu = document.getElementById(\"pNu\").value;\n    var kMir = document.getElementById(\"kMir\").value;\n    var nf = document.getElementById(\"nf\").value;\n    var eNt = document.getElementById(\"eNt\").value;\n    var ni = document.getElementById(\"ni\").value;\n    var nni = document.getElementById(\"nni\").value;\n\n    var formdata = new FormData();\n    formdata.append(\"fileirf\", fileirf);\n    formdata.append(\"fileinrf\", fileinrf);\n    formdata.append(\"fileird\", fileird);\n    formdata.append(\"fileinrd\", fileinrd);\n    formdata.append(\"pNu\", pNu);\n    formdata.append(\"kMir\", kMir);\n    formdata.append(\"nf\", nf);\n    formdata.append(\"eNt\", eNt);\n    formdata.append(\"ni\", ni);\n    formdata.append(\"nni\", nni);\n    \n    var ajax = new XMLHttpRequest();\n    ajax.upload.addEventListener(\"progress\", progressHandler, false);\n    ajax.addEventListener(\"load\", completeHandler, false);\n    ajax.addEventListener(\"error\", errorHandler, false);\n    ajax.addEventListener(\"abort\", abortHandler, false);\n    ajax.open(\"POST\", \"/createdataset\");\n    ajax.send(formdata);\n}\n\nfunction progressHandler(event){\n    var percent = (event.loaded / event.total) * 100;\n    document.getElementById(\"progressBar\").value = Math.round(percent);\n    document.getElementById(\"status\").innerHTML = Math.round(percent)+\"% uploaded... please wait\";\n}\nfunction completeHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Done\";\n    document.getElementById(\"progressBar\").value = 0;\n}\nfunction errorHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Failed\";\n}\nfunction abortHandler(event){\n    document.getElementById(\"status\").innerHTML = \"Upload Aborted\";\n}\n</script>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":700,"y":700,"wires":[[]]},{"id":"3450b2ca.f726ee","type":"function","z":"3520573e.bc7c78","name":"","func":"msg.payload = {\n    f1:\"done\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":680,"y":300,"wires":[["a2c36aa0.eddf68"]]},{"id":"c69ee870.400538","type":"http in","z":"3520573e.bc7c78","name":"","url":"/createdataset","method":"post","upload":true,"swaggerDoc":"","x":170,"y":380,"wires":[["f157ec07.4247e","68d7d1f5.2d24c"]]},{"id":"f157ec07.4247e","type":"function","z":"3520573e.bc7c78","name":"","func":"var msg1,msg2,msg3\n\nif(msg.req.files.length == 1) {\nmsg.payload = msg.req.files[0].buffer\nmsg.filename = \"createDataset/\" + msg.req.files[0].originalname\n\nreturn [msg,null,null,null];\n}\nelse if(msg.req.files.length == 2) {\nmsg1 = { payload: msg.req.files[1].buffer, filename: \"createDataset/\" + msg.req.files[1].originalname};\nmsg.payload = msg.req.files[0].buffer\nmsg.filename = \"createDataset/\" + msg.req.files[0].originalname\n\nreturn [msg,msg1,null,null];\n}\nelse if(msg.req.files.length == 3){\n    msg1 = { payload: msg.req.files[1].buffer, filename: \"createDataset/\" + msg.req.files[1].originalname};\n    msg2 = { payload: msg.req.files[2].buffer, filename: \"createDataset/\" + msg.req.files[2].originalname};\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"createDataset/\" + msg.req.files[0].originalname\n    \n    return [msg,msg1,msg2,null];\n}\nelse if(msg.req.files.length == 4){\n    msg1 = { payload: msg.req.files[1].buffer, filename: \"createDataset/\" + msg.req.files[1].originalname};\n    msg2 = { payload: msg.req.files[2].buffer, filename: \"createDataset/\" + msg.req.files[2].originalname};\n    msg3 = { payload: msg.req.files[3].buffer, filename: \"createDataset/\" + msg.req.files[3].originalname};\n    msg.payload = msg.req.files[0].buffer\n    msg.filename = \"createDataset/\" + msg.req.files[0].originalname\n    \n    return [msg,msg1,msg2,msg3];\n}","outputs":4,"noerr":0,"initialize":"","finalize":"","x":380,"y":380,"wires":[["8c1f5b4.b3883a8"],["2048542f.e24eac"],["c414644f.619848"],["25d81726.178dc8"]]},{"id":"2048542f.e24eac","type":"file","z":"3520573e.bc7c78","name":"fasta2","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":550,"y":360,"wires":[["9a5c9366.0ff0e"]]},{"id":"8c1f5b4.b3883a8","type":"file","z":"3520573e.bc7c78","name":"fasta","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":550,"y":300,"wires":[["3450b2ca.f726ee"]]},{"id":"9a5c9366.0ff0e","type":"function","z":"3520573e.bc7c78","name":"","func":"msg.payload = {\n    f2:\"done\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":680,"y":360,"wires":[["a2c36aa0.eddf68"]]},{"id":"68d7d1f5.2d24c","type":"function","z":"3520573e.bc7c78","name":"","func":"if(msg.payload.fileird == \"undefined\" || msg.payload.fileinrd == \"undefined\")\n{\n    msg.payload.fileird = \"\"\n    msg.payload.fileinrd = \"\"\n} else {\n    msg.payload.fileird = \"standardFiles/\" + msg.payload.fileird\n    msg.payload.fileinrd = \"standardFiles/\" +msg.payload.fileinrd\n}\n\nif(msg.req.files.length == 2 && (msg.req.files[0].fieldname == \"fileirf\" && msg.req.files[1].fieldname == \"fileinrf\")) {\n    msg.payload.fileirf = \"createDataset/\" + msg.req.files[0].originalname\n    msg.payload.fileinrf = \"createDataset/\" + msg.req.files[1].originalname\n    msg.payload.fileird = msg.payload.fileird\n    msg.payload.fileinrd = msg.payload.fileinrd\n    msg.payload.pathfolder = \"createDataset/out\"\n    return msg;\n}\nelse if (msg.req.files.length == 2 && (msg.req.files[0].fieldname == \"fileird\" && msg.req.files[1].fieldname == \"fileinrd\")) {\n    msg.payload.fileird = \"createDataset/\" + msg.req.files[0].originalname\n    msg.payload.fileinrd = \"createDataset/\" + msg.req.files[1].originalname\n    msg.payload.fileirf = \"standardFiles/\" + msg.payload.fileirf\n    msg.payload.fileinrf = \"standardFiles/\" + msg.payload.fileinrf\n    msg.payload.pathfolder = \"createDataset/out\"\n    return msg;\n}\nelse if (msg.req.files.length == 2 && ((msg.req.files[0].fieldname == \"fileirf\" || msg.req.files[0].fieldname == \"fileinrf\")&&(msg.req.files[1].fieldname == \"fileird\" || msg.req.files[1].fieldname == \"fileinrd\"))){\n    if(msg.req.files[0].fieldname == \"fileirf\") {\n        msg.payload.fileirf = \"createDataset/\" + msg.req.files[0].originalname\n        msg.payload.fileinrf = \"standardFiles/\" + msg.payload.fileinrf\n        msg.payload.fileird = msg.payload.fileird\n        msg.payload.fileinrd = msg.payload.fileinrd\n        msg.payload.pathfolder = \"createDataset/out\"\n        return msg;\n    }\n    else if (msg.req.files[0].fieldname == \"fileinrf\") {\n        msg.payload.fileirf = \"standardFiles/\" + msg.payload.fileirf\n        msg.payload.fileinrf = \"createDataset/\" + msg.req.files[0].originalname\n        msg.payload.fileird = msg.payload.fileird\n        msg.payload.fileinrd = msg.payload.fileinrd\n        msg.payload.pathfolder = \"createDataset/out\"\n        return msg;\n    }\n}\nelse if (msg.req.files.length == 1) {\n    if(msg.req.files[0].fieldname == \"fileirf\") {\n        msg.payload.fileirf = \"createDataset/\" + msg.req.files[0].originalname\n        msg.payload.fileinrf = \"standardFiles/\" + msg.payload.fileinrf\n        msg.payload.fileird = msg.payload.fileird\n        msg.payload.fileinrd = msg.payload.fileinrd\n        msg.payload.pathfolder = \"createDataset/out\"\n        return msg;\n    }\n    else if (msg.req.files[0].fieldname == \"fileinrf\") {\n        msg.payload.fileirf = \"standardFiles/\" + msg.payload.fileirf\n        msg.payload.fileinrf = \"createDataset/\" + msg.req.files[0].originalname\n        msg.payload.fileird = msg.payload.fileird\n        msg.payload.fileinrd = msg.payload.fileinrd\n        msg.payload.pathfolder = \"createDataset/out\"\n        return msg;\n    }\n    else{\n        msg.payload.fileirf = \"standardFiles/\" + msg.payload.fileirf\n        msg.payload.fileinrf = \"standardFiles/\" + msg.payload.fileinrf\n        msg.payload.fileird = msg.payload.fileird\n        msg.payload.fileinrd = msg.payload.fileinrd\n        msg.payload.pathfolder = \"createDataset/out\"\n        return msg;\n    }\n    \n}\nelse if (msg.req.files.length == 4){\n    msg.payload.fileirf = \"createDataset/\" + msg.req.files[0].originalname\n    msg.payload.fileinrf = \"createDataset/\" + msg.req.files[1].originalname\n    msg.payload.fileird = \"createDataset/\" + msg.req.files[2].originalname\n    msg.payload.fileinrd = \"createDataset/\" + msg.req.files[3].originalname\n    msg.payload.pathfolder = \"createDataset/out\"\n    return msg;\n}\nelse if (msg.req.files.length == 3) {\n    if(msg.req.files[1].fieldname == \"fileird\") {\n        if(msg.req.files[0].fieldname == \"fileirf\") {\n            msg.payload.fileirf = \"createDataset/\" + msg.req.files[0].originalname\n            msg.payload.fileinrf = \"standardFiles/\" + msg.payload.fileinrf\n            msg.payload.fileird = \"createDataset/\" + msg.req.files[1].originalname\n            msg.payload.fileinrd = \"createDataset/\" + msg.req.files[2].originalname\n            msg.payload.pathfolder = \"createDataset/out\"\n            return msg;\n        }\n        else if (msg.req.files[0].fieldname == \"fileinrf\") {\n            msg.payload.fileirf = \"standardFiles/\" + msg.payload.fileirf\n            msg.payload.fileinrf = \"createDataset/\" + msg.req.files[0].originalname\n            msg.payload.fileird = \"createDataset/\" + msg.req.files[1].originalname\n            msg.payload.fileinrd = \"createDataset/\" + msg.req.files[2].originalname\n            msg.payload.pathfolder = \"createDataset/out\"\n            return msg;\n        }\n    }\n    else {\n        msg.payload.fileirf = \"createDataset/\" + msg.req.files[0].originalname\n        msg.payload.fileinrf = \"createDataset/\" + msg.req.files[1].originalname\n        msg.payload.fileird = msg.payload.fileird\n        msg.payload.fileinrd = msg.payload.fileinrd\n        msg.payload.pathfolder = \"createDataset/out\"\n        return msg;\n    }\n}\nelse {\n        msg.payload.fileirf = \"standardFiles/\" + msg.payload.fileirf\n        msg.payload.fileinrf = \"standardFiles/\" + msg.payload.fileinrf\n        msg.payload.fileird = msg.payload.fileird\n        msg.payload.fileinrd = msg.payload.fileinrd\n        msg.payload.pathfolder = \"createDataset/out\"\n        return msg;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":540,"y":220,"wires":[["a2c36aa0.eddf68"]]},{"id":"a2c36aa0.eddf68","type":"join","z":"3520573e.bc7c78","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"11","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":930,"y":320,"wires":[["c65ed4f8.666828","af410388.903e1"]]},{"id":"c65ed4f8.666828","type":"create_dateset_feature","z":"3520573e.bc7c78","name":"","fileirf":"","fileinrf":"","fileird":"","fileinrd":"","pathfolder":"","pNu":"","kMir":"","nf":"","eNt":"","ni":"","nni":"","x":1150,"y":320,"wires":[["785ab925.6e4318","bcf03e29.23036"]]},{"id":"25d81726.178dc8","type":"file","z":"3520573e.bc7c78","name":"dot2","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":550,"y":500,"wires":[["8c9e44db.17f078"]]},{"id":"c414644f.619848","type":"file","z":"3520573e.bc7c78","name":"dot","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":550,"y":420,"wires":[["97baa1be.c98ff"]]},{"id":"8c9e44db.17f078","type":"function","z":"3520573e.bc7c78","name":"","func":"msg.payload = {\n    d2:\"done\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":680,"y":500,"wires":[["a2c36aa0.eddf68"]]},{"id":"97baa1be.c98ff","type":"function","z":"3520573e.bc7c78","name":"","func":"msg.payload = {\n    d1:\"done\"\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":680,"y":420,"wires":[["a2c36aa0.eddf68"]]},{"id":"17b36a1a.175226","type":"fs-ops-mkdir","z":"3520573e.bc7c78","name":"","path":"createDataset/","pathType":"str","dirname":"out","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":520,"y":800,"wires":[[]]},{"id":"fd9ae8fb.292bc8","type":"fs-ops-mkdir","z":"3520573e.bc7c78","name":"","path":"","pathType":"str","dirname":"createDataset","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":500,"y":860,"wires":[["17b36a1a.175226"]]},{"id":"785ab925.6e4318","type":"function","z":"3520573e.bc7c78","name":"","func":"if(msg.payload.stdout==\"Error\"){\n    msg.payload = { group: {\n    show : [\"CreateDataset_Error\"],\n    hide : [\"CreateDataset_Text\",\"CreateDataset_Form\"]\n}}\n}\nelse {\n    msg.payload = { group: {\n    show : [\"CreateDataset_Text\"],\n    hide : [\"CreateDataset_Error\"]\n}, text: \"Process successfully completed!\"}\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1380,"y":320,"wires":[["6494a1c3.44d12","6317889b.e1c9a8"]]},{"id":"6494a1c3.44d12","type":"ui_text","z":"3520573e.bc7c78","group":"cb2ba6b1.221c38","order":1,"width":0,"height":0,"name":"","label":"","format":"{{msg.payload.text}}","layout":"col-center","x":1350,"y":480,"wires":[]},{"id":"47e5d8b7.0fb678","type":"ui_template","z":"3520573e.bc7c78","group":"9325f863.2445e8","name":"Error","order":1,"width":24,"height":2,"format":"<html>\n  <body>\n      <center>\n<h1>ERROR during execution!</h1>\n<h3>There was an error in the process. Please, repeat the procedure and check if the inputs files are correct</h3>\n</center>\n</body>\n</html>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1610,"y":300,"wires":[[]]},{"id":"1611d86b.ab4f88","type":"ui_ui_control","z":"3520573e.bc7c78","name":"Refresh page restore","events":"all","x":120,"y":900,"wires":[["eaaa6576.d1f038","e8f66b91.fcfe48"]]},{"id":"eaaa6576.d1f038","type":"function","z":"3520573e.bc7c78","name":"","func":"if(msg.payload == \"connect\" || msg.payload == \"change\") {\n    msg.payload = { group: {\n    show : [\"CreateDataset_Form\"],\n    hide : [\"CreateDataset_Error\",\"CreateDataset_Text\"]\n}, title: \"\"\n};\n    return msg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":200,"y":960,"wires":[["81f4ecfb.1c6a1","dfcd4577.06c498","fd9ae8fb.292bc8"]]},{"id":"81f4ecfb.1c6a1","type":"ui_ui_control","z":"3520573e.bc7c78","name":"","events":"all","x":220,"y":1020,"wires":[[]]},{"id":"af410388.903e1","type":"function","z":"3520573e.bc7c78","name":"","func":"msg.payload = { group: {\n    show : [\"CreateDataset_Text\"],\n    //hide : [\"R_Form\"]\n}, text: \"Proccess in execution.. It can have a long term, check the files in the folder.\"}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1040,"y":400,"wires":[["6317889b.e1c9a8","6494a1c3.44d12"]]},{"id":"6317889b.e1c9a8","type":"ui_ui_control","z":"3520573e.bc7c78","name":"","events":"all","x":1660,"y":400,"wires":[[]]},{"id":"4560db13.270b84","type":"fs-ops-dir","z":"3520573e.bc7c78","name":"","path":"createDataset/out","pathType":"str","filter":"*","filterType":"str","dir":"payload","dirType":"msg","x":440,"y":1060,"wires":[["c6d3ced4.7c186"]]},{"id":"c6d3ced4.7c186","type":"ui_list","z":"3520573e.bc7c78","group":"6955ba29.31b9a4","name":"Lista File","order":3,"width":6,"height":5,"lineType":"two","actionType":"click","allowHTML":false,"outputs":1,"topic":"","x":760,"y":1060,"wires":[["5dfefffd.9d01c","dfcd4577.06c498","767881af.367e1","2f0a993c.c1d906"]]},{"id":"6550e094.bcc7b","type":"ui_text","z":"3520573e.bc7c78","group":"6955ba29.31b9a4","order":2,"width":6,"height":1,"name":"","label":"","format":"File List","layout":"col-center","x":990,"y":800,"wires":[]},{"id":"5dfefffd.9d01c","type":"fs-ops-stats","z":"3520573e.bc7c78","name":"","path":"createDataset/out","pathType":"str","filename":"payload.title","filenameType":"msg","stats":"stats","sizeType":"msg","x":1000,"y":960,"wires":[["c1d3db9d.a89e48"]]},{"id":"52981ad5.199bd4","type":"ui_toast","z":"3520573e.bc7c78","position":"dialog","displayTime":"3","highlight":"","sendall":false,"outputs":1,"ok":"OK","cancel":"","raw":true,"topic":"","name":"","x":1290,"y":900,"wires":[[]]},{"id":"c1d3db9d.a89e48","type":"function","z":"3520573e.bc7c78","name":"","func":"msg.payload = (\"Createation Date: \").bold() + msg.stats.mtime + (\"Size: \").bold() + msg.stats.size + \" byte\"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1120,"y":900,"wires":[["52981ad5.199bd4"]]},{"id":"a56de46c.a76b78","type":"ui_template","z":"3520573e.bc7c78","group":"6955ba29.31b9a4","name":"","order":5,"width":3,"height":2,"format":"<h5><a href=\"{{msg.payload}}\">Download</a></h5>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":760,"y":940,"wires":[[]]},{"id":"dfcd4577.06c498","type":"function","z":"3520573e.bc7c78","name":"","func":"if(msg.payload.title == '') {\n    msg.payload = \"\";\n}\nelse {\n    msg.payload = \"/file/createDataset/out/\" + msg.payload.title\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":620,"y":960,"wires":[["a56de46c.a76b78"]]},{"id":"e8f66b91.fcfe48","type":"change","z":"3520573e.bc7c78","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"Go\":\"refresh\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":220,"y":700,"wires":[["5988d7a.d86e328","4969ef48.c5943"]]},{"id":"5988d7a.d86e328","type":"fs-ops-dir","z":"3520573e.bc7c78","name":"","path":"standardFiles","pathType":"str","filter":"*.dot","filterType":"str","dir":"payload.dot","dirType":"msg","x":380,"y":680,"wires":[["c936930b.c6781"]]},{"id":"4969ef48.c5943","type":"fs-ops-dir","z":"3520573e.bc7c78","name":"","path":"standardFiles","pathType":"str","filter":"*.fasta","filterType":"str","dir":"payload.fasta","dirType":"msg","x":380,"y":720,"wires":[["c936930b.c6781"]]},{"id":"c936930b.c6781","type":"join","z":"3520573e.bc7c78","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":true,"timeout":"","count":"3","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":550,"y":700,"wires":[["cacd77e9.b80188"]]},{"id":"bcf03e29.23036","type":"function","z":"3520573e.bc7c78","name":"","func":"if(msg.payload.fileirf.startsWith(\"standardFiles\")) {\n    msg.payload.fileirf = null\n} else {\n    msg.payload.fileirf = msg.payload.fileirf.split(\"/\")[1]\n}\nif(msg.payload.fileinrf.startsWith(\"standardFiles\")) {\n    msg.payload.fileinrf = null\n} else {\n    msg.payload.fileinrf = msg.payload.fileinrf.split(\"/\")[1]\n}\nif(msg.payload.fileird.startsWith(\"standardFiles\")) {\n    msg.payload.fileird = null\n} else {\n    msg.payload.fileird = msg.payload.fileird.split(\"/\")[1]\n}\nif(msg.payload.fileinrd.startsWith(\"standardFiles\")) {\n    msg.payload.fileinrd = null\n} else {\n    msg.payload.fileinrd = msg.payload.fileinrd.split(\"/\")[1]\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":960,"y":220,"wires":[["ac506350.f39c2","27cd626.b68969e","74f8496e.2c3598","8ec7c41f.620498"]]},{"id":"ac506350.f39c2","type":"fs-ops-move","z":"3520573e.bc7c78","name":"","sourcePath":"createDataset/","sourcePathType":"str","sourceFilename":"payload.fileirf","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fileirf","destFilenameType":"msg","link":false,"x":1140,"y":40,"wires":[[]]},{"id":"27cd626.b68969e","type":"fs-ops-move","z":"3520573e.bc7c78","name":"","sourcePath":"createDataset/","sourcePathType":"str","sourceFilename":"payload.fileinrf","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fileinrf","destFilenameType":"msg","link":false,"x":1140,"y":80,"wires":[[]]},{"id":"74f8496e.2c3598","type":"fs-ops-move","z":"3520573e.bc7c78","name":"","sourcePath":"createDataset/","sourcePathType":"str","sourceFilename":"payload.fileird","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fileird","destFilenameType":"msg","link":false,"x":1140,"y":120,"wires":[[]]},{"id":"8ec7c41f.620498","type":"fs-ops-move","z":"3520573e.bc7c78","name":"","sourcePath":"createDataset/","sourcePathType":"str","sourceFilename":"payload.fileinrd","sourceFilenameType":"msg","destPath":"standardFiles/","destPathType":"str","destFilename":"payload.fileinrd","destFilenameType":"msg","link":false,"x":1140,"y":160,"wires":[[]]},{"id":"59da696b.b4f838","type":"fs-ops-dir","z":"3520573e.bc7c78","name":"get list of files","path":"sourcePath","pathType":"msg","filter":"*","filterType":"str","dir":"payload","dirType":"msg","x":600,"y":600,"wires":[["d5ad8397.c9098"]]},{"id":"47b8be5c.3a897","type":"change","z":"3520573e.bc7c78","name":"","rules":[{"t":"set","p":"sourcePath","pt":"msg","to":"createDataset/out","tot":"str"},{"t":"set","p":"destinationPath","pt":"msg","to":"standardFiles","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":400,"y":600,"wires":[["59da696b.b4f838"]]},{"id":"d5ad8397.c9098","type":"split","z":"3520573e.bc7c78","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":770,"y":600,"wires":[["e58742ef.3ee4f"]]},{"id":"e58742ef.3ee4f","type":"fs-ops-move","z":"3520573e.bc7c78","name":"","sourcePath":"sourcePath","sourcePathType":"msg","sourceFilename":"payload","sourceFilenameType":"msg","destPath":"destinationPath","destPathType":"msg","destFilename":"payload","destFilenameType":"msg","link":false,"x":940,"y":600,"wires":[[]]},{"id":"4cb15004.a1c67","type":"ui_button","z":"3520573e.bc7c78","name":"","group":"6955ba29.31b9a4","order":8,"width":6,"height":1,"passthru":false,"label":"Store on server","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":200,"y":600,"wires":[["47b8be5c.3a897"]]},{"id":"767881af.367e1","type":"ui_text","z":"3520573e.bc7c78","group":"6955ba29.31b9a4","order":4,"width":6,"height":1,"name":"","label":"You have selected: ","format":"{{msg.payload.title}}","layout":"row-left","x":1170,"y":1160,"wires":[]},{"id":"598a3ef7.bade2","type":"ui_button","z":"3520573e.bc7c78","name":"","group":"6955ba29.31b9a4","order":6,"width":3,"height":1,"passthru":false,"label":"Delete","tooltip":"","color":"","bgcolor":"#F93811","icon":"","payload":"{\"done\":\"yes\"}","payloadType":"json","topic":"","x":990,"y":1020,"wires":[["2f0a993c.c1d906"]]},{"id":"eb788f5b.efe71","type":"fs-ops-delete","z":"3520573e.bc7c78","name":"","path":"createDataset/out","pathType":"str","filename":"payload.title","filenameType":"msg","x":430,"y":1160,"wires":[["d670348a.ee5d28","4560db13.270b84"]]},{"id":"2f0a993c.c1d906","type":"join","z":"3520573e.bc7c78","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1130,"y":1060,"wires":[["eb788f5b.efe71"]]},{"id":"2a9a4e49.0e8ea2","type":"ui_ui_control","z":"3520573e.bc7c78","name":"Refresh page restore","events":"all","x":420,"y":1240,"wires":[["d670348a.ee5d28"]]},{"id":"d670348a.ee5d28","type":"function","z":"3520573e.bc7c78","name":"","func":"msg.payload = {\"title\":\"\"}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":660,"y":1160,"wires":[["767881af.367e1","dfcd4577.06c498"]]},{"id":"415ed0e5.ac7cd","type":"tab","label":"Page-Download","disabled":false,"info":""},{"id":"91124fd7.d495","type":"ui_ui_control","z":"415ed0e5.ac7cd","name":"Refresh page restore","events":"all","x":140,"y":260,"wires":[["a15c45df.657418","ae313093.399af","543e92fb.f72d5c"]]},{"id":"a15c45df.657418","type":"function","z":"415ed0e5.ac7cd","name":"","func":"if(msg.payload == \"connect\" || msg.payload == \"change\") {\n    msg.payload = { title: \"\"}\n    return msg;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":120,"y":360,"wires":[["c31a7ff5.68b5"]]},{"id":"ae313093.399af","type":"fs-ops-dir","z":"415ed0e5.ac7cd","name":"","path":"standardFiles","pathType":"str","filter":"*","filterType":"str","dir":"payload","dirType":"msg","x":740,"y":260,"wires":[["a7d7dff0.4fab1"]]},{"id":"a7d7dff0.4fab1","type":"ui_list","z":"415ed0e5.ac7cd","group":"c4a2f666.022d18","name":"Lista File","order":4,"width":8,"height":7,"lineType":"two","actionType":"click","allowHTML":false,"outputs":1,"topic":"","x":910,"y":260,"wires":[["5303ad79.e05324","c31a7ff5.68b5","aae0eef1.90a5e"]]},{"id":"484dae23.c668a","type":"ui_text","z":"415ed0e5.ac7cd","group":"c4a2f666.022d18","order":1,"width":14,"height":1,"name":"","label":"","format":"File List","layout":"col-center","x":1250,"y":260,"wires":[]},{"id":"5303ad79.e05324","type":"fs-ops-stats","z":"415ed0e5.ac7cd","name":"","path":"standardFiles","pathType":"str","filename":"payload.title","filenameType":"msg","stats":"stats","sizeType":"msg","x":1080,"y":260,"wires":[["165537c3.a4cb98"]]},{"id":"a40b717e.e6f3b","type":"ui_toast","z":"415ed0e5.ac7cd","position":"dialog","displayTime":"3","highlight":"","sendall":false,"outputs":1,"ok":"OK","cancel":"","raw":true,"topic":"","name":"","x":1340,"y":200,"wires":[[]]},{"id":"165537c3.a4cb98","type":"function","z":"415ed0e5.ac7cd","name":"","func":"msg.payload = (\"Creation Date: \").bold() + msg.stats.birthtime + (\" Size: \").bold() + msg.stats.size + \" byte\"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1160,"y":200,"wires":[["a40b717e.e6f3b"]]},{"id":"2fdab33b.d97e9c","type":"ui_template","z":"415ed0e5.ac7cd","group":"c4a2f666.022d18","name":"","order":22,"width":5,"height":1,"format":"<h4><a href=\"{{msg.payload}}\">Download</a></h4>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":680,"y":360,"wires":[[]]},{"id":"c31a7ff5.68b5","type":"function","z":"415ed0e5.ac7cd","name":"","func":"var msg1\n\nif(msg.payload.title === '') {\n    msg.payload = \"\";\n    return [msg,null]\n}\nelse {\n    msg1 = { payload: {file: msg.payload.title } }\n    msg.payload = \"/download/standardFiles/\" + msg.payload.title\n    return [msg,msg1];\n}\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":480,"y":360,"wires":[["2fdab33b.d97e9c"],["e8cd3c93.70964"]]},{"id":"3d66d9a4.0f5f96","type":"function","z":"415ed0e5.ac7cd","name":"Set base path","func":"msg.filename = msg.req.params.dir + \"/\" + msg.req.params.name\nmsg.payload = msg.filename\nreturn [msg, null];","outputs":1,"noerr":0,"initialize":"","finalize":"","x":580,"y":580,"wires":[["198118d0.bec147"]]},{"id":"430bdf7b.ab005","type":"http response","z":"415ed0e5.ac7cd","name":"","statusCode":"","headers":{},"x":1090,"y":580,"wires":[]},{"id":"198118d0.bec147","type":"file in","z":"415ed0e5.ac7cd","name":"","filename":"","format":"","chunk":false,"sendError":false,"encoding":"none","x":810,"y":580,"wires":[["430bdf7b.ab005"]]},{"id":"ffc4d34a.9caea","type":"catch","z":"415ed0e5.ac7cd","name":"","scope":null,"uncaught":false,"x":1120,"y":700,"wires":[["d5bc1c68.1d8dd","d2060df1.2ba99"]]},{"id":"d5bc1c68.1d8dd","type":"function","z":"415ed0e5.ac7cd","name":"Set 404","func":"msg.payload = msg.error;\nmsg.statusCode = 404;//resource not found\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1320,"y":700,"wires":[["430bdf7b.ab005"]]},{"id":"d2060df1.2ba99","type":"debug","z":"415ed0e5.ac7cd","name":"msg","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1230,"y":760,"wires":[]},{"id":"a2b8ff4a.63216","type":"http in","z":"415ed0e5.ac7cd","name":"","url":"/download/:dir/:name","method":"get","upload":false,"swaggerDoc":"","x":370,"y":580,"wires":[["3d66d9a4.0f5f96"]]},{"id":"34eb1c89.76c164","type":"ui_text","z":"415ed0e5.ac7cd","group":"c4a2f666.022d18","order":2,"width":14,"height":1,"name":"","label":"Click on the file name and push the \"Download\" link.","format":"","layout":"col-center","x":1400,"y":300,"wires":[]},{"id":"aa7fe685.807278","type":"ui_button","z":"415ed0e5.ac7cd","name":"","group":"c4a2f666.022d18","order":23,"width":3,"height":1,"passthru":false,"label":"Delete","tooltip":"","color":"","bgcolor":"#F93811","icon":"","payload":"{\"done\":\"yes\"}","payloadType":"json","topic":"","x":510,"y":440,"wires":[["e8cd3c93.70964"]]},{"id":"91e81670.e08a38","type":"fs-ops-delete","z":"415ed0e5.ac7cd","name":"","path":"standardFiles/","pathType":"str","filename":"payload.file","filenameType":"msg","x":910,"y":400,"wires":[["ae313093.399af","543e92fb.f72d5c"]]},{"id":"e8cd3c93.70964","type":"join","z":"415ed0e5.ac7cd","name":"","mode":"custom","build":"merged","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":650,"y":400,"wires":[["91e81670.e08a38"]]},{"id":"aae0eef1.90a5e","type":"ui_text","z":"415ed0e5.ac7cd","group":"c4a2f666.022d18","order":19,"width":8,"height":1,"name":"","label":"You have selected: ","format":"{{msg.payload.title}}","layout":"row-left","x":1130,"y":120,"wires":[]},{"id":"543e92fb.f72d5c","type":"function","z":"415ed0e5.ac7cd","name":"","func":"msg.payload = {\"title\":\"\"}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":360,"y":120,"wires":[["aae0eef1.90a5e","c31a7ff5.68b5"]]},{"id":"42169b73.08e464","type":"ui_ui_control","z":"415ed0e5.ac7cd","name":"","events":"all","x":140,"y":680,"wires":[["af18d4e8.184a58"]]},{"id":"af18d4e8.184a58","type":"fs-ops-mkdir","z":"415ed0e5.ac7cd","name":"","path":"","pathType":"str","dirname":"standardFiles","dirnameType":"str","mode":"777","fullpath":"directory","fullpathType":"msg","x":320,"y":680,"wires":[[]]},{"id":"9d6b39d2.8d9d08","type":"tab","label":"DSaas","disabled":false,"info":""},{"id":"5d6c8997.20d658","type":"ui_template","z":"9d6b39d2.8d9d08","group":"47feffdd.d45a5","name":"DSaaS","order":0,"width":0,"height":0,"format":"\n<iframe style=\"width:70%; height:5000px\" frameborder=\"0\" scrolling=\"no\" marginheight=\"0\" marginwidth=\"0\" src=\"http://192.168.123.21:3838/sample-apps/DSaaS/\"></iframe>\n","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":330,"y":140,"wires":[[]]},{"id":"551f8b12.fef8a4","type":"ui_group","z":"","name":"Form","tab":"15a75513.5fc1db","order":1,"disp":false,"width":"24","collapse":false},{"id":"8de88ec6.7a2eb","type":"ui_group","z":"","name":"Text","tab":"15a75513.5fc1db","order":4,"disp":false,"width":"24","collapse":false},{"id":"fb4d7367.bfdc8","type":"ui_group","z":"","name":"Out","tab":"15a75513.5fc1db","order":2,"disp":false,"width":"24","collapse":false},{"id":"6d4e43ea.a0b26c","type":"ui_group","z":"","name":"Error","tab":"15a75513.5fc1db","order":5,"disp":false,"width":"24","collapse":false},{"id":"15a18174.decbcf","type":"ui_group","z":"","name":"Zip","tab":"15a75513.5fc1db","order":3,"disp":false,"width":"24","collapse":false},{"id":"fa121464.d372f8","type":"ui_group","z":"","name":"Form","tab":"74e4b5f5.755f3c","order":1,"disp":false,"width":"24","collapse":false},{"id":"6404ee74.eb2cf","type":"ui_group","z":"","name":"Text","tab":"74e4b5f5.755f3c","order":4,"disp":false,"width":"24","collapse":false},{"id":"11c767e3.b1ed98","type":"ui_group","z":"","name":"Out","tab":"74e4b5f5.755f3c","order":2,"disp":false,"width":"24","collapse":false},{"id":"21f75a15.0d4876","type":"ui_group","z":"","name":"Error","tab":"74e4b5f5.755f3c","order":5,"disp":false,"width":"24","collapse":false},{"id":"4fe43e67.8a641","type":"ui_group","z":"","name":"Zip","tab":"74e4b5f5.755f3c","order":3,"disp":false,"width":"24","collapse":false},{"id":"186e9ebc.21a1b1","type":"ui_group","z":"","name":"Flanking","tab":"74e4b5f5.755f3c","order":6,"disp":false,"width":"24","collapse":false},{"id":"1858b76f.92a689","type":"ui_group","z":"","name":"Form","tab":"ebf7c515.7c32c8","order":1,"disp":false,"width":"24","collapse":false},{"id":"41daea1d.0a6e04","type":"ui_group","z":"","name":"Text","tab":"ebf7c515.7c32c8","order":4,"disp":false,"width":"24","collapse":false},{"id":"be16c50f.602408","type":"ui_group","z":"","name":"Out","tab":"ebf7c515.7c32c8","order":2,"disp":false,"width":"24","collapse":false},{"id":"1d156d5b.2ed253","type":"ui_group","z":"","name":"Error","tab":"ebf7c515.7c32c8","order":5,"disp":false,"width":"24","collapse":false},{"id":"f1ea2caf.325de","type":"ui_group","z":"","name":"Zip","tab":"ebf7c515.7c32c8","order":3,"disp":false,"width":"24","collapse":false},{"id":"7541ab8.3013054","type":"ui_group","z":"","name":"Flanking","tab":"ebf7c515.7c32c8","order":6,"disp":false,"width":"24","collapse":false},{"id":"36c2f3a9.d9800c","type":"ui_group","z":"","name":"Form","tab":"631167f8.a19fe8","order":1,"disp":false,"width":"24","collapse":false},{"id":"f2e30963.3f0e58","type":"ui_group","z":"","name":"Text","tab":"631167f8.a19fe8","order":4,"disp":false,"width":"24","collapse":false},{"id":"6df9caf0.036674","type":"ui_group","z":"","name":"Out","tab":"631167f8.a19fe8","order":2,"disp":false,"width":"24","collapse":false},{"id":"c308a23f.10b71","type":"ui_group","z":"","name":"Error","tab":"631167f8.a19fe8","order":5,"disp":false,"width":"24","collapse":false},{"id":"2e821a89.317d16","type":"ui_group","z":"","name":"Zip","tab":"631167f8.a19fe8","order":3,"disp":false,"width":"24","collapse":false},{"id":"23cf321b.86f3fe","type":"ui_group","z":"","name":"Form","tab":"9d9a262b.5be728","order":1,"disp":false,"width":"24","collapse":false},{"id":"99f4bf7c.550e1","type":"ui_group","z":"","name":"Text","tab":"9d9a262b.5be728","order":4,"disp":false,"width":"24","collapse":false},{"id":"49102c0f.cf00f4","type":"ui_group","z":"","name":"Out","tab":"9d9a262b.5be728","order":2,"disp":false,"width":"24","collapse":false},{"id":"a8b834b9.172ae8","type":"ui_group","z":"","name":"Error","tab":"9d9a262b.5be728","order":5,"disp":false,"width":"24","collapse":false},{"id":"6d130006.a1c71","type":"ui_group","z":"","name":"Zip","tab":"9d9a262b.5be728","order":3,"disp":false,"width":"24","collapse":false},{"id":"112be209.3b267e","type":"ui_group","z":"","name":"Form","tab":"c7d98e72.dd87f","order":1,"disp":false,"width":"24","collapse":false},{"id":"1f86516c.1caddf","type":"ui_group","z":"","name":"Out","tab":"c7d98e72.dd87f","order":4,"disp":false,"width":"24","collapse":false},{"id":"1f01b95f.b2eb67","type":"ui_group","z":"","name":"Error","tab":"c7d98e72.dd87f","order":3,"disp":false,"width":"24","collapse":false},{"id":"571692af.cbdf1c","type":"ui_group","z":"","name":"Zip","tab":"c7d98e72.dd87f","order":5,"disp":false,"width":"24","collapse":false},{"id":"b519a721.59f3a8","type":"ui_group","z":"","name":"Text","tab":"c7d98e72.dd87f","order":2,"disp":false,"width":"24","collapse":false},{"id":"6d2be4c0.312fcc","type":"ui_group","z":"","name":"Form","tab":"2318d6f3.938e9a","order":1,"disp":false,"width":"24","collapse":false},{"id":"33aeab03.cc5714","type":"ui_group","z":"","name":"Text","tab":"2318d6f3.938e9a","order":2,"disp":false,"width":"24","collapse":false},{"id":"bd167470.1eb8d8","type":"ui_group","z":"","name":"Out","tab":"2318d6f3.938e9a","order":4,"disp":false,"width":"24","collapse":false},{"id":"b9557d96.4ea13","type":"ui_group","z":"","name":"Error","tab":"2318d6f3.938e9a","order":3,"disp":false,"width":"24","collapse":false},{"id":"2356e44f.08888c","type":"ui_group","z":"","name":"Zip","tab":"2318d6f3.938e9a","order":5,"disp":false,"width":"24","collapse":false},{"id":"7f7949c2.f3b448","type":"ui_group","z":"","name":"Flanking","tab":"2318d6f3.938e9a","order":6,"disp":false,"width":"24","collapse":false},{"id":"86746bf5.623248","type":"ui_group","z":"","name":"Form","tab":"4be5695e.fca1f8","order":1,"disp":false,"width":"24","collapse":false},{"id":"56423b78.7b9c94","type":"ui_group","z":"","name":"Text","tab":"4be5695e.fca1f8","order":2,"disp":false,"width":"24","collapse":false},{"id":"16767678.55b4ea","type":"ui_group","z":"","name":"Out","tab":"4be5695e.fca1f8","order":4,"disp":false,"width":"24","collapse":false},{"id":"7b824e4d.3d82a","type":"ui_group","z":"","name":"Error","tab":"4be5695e.fca1f8","order":3,"disp":false,"width":"24","collapse":false},{"id":"5c6a6d1.5f89794","type":"ui_group","z":"","name":"Zip","tab":"4be5695e.fca1f8","order":5,"disp":false,"width":"24","collapse":false},{"id":"d5d7f87d.3a2d78","type":"ui_group","z":"","name":"Form","tab":"34046d8.7859d92","order":1,"disp":false,"width":"24","collapse":false},{"id":"96d17bc4.75e078","type":"ui_group","z":"","name":"Out","tab":"34046d8.7859d92","order":2,"disp":false,"width":"24","collapse":false},{"id":"570b0f5.92fecf","type":"ui_group","z":"","name":"Error","tab":"34046d8.7859d92","order":4,"disp":false,"width":"24","collapse":false},{"id":"f78220cf.a311","type":"ui_group","z":"","name":"Text","tab":"34046d8.7859d92","order":3,"disp":false,"width":24,"collapse":false},{"id":"fa38ca41.d37ef8","type":"ui_group","z":"","name":"Output","tab":"b296d48b.b48e38","order":5,"disp":false,"width":24,"collapse":false},{"id":"68bbb66e.e5e278","type":"ui_group","z":"","name":"Text","tab":"b296d48b.b48e38","order":2,"disp":false,"width":8,"collapse":false},{"id":"b6b24a48.ac4c28","type":"ui_group","z":"","name":"Download","tab":"b296d48b.b48e38","order":3,"disp":false,"width":"24","collapse":false},{"id":"7ab29b4.3dca464","type":"ui_group","z":"","name":"Error","tab":"b296d48b.b48e38","order":6,"disp":false,"width":8,"collapse":false},{"id":"9b368654.c443b8","type":"ui_group","z":"","name":"Zip","tab":"b296d48b.b48e38","order":4,"disp":false,"width":24,"collapse":false},{"id":"a5a41cc4.d37da","type":"ui_group","z":"","name":"Process","tab":"b296d48b.b48e38","order":1,"disp":false,"width":"24","collapse":false},{"id":"b9639dff.66bf1","type":"ui_group","z":"","name":"Form","tab":"fa08f6de.49fe08","order":1,"disp":false,"width":"24","collapse":false},{"id":"8710f5f1.856a38","type":"ui_group","z":"","name":"Output","tab":"fa08f6de.49fe08","order":2,"disp":false,"width":"24","collapse":false},{"id":"6955ba29.31b9a4","type":"ui_group","z":"","name":"Form","tab":"91512793.2d5998","order":3,"disp":false,"width":"24","collapse":false},{"id":"cb2ba6b1.221c38","type":"ui_group","z":"","name":"Text","tab":"91512793.2d5998","order":1,"disp":false,"width":"24","collapse":false},{"id":"9325f863.2445e8","type":"ui_group","z":"","name":"Error","tab":"91512793.2d5998","order":2,"disp":false,"width":"24","collapse":false},{"id":"c4a2f666.022d18","type":"ui_group","z":"","name":"List","tab":"32f4aaed.5657a6","order":1,"disp":false,"width":"14","collapse":false},{"id":"47feffdd.d45a5","type":"ui_group","z":"","name":"Page","tab":"f4395aa1.479838","order":1,"disp":false,"width":"35","collapse":false},{"id":"15a75513.5fc1db","type":"ui_tab","z":"","name":"CreateUniqueIDs","icon":"dashboard","order":2,"disabled":false,"hidden":false},{"id":"74e4b5f5.755f3c","type":"ui_tab","z":"","name":"CufflinksIntronsExtraction","icon":"dashboard","order":3,"disabled":false,"hidden":false},{"id":"ebf7c515.7c32c8","type":"ui_tab","z":"","name":"AstalavistaIntronRetention","icon":"dashboard","order":4,"disabled":false,"hidden":false},{"id":"631167f8.a19fe8","type":"ui_tab","z":"","name":"SubtractFastaDatasets","icon":"dashboard","order":5,"disabled":false,"hidden":false},{"id":"9d9a262b.5be728","type":"ui_tab","z":"","name":"MergeFasta","icon":"dashboard","order":6,"disabled":false,"hidden":false},{"id":"c7d98e72.dd87f","type":"ui_tab","z":"","name":"RemoveNucleotides","icon":"dashboard","order":7,"disabled":false,"hidden":false},{"id":"2318d6f3.938e9a","type":"ui_tab","z":"","name":"AugustusIntronsExtraction","icon":"dashboard","order":8,"disabled":false,"hidden":false},{"id":"4be5695e.fca1f8","type":"ui_tab","z":"","name":"StringtieIntronsExtraction","icon":"dashboard","order":9,"disabled":false,"hidden":false},{"id":"34046d8.7859d92","type":"ui_tab","z":"","name":"DotBracketNotation","icon":"dashboard","order":10,"disabled":false,"hidden":false},{"id":"b296d48b.b48e38","type":"ui_tab","z":"","name":"ComplexProcess","icon":"dashboard","order":11,"disabled":false,"hidden":false},{"id":"fa08f6de.49fe08","type":"ui_tab","z":"","name":"Python","icon":"dashboard","order":12,"disabled":false,"hidden":false},{"id":"91512793.2d5998","type":"ui_tab","z":"","name":"CreateDataset","icon":"dashboard","order":13,"disabled":false,"hidden":false},{"id":"32f4aaed.5657a6","type":"ui_tab","z":"","name":"DownloadFile","icon":"dashboard","order":14,"disabled":false,"hidden":false},{"id":"f4395aa1.479838","type":"ui_tab","z":"","name":"DSaaS","icon":"dashboard","order":14,"disabled":false,"hidden":false}]